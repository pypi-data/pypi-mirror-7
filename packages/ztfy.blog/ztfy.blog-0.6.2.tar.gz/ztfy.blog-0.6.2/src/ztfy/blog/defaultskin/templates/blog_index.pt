<tal:var define="presentation view/presentation">
	<div class="fblike" tal:condition="presentation/display_fb_like">
		<fb:like send="true" layout="button_count" width="200" show_faces="true"></fb:like>
	</div>
	<div tal:condition="presentation/display_googleplus" class="plusone">
		<div class="g-plusone" data-size="medium"></div>
	</div>
	<h1 tal:content="context/i18n:title" />
	<div class="blog" i18n:domain="ztfy.blog"
		tal:define="heading context/i18n:heading;
					position presentation/header_position;">
		<div class="heading" tal:define="renderer heading/html:renderer;"
							 tal:condition="heading"
							 tal:attributes="class python:position and 'heading nofloat' or 'heading'"
							 tal:content="structure python:renderer.render(presentation.header_format,request)" />
		<div class="topics" tal:define="page_topics view/getTopics;
										topics page_topics/topics;
										klass python:heading and (not position) and 'topics' or 'topics nofloat';
										pages page_topics/pages;
										current_page python:int(request.form.get('page',0));
										first_page python:max(0,current_page-3);
										last_page python:min(pages,current_page+4);"
							tal:attributes="class klass">
			<div class="pages" tal:condition="python:pages > 1">
				<tal:if condition="python:first_page > 0">
					<a tal:attributes="href string:${request/URL}?page=0;"
					   title="First page" i18n:attributes="title">&lt;&lt;</a>
					<span>...</span>
				</tal:if>
				<a tal:repeat="page python:range(first_page,last_page)"
				   tal:attributes="href string:${request/URL}?page=${page};
								   class python:(current_page == page) and 'current' or '';
								   title python:'Page %d' % (page+1);"
				   tal:content="python:page+1">page</a>
				<tal:if condition="python:last_page < pages">
					<span>...</span>
					<a tal:define="last python:pages-1"
					   tal:attributes="href string:${request/URL}?page=${last};"
					   title="Last page" i18n:attributes="title">&gt;&gt;</a>
				</tal:if>
			</div>
			<div class="topic" tal:repeat="topic topics">
				<tal:var content="structure topic/@@preview" />
			</div>
			<div class="pages" tal:condition="python:pages > 1">
				<tal:if condition="python:first_page > 0">
					<a tal:attributes="href string:${request/URL}?page=0;"
					   title="First page" i18n:attributes="title">&lt;&lt;</a>
					<span>...</span>
				</tal:if>
				<a tal:repeat="page python:range(first_page,last_page)"
				   tal:attributes="href string:${request/URL}?page=${page};
								   class python:(current_page == page) and 'current' or '';
								   title python:'Page %d' % (page+1);"
				   tal:content="python:page+1">page</a>
				<tal:if condition="python:last_page < pages">
					<span>...</span>
					<a tal:define="last python:pages-1"
					   tal:attributes="href string:${request/URL}?page=${last};"
					   title="Last page" i18n:attributes="title">&gt;&gt;</a>
				</tal:if>
			</div>
		</div>
	</div>
</tal:var>