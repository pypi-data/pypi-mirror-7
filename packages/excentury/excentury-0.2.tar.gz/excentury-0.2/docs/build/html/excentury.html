

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>What is excentury? &mdash; excentury 0.2b0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="excentury 0.2b0 documentation" href="index.html"/>
        <link rel="next" title="Installing Excentury" href="installation.html"/>
        <link rel="prev" title="Excentury Documentation" href="index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> excentury</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href=""> What is Excentury?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#motivation">Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#stochastic-simulation-algorithm">Stochastic Simulation Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compiled-code">Compiled Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Excentury</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html"> Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#the-easy-way">The Easy Way</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installing-on-nix-systems">Installing on *nix Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#excentury-executable">Excentury executable</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="start.html"> Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="start.html#cpp">CPP</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#matlab">MATLAB</a></li>
<li class="toctree-l2"><a class="reference internal" href="start.html#python">Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="format.html"> Excentury Data Format</a><ul>
<li class="toctree-l2"><a class="reference internal" href="format.html#basic-types">Basic Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="format.html#xc-files">XC files</a></li>
<li class="toctree-l2"><a class="reference internal" href="format.html#structures">Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="format.html#tensors-multidimensional-arrays">Tensors: Multidimensional Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="format.html#summary">Summary</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cpp/debug.html"> Debugging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cpp/debug.html#level-1-exitif">Level 1: <tt class="docutils literal"><span class="pre">exitif</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="cpp/debug.html#level-2-debug">Level 2: <tt class="docutils literal"><span class="pre">debug</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="cpp/debug.html#level-3-trace">Level 3: <tt class="docutils literal"><span class="pre">trace</span></tt></a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">excentury</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>What is excentury?</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/excentury.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="what-is-excentury">
<span id="excentury"></span><h1>What is excentury?<a class="headerlink" href="#what-is-excentury" title="Permalink to this headline">¶</a></h1>
<p>Excentury is a collection of libraries written in several languages
to enable to the easy integration of C++ to scripting languages. By
using the excentury formats we can adapt or create new C++ code and
adapt it to computational languages such as Python and MATLAB.</p>
<div class="section" id="motivation">
<h2>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h2>
<p>Scripting languages give us many advantages: faster development,
extensive libraries and an overall easy of use. They are great tools
and can help individuals with no programming experience to get
started learning how to provide instructions to a machine. They allow
us to explore ideas relatively quick without spending too much time
dealing with compiler errors and many other problems that arise from
low level languages.</p>
<p>The main disadvantage is that their execution is slow compared to the
execution done by those compiled to machine code. Many scripting
languages offer support to adapt low level code, thus allowing you to
gain speed in your scripts. Learning how to do this is usually no
easy task since it requires the user to be familiar with the low
level language and the process to create the library is usually not
an easy one.</p>
<p>To see why sometimes it is convenient to switch to low level
languages we will explore the <a class="reference external" href="http://en.wikipedia.org/wiki/Lotka%E2%80%93Volterra_equation">Lotka-Volterra</a> model in MATLAB using
the <a class="reference external" href="http://en.wikipedia.org/wiki/Gillespie_algorithm">Gillespie algorithm</a>.</p>
</div>
<div class="section" id="stochastic-simulation-algorithm">
<h2>Stochastic Simulation Algorithm<a class="headerlink" href="#stochastic-simulation-algorithm" title="Permalink to this headline">¶</a></h2>
<p>In the <a class="reference external" href="http://en.wikipedia.org/wiki/Lotka%E2%80%93Volterra_equation">Lotka-Volterra</a> model we explore the dynamics of a predator
and prey populations. We assume that the populations interact through
four events. Each of these events is associated with a propensity
function <tt class="docutils literal"><span class="pre">a[i]</span></tt>. The propensity functions gives us the probability
that the i-th event occurs during the next infinitesimal interval
<tt class="docutils literal"><span class="pre">[t,</span> <span class="pre">t+dt]</span></tt>, this probability is <tt class="docutils literal"><span class="pre">a[i]*dt</span></tt>. Here we denote the
prey population with <tt class="docutils literal"><span class="pre">x</span></tt> and the predator population with <tt class="docutils literal"><span class="pre">y</span></tt>.</p>
<p>The events are the following:</p>
<ol class="arabic simple">
<li>Birth of prey: <tt class="docutils literal"><span class="pre">a[1](x,</span> <span class="pre">y)</span> <span class="pre">=</span> <span class="pre">A*x</span></tt></li>
<li>Death of prey due to encounter with predator: <tt class="docutils literal"><span class="pre">a[2](x,</span> <span class="pre">y)</span> <span class="pre">=</span> <span class="pre">B*x*y</span></tt></li>
<li>Birth of predator due to prey consumption: <tt class="docutils literal"><span class="pre">a[3](x,</span> <span class="pre">y)</span> <span class="pre">=</span> <span class="pre">C*x*y</span></tt></li>
<li>Death of predator: <tt class="docutils literal"><span class="pre">a[4](x,</span> <span class="pre">y)</span> <span class="pre">=</span> <span class="pre">D*y</span></tt></li>
</ol>
<p>As seen from the propensity functions mentioned in the events we see
that the prey population increases at a rate proportional to its size
and that predation is proportional to the rate at which the predators
and the prey meet. Similarly for the predator, its growth is
proportional to the rate to its encounter with the prey and its death
rate is proportional to its size.</p>
<p>To perform an stochastic simulation let us assume that <tt class="docutils literal"><span class="pre">t</span></tt> is the
time when the last event was seen. Now must answer the following:</p>
<ol class="arabic simple">
<li><em>How long goes the system has to wait until the next event occurs?</em></li>
<li><em>What event takes place?</em></li>
</ol>
<p>The answer to the first question is a random number <span class="math">\(\tau\)</span> from
an exponential distribution of mean equal to the reciprocal of the
sum of the propensity functions evaluated at time <tt class="docutils literal"><span class="pre">t</span></tt>. The event
that takes place after <span class="math">\(\tau\)</span> units of time is the i-th event
with probability equal to the fraction <tt class="docutils literal"><span class="pre">a[i]</span></tt> at time <tt class="docutils literal"><span class="pre">t</span></tt>
occupies in the sum of the of the propensity function evaluated at
time <tt class="docutils literal"><span class="pre">t</span></tt>, that is</p>
<div class="math">
\[P(i) = \frac{a[i](x(t),y(t))}{\sum_{k=1}^{4}a[k](x(t),y(t))}\]</div>
<p>The following MATLAB function generates realizations from the above
model.</p>
<div class="highlight-matlab"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39</pre></div></td><td class="code"><div class="highlight"><pre><span class="k">function</span><span class="w"> </span>[t, v] <span class="p">=</span><span class="w"> </span><span class="nf">lotka_volterra</span><span class="p">(</span>A, B, C, D, x0, y0, num_points<span class="p">)</span><span class="w"></span>

<span class="c">% The change to the m-th population</span>
<span class="c">% due to the n-th event is denoted by</span>
<span class="c">% z(m, n).</span>
<span class="n">z</span> <span class="p">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">;</span>
     <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">];</span>

<span class="n">t</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_points</span><span class="p">);</span>
<span class="n">v</span> <span class="p">=</span> <span class="nb">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">num_points</span><span class="p">);</span>
<span class="n">t</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">v</span><span class="p">(:,</span><span class="mi">1</span><span class="p">)</span> <span class="p">=</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span>

<span class="n">x</span> <span class="p">=</span> <span class="n">x0</span><span class="p">;</span>
<span class="n">y</span> <span class="p">=</span> <span class="n">y0</span><span class="p">;</span>
<span class="k">for</span> <span class="n">point</span><span class="p">=</span><span class="mi">2</span><span class="p">:</span><span class="n">num_points</span>
    <span class="c">% Evaluating propensity functions</span>
    <span class="n">a</span> <span class="p">=</span> <span class="p">[</span><span class="n">A</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">B</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">C</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">D</span><span class="o">*</span><span class="n">y</span><span class="p">];</span>
    <span class="n">a0</span> <span class="p">=</span> <span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
    <span class="k">if</span> <span class="n">a0</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">break</span>
    <span class="k">end</span>
    <span class="c">% Time between events</span>
    <span class="n">tau</span> <span class="p">=</span> <span class="nb">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">rand</span><span class="p">)</span><span class="o">/</span><span class="n">a0</span><span class="p">;</span>
    <span class="c">% Next event computation</span>
    <span class="n">event</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">prop_sum</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">rand_num</span> <span class="p">=</span> <span class="nb">rand</span><span class="o">*</span><span class="n">a0</span><span class="p">;</span>
    <span class="k">while</span> <span class="n">prop_sum</span> <span class="o">&lt;</span> <span class="n">rand_num</span>
        <span class="n">event</span> <span class="p">=</span> <span class="n">event</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="n">prop_sum</span> <span class="p">=</span> <span class="n">prop_sum</span> <span class="o">+</span> <span class="n">a</span><span class="p">(</span><span class="n">event</span><span class="p">);</span>
    <span class="k">end</span>
    <span class="c">% Updating system</span>
    <span class="n">x</span> <span class="p">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">z</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">event</span><span class="p">);</span>
    <span class="n">y</span> <span class="p">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">event</span><span class="p">);</span>
    <span class="c">% Storing point</span>
    <span class="n">t</span><span class="p">(</span><span class="n">point</span><span class="p">)</span> <span class="p">=</span> <span class="n">t</span><span class="p">(</span><span class="n">point</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">tau</span><span class="p">;</span>
    <span class="n">v</span><span class="p">(:,</span> <span class="n">point</span><span class="p">)</span> <span class="p">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span><span class="o">&#39;</span><span class="p">;</span>
<span class="k">end</span>
</pre></div>
</td></tr></table></div>
<p>This function can be used to generate trajectories for the model. The
next figure shows some of the realizations that can be obtained by
running the above function.</p>
<div class="figure">
<img alt="Lotka Volterra Simulations" src="_images/lotka_volterra_sims.png" />
<p class="caption"><strong>Lotka Volterra stochastic realizations</strong>: The parameters used
for the simulation are as follows: <tt class="docutils literal"><span class="pre">A</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">B</span> <span class="pre">=</span> <span class="pre">0.001,</span> <span class="pre">C</span> <span class="pre">=</span> <span class="pre">0.002</span></tt>
and <tt class="docutils literal"><span class="pre">D</span> <span class="pre">=</span> <span class="pre">1</span></tt>. The initial conditions are <tt class="docutils literal"><span class="pre">(x0,</span> <span class="pre">y0)</span> <span class="pre">=</span> <span class="pre">(1000,</span>
<span class="pre">100)</span></tt>. A total of 20 realizations of 50000 points were generated.
In <strong>A</strong> we show the trajectories for the prey population. The
predator population is shown in <strong>B</strong>. The red curve shows the
solution to the deterministic model.</p>
</div>
<p>The MATLAB script is fairly simple and can be adapted to other
models. One downside is that, once we start to generate thousands or
millions or simulations in order to obtain desired statistics we find
that the interpreted code will run very slow compared to some code
written in C++.</p>
</div>
<div class="section" id="compiled-code">
<h2>Compiled Code<a class="headerlink" href="#compiled-code" title="Permalink to this headline">¶</a></h2>
<p>When writing a program, we need a way of specifying inputs and
outputs. To write the same routine as above we will write a simple
program which takes no inputs. In this case, we will hard-code the
inputs into the program and save the data of one trajectory to a file.</p>
<div class="highlight-cpp"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">#include &lt;random&gt;</span>
<span class="cp">#include &lt;cstdio&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Function parameters</span>
    <span class="kt">double</span> <span class="n">A</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">B</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">C</span> <span class="o">=</span> <span class="mf">0.002</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">D</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">x0</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">y0</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">num_points</span> <span class="o">=</span> <span class="mi">50000</span><span class="p">;</span>

    <span class="c1">// z[m][n] is the change to the m-th population</span>
    <span class="c1">// due to the n-th event.</span>
    <span class="kt">int</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">4</span><span class="p">];</span>
    <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">0</span><span class="p">;</span>
    <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="mi">0</span><span class="p">;</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>

    <span class="c1">// Random number generator</span>
    <span class="n">std</span><span class="o">::</span><span class="n">default_random_engine</span> <span class="n">generator</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">uniform_real_distribution</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span> <span class="n">distribution</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">);</span>

    <span class="kt">double</span> <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y0</span><span class="p">;</span>

    <span class="kt">double</span> <span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
    <span class="kt">double</span> <span class="n">a0</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">tau</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">event</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">prop_sum</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">rand_num</span><span class="p">;</span>

    <span class="kt">double</span> <span class="n">t</span><span class="p">[</span><span class="n">num_points</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">num_points</span><span class="p">];</span>
    <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span><span class="p">;</span>
    <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">point</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">point</span> <span class="o">&lt;</span> <span class="n">num_points</span><span class="p">;</span> <span class="o">++</span><span class="n">point</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Evaluating propensity functions</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">x</span><span class="p">;</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">B</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">;</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">;</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span><span class="o">*</span><span class="n">y</span><span class="p">;</span>
        <span class="c1">// Sum of propensity functions</span>
        <span class="n">a0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">a0</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">a0</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="c1">// Time between events</span>
        <span class="n">rand_num</span> <span class="o">=</span> <span class="n">distribution</span><span class="p">(</span><span class="n">generator</span><span class="p">);</span>
        <span class="n">tau</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">rand_num</span><span class="p">)</span><span class="o">/</span><span class="n">a0</span><span class="p">;</span>
        <span class="c1">// Next event computation</span>
        <span class="n">event</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
        <span class="n">prop_sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="n">rand_num</span> <span class="o">=</span> <span class="n">distribution</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span><span class="o">*</span><span class="n">a0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="n">prop_sum</span> <span class="o">&lt;</span> <span class="n">rand_num</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">event</span> <span class="o">=</span> <span class="n">event</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
            <span class="n">prop_sum</span> <span class="o">=</span> <span class="n">prop_sum</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">event</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="c1">// Updating system</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">event</span><span class="p">];</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">event</span><span class="p">];</span>
        <span class="c1">// Storing point</span>
        <span class="n">t</span><span class="p">[</span><span class="n">point</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">point</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">tau</span><span class="p">;</span>
        <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">point</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
        <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">point</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="c1">// Writing to file</span>
    <span class="kt">FILE</span><span class="o">*</span> <span class="n">fp</span><span class="p">;</span>
    <span class="n">fp</span> <span class="o">=</span> <span class="n">fopen</span><span class="p">(</span><span class="s">&quot;data.txt&quot;</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">point</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">point</span> <span class="o">&lt;</span> <span class="n">num_points</span><span class="p">;</span> <span class="o">++</span><span class="n">point</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s">&quot;%f %d %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">t</span><span class="p">[</span><span class="n">point</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">point</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">point</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="n">fclose</span><span class="p">(</span><span class="n">fp</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>This program is very specialized, if we ever need to change the
parameter values, then we need edit the file, recompile the program
and run it. Furthermore, if we want to create a plot or analyze the
data we need to use MATLAB or Python. This requires us to load the
data first. This is no big issue, but as our data files become more
complicated we will find ourselves writing scripts to load the data
from the files into variables that we can manage. The data printed to
the file <tt class="docutils literal"><span class="pre">data.txt</span></tt> is easy to load into MATLAB with the following
commands.</p>
<div class="highlight-matlab"><div class="highlight"><pre><span class="n">load</span> <span class="n">data</span><span class="p">.</span><span class="n">txt</span>
<span class="n">t</span> <span class="p">=</span> <span class="n">data</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">x</span> <span class="p">=</span> <span class="n">data</span><span class="p">(:,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">y</span> <span class="p">=</span> <span class="n">data</span><span class="p">(:,</span> <span class="mi">3</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">);</span>
</pre></div>
</div>
<p>This script was written only after the structure of <tt class="docutils literal"><span class="pre">data</span></tt> was
understood. If data was loaded as a 3 by 50000 matrix instead then we
would have to interpret the information differently.</p>
<p>Writing a C++ program is a complex task to start with. On top of that
we need to be able to provide inputs and outputs. The outputs in
particular need to be formatted in such a way that scripting
languages can understand.</p>
</div>
<div class="section" id="id1">
<h2>Excentury<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Routines as the ones presented above gave rise to Excentury. The
first goal of Excentury was to create a data format which was easy to
code in C++ and MATLAB. The idea then was that a program would be
written in C++ and we would be able to save all the data into a file.
Then from MATLAB we would load it and proceed working on the data.</p>
<p>Eventually Python routines were written to read and write in the
excentury format. The next step was to skip writing to a file and
instead writing to a buffer so that MATLAB or Python would read
directly from it, thus eliminating the need to call C++ manually.</p>
<p>In the next section we present the <tt class="docutils literal"><span class="pre">lotka_volterra</span></tt> routine written
in the excentury format and show how it is call from C++, MATLAB and
Python.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="installation.html" class="btn btn-neutral float-right" title="Installing Excentury"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Excentury Documentation"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Manuel Lopez.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2b0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>