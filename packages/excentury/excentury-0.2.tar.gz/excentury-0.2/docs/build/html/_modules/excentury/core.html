

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>excentury.core &mdash; excentury 0.2b0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="excentury 0.2b0 documentation" href="../../index.html"/>
        <link rel="up" title="excentury" href="../excentury.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../../index.html" class="fa fa-home"> excentury</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul>
<li class="toctree-l1"><a class="reference internal" href="../../excentury.html"> What is Excentury?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../excentury.html#motivation">Motivation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../excentury.html#stochastic-simulation-algorithm">Stochastic Simulation Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../excentury.html#compiled-code">Compiled Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../excentury.html#id1">Excentury</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html"> Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#the-easy-way">The Easy Way</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#installing-on-nix-systems">Installing on *nix Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../installation.html#excentury-executable">Excentury executable</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../start.html"> Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../start.html#cpp">CPP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../start.html#matlab">MATLAB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../start.html#python">Python</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../format.html"> Excentury Data Format</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../format.html#basic-types">Basic Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../format.html#xc-files">XC files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../format.html#structures">Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../format.html#tensors-multidimensional-arrays">Tensors: Multidimensional Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../format.html#summary">Summary</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cpp/debug.html"> Debugging</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/debug.html#level-1-exitif">Level 1: <tt class="docutils literal"><span class="pre">exitif</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/debug.html#level-2-debug">Level 2: <tt class="docutils literal"><span class="pre">debug</span></tt></a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cpp/debug.html#level-3-trace">Level 3: <tt class="docutils literal"><span class="pre">trace</span></tt></a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">excentury</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
          <li><a href="../excentury.html">excentury</a> &raquo;</li>
      
    <li>excentury.core</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <h1>Source code for excentury.core</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">##############</span>
<span class="sd">Excentury Core</span>
<span class="sd">##############</span>

<span class="sd">This module contains functions that can be used by the binary and</span>
<span class="sd">text interface.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">six</span>
<span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">CHAR</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_char</span>
<span class="n">BYTE</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_byte</span>
<span class="n">UBYTE</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ubyte</span>
<span class="n">SHORT</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_short</span>
<span class="n">USHORT</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ushort</span>
<span class="n">INT</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_int</span>
<span class="n">UINT</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span>
<span class="n">LONG</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_long</span>
<span class="n">ULONG</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulong</span>
<span class="n">FLOAT</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_float</span>
<span class="n">DOUBLE</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span>
<span class="n">VOIDP</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span>

<span class="k">if</span> <span class="n">six</span><span class="o">.</span><span class="n">PY3</span><span class="p">:</span>
    <span class="nb">long</span> <span class="o">=</span> <span class="nb">int</span>

<span class="n">CTYPES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nb">str</span><span class="p">:</span> <span class="n">CHAR</span><span class="p">,</span>
    <span class="nb">int</span><span class="p">:</span> <span class="n">INT</span><span class="p">,</span>
    <span class="nb">long</span><span class="p">:</span> <span class="n">LONG</span><span class="p">,</span>
    <span class="nb">float</span><span class="p">:</span> <span class="n">DOUBLE</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">intc</span><span class="p">:</span> <span class="n">INT</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">intp</span><span class="p">:</span> <span class="n">UINT</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">:</span> <span class="n">BYTE</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">:</span> <span class="n">SHORT</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">:</span> <span class="n">INT</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">:</span> <span class="n">LONG</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">:</span> <span class="n">LONG</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">:</span> <span class="n">UBYTE</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">uint16</span><span class="p">:</span> <span class="n">USHORT</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">uint32</span><span class="p">:</span> <span class="n">UINT</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">:</span> <span class="n">ULONG</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">float16</span><span class="p">:</span> <span class="n">FLOAT</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">:</span> <span class="n">FLOAT</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">:</span> <span class="n">DOUBLE</span><span class="p">,</span>
    <span class="n">np</span><span class="o">.</span><span class="n">float_</span><span class="p">:</span> <span class="n">DOUBLE</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">XC_TYPES</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">CHAR</span><span class="p">:</span> <span class="s">&#39;C&#39;</span><span class="p">,</span>
    <span class="n">BYTE</span><span class="p">:</span> <span class="s">&#39;I&#39;</span><span class="p">,</span>
    <span class="n">UBYTE</span><span class="p">:</span> <span class="s">&#39;N&#39;</span><span class="p">,</span>
    <span class="n">SHORT</span><span class="p">:</span> <span class="s">&#39;I&#39;</span><span class="p">,</span>
    <span class="n">USHORT</span><span class="p">:</span> <span class="s">&#39;N&#39;</span><span class="p">,</span>
    <span class="n">INT</span><span class="p">:</span> <span class="s">&#39;I&#39;</span><span class="p">,</span>
    <span class="n">UINT</span><span class="p">:</span> <span class="s">&#39;N&#39;</span><span class="p">,</span>
    <span class="n">LONG</span><span class="p">:</span> <span class="s">&#39;I&#39;</span><span class="p">,</span>
    <span class="n">ULONG</span><span class="p">:</span> <span class="s">&#39;N&#39;</span><span class="p">,</span>
    <span class="n">FLOAT</span><span class="p">:</span> <span class="s">&#39;R&#39;</span><span class="p">,</span>
    <span class="n">DOUBLE</span><span class="p">:</span> <span class="s">&#39;R&#39;</span><span class="p">,</span>
    <span class="n">VOIDP</span><span class="p">:</span> <span class="s">&#39;P&#39;</span>
<span class="p">}</span>
<span class="n">STR_TYPE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;char&#39;</span><span class="p">:</span> <span class="n">CHAR</span><span class="p">,</span>
    <span class="s">&#39;byte&#39;</span><span class="p">:</span> <span class="n">BYTE</span><span class="p">,</span>
    <span class="s">&#39;ubyte&#39;</span><span class="p">:</span> <span class="n">UBYTE</span><span class="p">,</span>
    <span class="s">&#39;short&#39;</span><span class="p">:</span> <span class="n">SHORT</span><span class="p">,</span>
    <span class="s">&#39;ushort&#39;</span><span class="p">:</span> <span class="n">USHORT</span><span class="p">,</span>
    <span class="s">&#39;int&#39;</span><span class="p">:</span> <span class="n">INT</span><span class="p">,</span>
    <span class="s">&#39;uint&#39;</span><span class="p">:</span> <span class="n">UINT</span><span class="p">,</span>
    <span class="s">&#39;long&#39;</span><span class="p">:</span> <span class="n">LONG</span><span class="p">,</span>
    <span class="s">&#39;ulong&#39;</span><span class="p">:</span> <span class="n">ULONG</span><span class="p">,</span>
    <span class="s">&#39;float&#39;</span><span class="p">:</span> <span class="n">FLOAT</span><span class="p">,</span>
    <span class="s">&#39;double&#39;</span><span class="p">:</span> <span class="n">DOUBLE</span><span class="p">,</span>
    <span class="s">&#39;voidp&#39;</span><span class="p">:</span> <span class="n">VOIDP</span>
<span class="p">}</span>
<span class="n">INFO_TYPE</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;C1&#39;</span><span class="p">:</span> <span class="s">&#39;char&#39;</span><span class="p">,</span>
    <span class="s">&#39;I1&#39;</span><span class="p">:</span> <span class="s">&#39;byte&#39;</span><span class="p">,</span>
    <span class="s">&#39;N1&#39;</span><span class="p">:</span> <span class="s">&#39;ubyte&#39;</span><span class="p">,</span>
    <span class="s">&#39;I2&#39;</span><span class="p">:</span> <span class="s">&#39;short&#39;</span><span class="p">,</span>
    <span class="s">&#39;N2&#39;</span><span class="p">:</span> <span class="s">&#39;ushort&#39;</span><span class="p">,</span>
    <span class="s">&#39;I4&#39;</span><span class="p">:</span> <span class="s">&#39;int&#39;</span><span class="p">,</span>
    <span class="s">&#39;N4&#39;</span><span class="p">:</span> <span class="s">&#39;uint&#39;</span><span class="p">,</span>
    <span class="s">&#39;I8&#39;</span><span class="p">:</span> <span class="s">&#39;long&#39;</span><span class="p">,</span>
    <span class="s">&#39;N8&#39;</span><span class="p">:</span> <span class="s">&#39;ulong&#39;</span><span class="p">,</span>
    <span class="s">&#39;R4&#39;</span><span class="p">:</span> <span class="s">&#39;float&#39;</span><span class="p">,</span>
    <span class="s">&#39;R8&#39;</span><span class="p">:</span> <span class="s">&#39;double&#39;</span>
<span class="p">}</span>

<span class="n">COMMUNICATE_DUMP</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">TENSOR_INFO</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">TENSOR_GET_INFO</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">LOAD_DEFS</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">XC_OBJ</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">XC_TMP_FUNC</span> <span class="o">=</span> <span class="bp">None</span>


<div class="viewcode-block" id="xc_type"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.xc_type">[docs]</a><span class="k">def</span> <span class="nf">xc_type</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return one of the following: &#39;C&#39;, &#39;I&#39;, &#39;N&#39;, &#39;R&#39;,</span>
<span class="sd">    &#39;S&#39;, &#39;T&#39;, or &#39;P&#39; or &#39;W&#39;. &quot;&quot;&quot;</span>
    <span class="n">obj_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_type</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&#39;W&#39;</span>
    <span class="k">if</span> <span class="n">obj_type</span> <span class="ow">in</span> <span class="n">TENSOR_INFO</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&#39;T&#39;</span>
    <span class="k">if</span> <span class="n">obj_type</span> <span class="ow">in</span> <span class="n">XC_TYPES</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">XC_TYPES</span><span class="p">[</span><span class="n">obj_type</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">XC_TYPES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">CTYPES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">obj_type</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="s">&#39;S&#39;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="c_type"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.c_type">[docs]</a><span class="k">def</span> <span class="nf">c_type</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the ctype of an object if it has it or None. &quot;&quot;&quot;</span>
    <span class="n">obj_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">obj_type</span> <span class="ow">in</span> <span class="n">XC_TYPES</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj_type</span>
    <span class="k">if</span> <span class="n">obj_type</span> <span class="ow">is</span> <span class="nb">str</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">return</span> <span class="n">CTYPES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">obj_type</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="info_impl"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.info_impl">[docs]</a><span class="k">def</span> <span class="nf">info_impl</span><span class="p">(</span><span class="n">interface</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">varname</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Transmit the varname and info. This is used for the trans_def</span>
<span class="sd">    method in a DataType object since it calls info with 3</span>
<span class="sd">    parameters.&quot;&quot;&quot;</span>
    <span class="n">interface</span><span class="o">.</span><span class="n">trans_name</span><span class="p">(</span><span class="n">varname</span><span class="p">)</span>
    <span class="n">info</span><span class="p">(</span><span class="n">interface</span><span class="p">,</span> <span class="n">obj</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="info"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.info">[docs]</a><span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="n">interface</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">varname</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Communicate the object information. &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">varname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">COMMUNICATE_DUMP</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)](</span><span class="n">info_impl</span><span class="p">,</span> <span class="n">interface</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">varname</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="n">xc_type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;I&#39;</span><span class="p">,</span> <span class="s">&#39;N&#39;</span><span class="p">,</span> <span class="s">&#39;R&#39;</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">]:</span>
        <span class="n">interface</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s">&#39;W&#39;</span><span class="p">:</span>
        <span class="n">interface</span><span class="o">.</span><span class="n">trans_type</span><span class="p">(</span><span class="s">&#39;W&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">TENSOR_INFO</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)](</span><span class="n">info</span><span class="p">,</span> <span class="n">interface</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="get_info"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.get_info">[docs]</a><span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return the information of an object. &quot;&quot;&quot;</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="n">xc_type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;I&#39;</span><span class="p">,</span> <span class="s">&#39;N&#39;</span><span class="p">,</span> <span class="s">&#39;R&#39;</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;I&#39;</span><span class="p">,</span> <span class="s">&#39;N&#39;</span><span class="p">,</span> <span class="s">&#39;R&#39;</span><span class="p">]:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">kind</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">c_type</span><span class="p">(</span><span class="n">obj</span><span class="p">)))]</span>
        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="n">XCStruct</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">kind</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">()]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">kind</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s">&#39;W&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="s">&#39;W&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">in</span> <span class="n">TENSOR_GET_INFO</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">TENSOR_GET_INFO</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)](</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;No info for this type.&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="cmp_info"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.cmp_info">[docs]</a><span class="k">def</span> <span class="nf">cmp_info</span><span class="p">(</span><span class="n">info1</span><span class="p">,</span> <span class="n">info2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Return true if the info objects are the same. &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">info1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">info2</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">False</span>
    <span class="k">if</span> <span class="n">info1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;S&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">info1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">info2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">info1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;W&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">if</span> <span class="n">info1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;T&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cmp_info</span><span class="p">(</span><span class="n">info1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">info2</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">info1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">info2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="data"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.data">[docs]</a><span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="n">interface</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Communicate the object data. &quot;&quot;&quot;</span>
    <span class="n">kind</span> <span class="o">=</span> <span class="n">xc_type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;C&#39;</span><span class="p">,</span> <span class="s">&#39;I&#39;</span><span class="p">,</span> <span class="s">&#39;N&#39;</span><span class="p">,</span> <span class="s">&#39;R&#39;</span><span class="p">]:</span>
        <span class="n">interface</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s">&#39;W&#39;</span><span class="p">:</span>
        <span class="n">interface</span><span class="o">.</span><span class="n">trans_num</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
        <span class="n">interface</span><span class="o">.</span><span class="n">trans_name</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">COMMUNICATE_DUMP</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)](</span><span class="n">data</span><span class="p">,</span> <span class="n">interface</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="append_cls_impl"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.append_cls_impl">[docs]</a><span class="k">def</span> <span class="nf">append_cls_impl</span><span class="p">(</span><span class="n">interface</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Store possible objects which were not added to the interface.</span>
<span class="sd">    That is, perhaps an object contains a subject which is not on the</span>
<span class="sd">    list. Due to this, we must search for such objects. An example of</span>
<span class="sd">    this happens when a line is added but a point is not. &quot;&quot;&quot;</span>
    <span class="n">interface</span><span class="o">.</span><span class="n">store_cls</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="append_cls"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.append_cls">[docs]</a><span class="k">def</span> <span class="nf">append_cls</span><span class="p">(</span><span class="n">interface</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Append objects to the the interface obj_cls list by using the</span>
<span class="sd">    function defined for a given type. &quot;&quot;&quot;</span>
    <span class="n">COMMUNICATE_DUMP</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)](</span><span class="n">append_cls_impl</span><span class="p">,</span> <span class="n">interface</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="XCStruct"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.XCStruct">[docs]</a><span class="k">class</span> <span class="nc">XCStruct</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Object designed to hold data from excentury files in case</span>
<span class="sd">    there is no python function describing how to read a variable in</span>
<span class="sd">    the file.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">info_</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__name__&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__info__&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">info_</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">info_</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">INFO_TYPE</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">STR_TYPE</span><span class="p">[</span><span class="n">INFO_TYPE</span><span class="p">[</span><span class="n">key</span><span class="p">]]()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">XC_TYPES</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">value</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__info__</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">INFO_TYPE</span><span class="p">:</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">STR_TYPE</span><span class="p">[</span><span class="n">INFO_TYPE</span><span class="p">[</span><span class="n">key</span><span class="p">]](</span><span class="n">value</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">cmp_info</span><span class="p">(</span><span class="n">get_info</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;Expected </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
                    <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="n">XC_TYPES</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">val</span><span class="o">.</span><span class="n">value</span>
        <span class="k">return</span> <span class="n">val</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">tstr</span> <span class="o">=</span> <span class="s">&quot;</span><span class="si">%s</span><span class="s">@[0x</span><span class="si">%d</span><span class="s">] = </span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__info__</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="ow">in</span> <span class="n">XC_TYPES</span><span class="p">:</span>
                <span class="n">tstr</span> <span class="o">+=</span> <span class="s">&#39;  </span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">repr</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tstr</span> <span class="o">+=</span> <span class="s">&#39;  </span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">tstr</span>

<div class="viewcode-block" id="XCStruct.name"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.XCStruct.name">[docs]</a>    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the name of the structure. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__name__&#39;</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="XCStruct.info"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.XCStruct.info">[docs]</a>    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return a list of the information it contains. &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s">&#39;__info__&#39;</span><span class="p">]</span>

</div></div>
<div class="viewcode-block" id="xcstruct_communicate_func"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.xcstruct_communicate_func">[docs]</a><span class="k">def</span> <span class="nf">xcstruct_communicate_func</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">interface</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Communication function for the XCStruct object. &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">info</span><span class="p">():</span>
        <span class="n">func</span><span class="p">(</span><span class="n">interface</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</div>
<span class="n">COMMUNICATE_DUMP</span><span class="p">[</span><span class="n">XCStruct</span><span class="p">]</span> <span class="o">=</span> <span class="n">xcstruct_communicate_func</span>


<div class="viewcode-block" id="DataType"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.DataType">[docs]</a><span class="k">class</span> <span class="nc">DataType</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Common datatype for all objects. &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">interface</span><span class="p">):</span>
        <span class="n">type_obj</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">type_obj</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">CHAR</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">type_obj</span> <span class="ow">in</span> <span class="n">CTYPES</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">CTYPES</span><span class="p">[</span><span class="n">type_obj</span><span class="p">](</span><span class="n">obj</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interface</span> <span class="o">=</span> <span class="n">interface</span>

<div class="viewcode-block" id="DataType.communicate"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.DataType.communicate">[docs]</a>    <span class="k">def</span> <span class="nf">communicate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;The communication process. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">trans_varname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
        <span class="n">data</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">trans_close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="DataType.append_def"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.DataType.append_def">[docs]</a>    <span class="k">def</span> <span class="nf">append_def</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Call the append class function. &quot;&quot;&quot;</span>
        <span class="n">append_cls</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="DataType.trans_def"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.DataType.trans_def">[docs]</a>    <span class="k">def</span> <span class="nf">trans_def</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Transmit its definition. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="n">XCStruct</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">trans_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">trans_name</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
        <span class="n">info</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">trans_close</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="DataType.get_type_name"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.DataType.get_type_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_type_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the class name. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span> <span class="ow">is</span> <span class="n">XCStruct</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span>

</div></div>
<div class="viewcode-block" id="Communicator"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.Communicator">[docs]</a><span class="k">class</span> <span class="nc">Communicator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A communicator is in charge of transmitting data. How it does</span>
<span class="sd">    it is up to the interface. &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cls_obj</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interface</span> <span class="o">=</span> <span class="n">interface</span>

<div class="viewcode-block" id="Communicator.store_cls"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.Communicator.store_cls">[docs]</a>    <span class="k">def</span> <span class="nf">store_cls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">py_obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Append to the cls_obj list if its not there. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">xc_type</span><span class="p">(</span><span class="n">py_obj</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;S&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">py_obj</span><span class="p">)</span> <span class="ow">is</span> <span class="n">XCStruct</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">py_obj</span><span class="o">.</span><span class="n">name</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">py_obj</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span>
            <span class="n">is_in</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cls_obj</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">get_type_name</span><span class="p">()</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                    <span class="n">is_in</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_in</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cls_obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataType</span><span class="p">(</span><span class="n">py_obj</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cls_obj</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append_def</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="Communicator.dump"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.Communicator.dump">[docs]</a>    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">py_obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Dump the python object with the given name. You have the</span>
<span class="sd">        option of specifying the kind in case of simple datatypes.</span>
<span class="sd">        For instance, if you write 3, you can set kind to &#39;double&#39; to</span>
<span class="sd">        store it as a double. &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">kind</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">py_obj</span><span class="p">)</span> <span class="ow">in</span> <span class="n">XC_TYPES</span><span class="p">:</span>
                <span class="n">py_obj</span> <span class="o">=</span> <span class="n">py_obj</span><span class="o">.</span><span class="n">value</span>
            <span class="n">tmp_info</span> <span class="o">=</span> <span class="n">get_info</span><span class="p">(</span><span class="n">py_obj</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">kind</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;I&#39;</span><span class="p">,</span> <span class="s">&#39;N&#39;</span><span class="p">,</span> <span class="s">&#39;R&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">tmp_info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;W&#39;</span><span class="p">,</span> <span class="s">&#39;T&#39;</span><span class="p">,</span> <span class="s">&#39;S&#39;</span><span class="p">,</span> <span class="s">&#39;C&#39;</span><span class="p">]:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;Unable to cast py_obj&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">key</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kind</span><span class="p">)</span>
                        <span class="n">py_obj</span> <span class="o">=</span> <span class="n">STR_TYPE</span><span class="p">[</span><span class="n">INFO_TYPE</span><span class="p">[</span><span class="n">key</span><span class="p">]](</span><span class="n">py_obj</span><span class="p">)</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">cmp_info</span><span class="p">(</span><span class="n">tmp_info</span><span class="p">,</span> <span class="n">kind</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%s</span><span class="s"> != </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">kind</span><span class="p">),</span>
                                                   <span class="nb">str</span><span class="p">(</span><span class="n">tmp_info</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">py_obj</span> <span class="o">=</span> <span class="n">STR_TYPE</span><span class="p">[</span><span class="n">kind</span><span class="p">](</span><span class="n">py_obj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataType</span><span class="p">(</span><span class="n">py_obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">store_cls</span><span class="p">(</span><span class="n">py_obj</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;x.__getitem__[index] &lt;==&gt; x[index]&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="ow">in</span> <span class="n">XC_TYPES</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">obj</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;x.__len__() &lt;==&gt; len(x)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span>

<div class="viewcode-block" id="Communicator.clear"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.Communicator.clear">[docs]</a>    <span class="k">def</span> <span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Remove all stored objects. &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">[:]</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">cls_obj</span><span class="p">[:]</span>
</div>
<div class="viewcode-block" id="Communicator.close"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.Communicator.close">[docs]</a>    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Let the interface communicate. &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">trans_num_classes</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cls_obj</span><span class="p">:</span>
            <span class="n">item</span><span class="o">.</span><span class="n">trans_def</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interface</span><span class="o">.</span><span class="n">trans_num_objects</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="p">:</span>
            <span class="n">item</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

</div></div>
<span class="k">def</span> <span class="nf">_replacer</span><span class="p">(</span><span class="n">key_val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Helper function for replace. Source:</span>
<span class="sd">    &lt;http://stackoverflow.com/a/15221068/788553&gt;&quot;&quot;&quot;</span>
    <span class="n">replace_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">key_val</span><span class="p">)</span>
    <span class="n">replacement_function</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">match</span><span class="p">:</span> <span class="n">replace_dict</span><span class="p">[</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">0</span><span class="p">)]</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">key_val</span><span class="p">]),</span> <span class="n">re</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
    <span class="k">return</span> <span class="k">lambda</span> <span class="n">string</span><span class="p">:</span> <span class="n">pattern</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">replacement_function</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>


<div class="viewcode-block" id="replace"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.replace">[docs]</a><span class="k">def</span> <span class="nf">replace</span><span class="p">(</span><span class="n">string</span><span class="p">,</span> <span class="n">key_val</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Replacement of strings done in one pass. Example:</span>

<span class="sd">        &gt;&gt;&gt; replace(&quot;a &lt; b &amp;&amp; b &lt; c&quot;, (&#39;&lt;&#39;, &#39;&amp;lt;&#39;), (&#39;&amp;&#39;, &#39;&amp;amp;&#39;))</span>
<span class="sd">        &#39;a &amp;lt; b &amp;amp;&amp;amp; b &amp;lt; c&#39;</span>

<span class="sd">    Source: &lt;http://stackoverflow.com/a/15221068/788553&gt;&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">_replacer</span><span class="p">(</span><span class="n">key_val</span><span class="p">)(</span><span class="n">string</span><span class="p">)</span>


<span class="c"># pylint: disable=W0122</span></div>
<div class="viewcode-block" id="load_datatype"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.load_datatype">[docs]</a><span class="k">def</span> <span class="nf">load_datatype</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The definitions in the file should suffice to create the</span>
<span class="sd">    object but that won&#39;t call an actual type. Use this to define how</span>
<span class="sd">    to read the data into the new object. &quot;&quot;&quot;</span>
    <span class="n">cpp_map</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s">&#39;XC_LOAD(&#39;</span><span class="p">,</span> <span class="s">&#39;fid.get_data(defs, &#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="s">&#39;XC_OBJ[&quot;</span><span class="si">%s</span><span class="s">&quot;]&#39;</span> <span class="o">%</span> <span class="n">obj</span><span class="o">.</span><span class="n">__name__</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">XC_OBJ</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span><span class="p">]</span>
    <span class="n">content</span> <span class="o">=</span> <span class="s">&#39;def XC_TMP_FUNC(fid, defs):</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">+=</span> <span class="n">replace</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">cpp_map</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="k">exec</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
    <span class="n">LOAD_DEFS</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">XC_TMP_FUNC</span>

</div>
<div class="viewcode-block" id="dump_datatype"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.dump_datatype">[docs]</a><span class="k">def</span> <span class="nf">dump_datatype</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;To simulate c++ XC_DUMP_DATATYPE you have to provide strings</span>
<span class="sd">    so that python can build the appropiate functions.</span>

<span class="sd">    C++ version:</span>

<span class="sd">        XC_DUMP_DATATYPE(Line, t) {</span>
<span class="sd">            XC_DUMP(t.a, &quot;a&quot;);</span>
<span class="sd">            XC_DUMP(t.b, &quot;b&quot;);</span>
<span class="sd">        }</span>

<span class="sd">    Python version:</span>

<span class="sd">        dump_datatype(Line, &#39;t&#39;, &#39;&#39;&#39;</span>
<span class="sd">            XC_DUMP(t.a, &quot;a&quot;);</span>
<span class="sd">            XC_DUMP(t.b, &quot;b&quot;);</span>
<span class="sd">        &#39;&#39;&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cpp_map</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s">&#39;XC_DUMP(&#39;</span><span class="p">,</span> <span class="s">&#39;func(interface, &#39;</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span><span class="p">]</span>
    <span class="n">content</span> <span class="o">=</span> <span class="s">&#39;def XC_TMP_FUNC(func, interface, </span><span class="si">%s</span><span class="s">, varname):</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">var</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">+=</span> <span class="n">replace</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">cpp_map</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="k">exec</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
    <span class="n">COMMUNICATE_DUMP</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">XC_TMP_FUNC</span>

</div>
<div class="viewcode-block" id="dump_tensor"><a class="viewcode-back" href="../../api-python/excentury.core.html#excentury.core.dump_tensor">[docs]</a><span class="k">def</span> <span class="nf">dump_tensor</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">content</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;To simulate c++ XC_DUMP_TENSOR you have to provide strings</span>
<span class="sd">    so that python can build the appropiate functions.</span>

<span class="sd">    C++ version:</span>

<span class="sd">        XC_DUMP_TENSOR(Matrix, m, m.at(0)) {</span>
<span class="sd">            XC_RM(0);</span>
<span class="sd">            XC_SIZE(2);</span>
<span class="sd">            XC_ARRAY(m.size, 2);</span>
<span class="sd">            XC_ARRAY(m.data, m.size(1)*m.size(2));</span>
<span class="sd">        }</span>

<span class="sd">    Python version:</span>

<span class="sd">        dump_tensor(Matrix, &#39;m&#39;, &#39;m.at(0)&#39;, &#39;&#39;&#39;</span>
<span class="sd">            XC_RM(0)</span>
<span class="sd">            XC_SIZE(2)</span>
<span class="sd">            XC_DIMS(m.size, 2)</span>
<span class="sd">            XC_ARRAY(m.data, m.size(1)*m.size(2))</span>
<span class="sd">        &#39;&#39;&#39;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cpp_map</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="s">&#39;XC_BYTE(&#39;</span><span class="p">,</span> <span class="s">&#39;interface.trans_byte(&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;XC_SIZE(&#39;</span><span class="p">,</span> <span class="s">&#39;interface.trans_num(&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s">&#39;XC_ARRAY(&#39;</span><span class="p">,</span> <span class="s">&#39;interface.data(&#39;</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">!=</span> <span class="s">&#39;&#39;</span><span class="p">]</span>
    <span class="n">content</span> <span class="o">=</span> <span class="s">&#39;def XC_TMP_FUNC(func, interface, </span><span class="si">%s</span><span class="s">, varname):</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">var</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="n">content</span> <span class="o">+=</span> <span class="n">replace</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">cpp_map</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="k">exec</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
    <span class="n">COMMUNICATE_DUMP</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">XC_TMP_FUNC</span>
    <span class="n">content</span> <span class="o">=</span> <span class="s">&#39;def XC_TMP_FUNC(func, interface, </span><span class="si">%s</span><span class="s">, varname):</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">var</span>
    <span class="n">content</span> <span class="o">+=</span> <span class="s">&#39;    interface.trans_type(&quot;T&quot;)</span><span class="se">\n</span><span class="s">&#39;</span>
    <span class="n">content</span> <span class="o">+=</span> <span class="s">&#39;    info(interface, </span><span class="si">%s</span><span class="s">)</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">sample</span>
    <span class="k">exec</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
    <span class="n">TENSOR_INFO</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">XC_TMP_FUNC</span>
    <span class="n">content</span> <span class="o">=</span> <span class="s">&#39;def XC_TMP_FUNC(</span><span class="si">%s</span><span class="s">):</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">var</span>
    <span class="n">content</span> <span class="o">+=</span> <span class="s">&#39;    return [&quot;T&quot;, get_info(</span><span class="si">%s</span><span class="s">)]</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">sample</span>
    <span class="k">exec</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="nb">globals</span><span class="p">())</span>
    <span class="n">TENSOR_GET_INFO</span><span class="p">[</span><span class="n">obj</span><span class="p">]</span> <span class="o">=</span> <span class="n">XC_TMP_FUNC</span>

</div>
<span class="n">dump_tensor</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="s">&#39;obj&#39;</span><span class="p">,</span> <span class="s">&#39;obj[0]&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;&#39;</span>
<span class="s">    XC_BYTE(0)</span>
<span class="s">    XC_SIZE(1)</span>
<span class="s">    XC_SIZE(len(obj))</span>
<span class="s">    XC_ARRAY(obj, len(obj))</span>
<span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="n">dump_tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="s">&#39;obj&#39;</span><span class="p">,</span> <span class="s">&#39;obj.item(0)&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;&#39;</span>
<span class="s">    if obj.flags.f_contiguous:</span>
<span class="s">        XC_BYTE(0)</span>
<span class="s">    else:</span>
<span class="s">        XC_BYTE(1)</span>
<span class="s">    XC_SIZE(obj.ndim)</span>
<span class="s">    XC_ARRAY(obj.shape, obj.ndim)</span>
<span class="s">    total = reduce(lambda x, y: x*y, obj.shape)</span>
<span class="s">    if obj.flags.f_contiguous:</span>
<span class="s">        XC_ARRAY(obj.flatten(&#39;F&#39;), total)</span>
<span class="s">    else:</span>
<span class="s">        XC_ARRAY(obj.flatten(&#39;C&#39;), total)</span>
<span class="s">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Manuel Lopez.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.2b0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>