<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Tangelo Web Services &mdash; Tangelo Web Framework 0.7 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.7',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/tangelo.ico"/>
    <link rel="top" title="Tangelo Web Framework 0.7 documentation" href="index.html" />
    <link rel="next" title="Advanced Usage" href="advanced-usage.html" />
    <link rel="prev" title="Basic Usage" href="basic-usage.html" />
<link rel=stylesheet type=text/css href=_static/tangelo-sphinx.css />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="advanced-usage.html" title="Advanced Usage"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="basic-usage.html" title="Basic Usage"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Tangelo Web Framework 0.7 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tangelo-web-services">
<h1>Tangelo Web Services<a class="headerlink" href="#tangelo-web-services" title="Permalink to this headline">¶</a></h1>
<p>Tangelo&#8217;s special power lies in its ability to run user-created <em>web services</em>
as part of a larger web application.  Essentially, each Python file in Tangelo&#8217;s
web space is associated to a URL; requesting this URL (e.g., by visiting it in a
browser) will cause Tangelo to load the file as a Python module, run a
particular function found within it, and return the output as the content for
the URL.</p>
<p>In other words, <strong>Tangelo web services</strong> mean that <strong>Python code</strong> can become
<strong>web resources</strong>.  Python is a flexible and powerful programming language with
a comprehensive standard library and a galaxy of third-party modules providing
access to all kinds of APIs and software libraries.</p>
<div class="section" id="general-services">
<h2>General Services<a class="headerlink" href="#general-services" title="Permalink to this headline">¶</a></h2>
<p>Here is a simple example of a web service.  Suppose
<tt class="docutils literal"><span class="pre">/home/riker/tangelo_html/calc.py</span></tt> reads as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">tangelo</span>

<span class="n">allowed</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;add&quot;</span><span class="p">,</span> <span class="s">&quot;subtract&quot;</span><span class="p">,</span> <span class="s">&quot;multiply&quot;</span><span class="p">,</span> <span class="s">&quot;divide&quot;</span><span class="p">]</span>

<span class="nd">@tangelo.types</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">operation</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&quot;Parameter &#39;a&#39; is missing!&quot;</span>
    <span class="k">elif</span> <span class="n">b</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&quot;Parameter &#39;b&#39; is missing!&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">operation</span> <span class="o">==</span> <span class="s">&quot;add&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
        <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s">&quot;subtract&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
        <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s">&quot;multiply&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>
        <span class="k">elif</span> <span class="n">operation</span> <span class="o">==</span> <span class="s">&quot;divide&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;Unsupported operation: </span><span class="si">%s</span><span class="se">\n</span><span class="s">Allowed operations are: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">operation</span><span class="p">,</span> <span class="s">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">allowed</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&quot;Could not </span><span class="si">%s</span><span class="s"> &#39;</span><span class="si">%s</span><span class="s">&#39; and &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">operation</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ZeroDivisionError</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&quot;Can&#39;t divide by zero!&quot;</span>
</pre></div>
</div>
<p>This is a Python module named <tt class="docutils literal"><span class="pre">calc</span></tt>, implementing a very rudimentary
four-function calculator in the <tt class="docutils literal"><span class="pre">run()</span></tt> function.  Tangelo will respond to a
request for the URL <a class="reference external" href="/examples/calculator/calc/add?a=33&amp;b=14">/examples/calculator/calc/add?a=33&amp;b=14</a>
(<strong>without</strong> the trailing <tt class="docutils literal"><span class="pre">.py</span></tt>) by loading <tt class="docutils literal"><span class="pre">calc.py</span></tt> as a Python module,
executing its <tt class="docutils literal"><span class="pre">run()</span></tt> function, and returning the result - in this case, the
string <tt class="docutils literal"><span class="pre">47</span></tt> - as the contents of the URL.</p>
<p>The <tt class="docutils literal"><span class="pre">run()</span></tt> function takes three arguments:  a positional argument named
<tt class="docutils literal"><span class="pre">operation</span></tt>, and two keyword arguments named <tt class="docutils literal"><span class="pre">a</span></tt> and <tt class="docutils literal"><span class="pre">b</span></tt>.  Tangelo maps
the positional arguments to any &#8220;path elements&#8221; found after the name of the
script in the URL (in this case, <tt class="docutils literal"><span class="pre">add</span></tt>), while keyword arguments are mapped to
query parameters (<tt class="docutils literal"><span class="pre">33</span></tt> and <tt class="docutils literal"><span class="pre">14</span></tt> in this case).  In other words, the example
URL is the equivalent of running the following short Python script:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">calc</span>
<span class="k">print</span> <span class="n">calc</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s">&quot;add&quot;</span><span class="p">,</span> <span class="s">&quot;33&quot;</span><span class="p">,</span> <span class="s">&quot;14&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that <em>all arguments are passed as strings.</em>  This is due to the way URLs
and associated web technologies work - the URL itself is simply a string, so it
is chunked up into tokens which are then sent to the server.  These arguments
must therefore be cast to appropriate types at run time.  The
<a class="reference internal" href="tangelo-py.html#tangelo.types" title="tangelo.types"><tt class="xref py py-func docutils literal"><span class="pre">tangelo.types()</span></tt></a> decorator offers a convenient way to perform this type
casting automatically, but of course you can do it manually within the service
itself if it is necessary.</p>
<p>Generally speaking, the web endpoints exposed by Tangelo for each Python file
are not meant to be visited directly in a web browser; instead, they provide
data to a web application using Ajax calls to retrieve the data.  Suppose we
wish to use <tt class="docutils literal"><span class="pre">calc.py</span></tt> in a web calculator application, which includes an HTML
file with two fields for the user to type inputs into, and four buttons, one for
each arithmetic operation.  An associated JavaScript file might have code like
the following:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">do_arithmetic</span><span class="p">(</span><span class="nx">op</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">a_val</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#input-a&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">b_val</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#input-b&quot;</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>

    <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
        <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;calc/&quot;</span> <span class="o">+</span> <span class="nx">op</span><span class="p">,</span>
        <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
            <span class="nx">a</span><span class="o">:</span> <span class="nx">a_val</span><span class="p">,</span>
            <span class="nx">b</span><span class="o">:</span> <span class="nx">b_val</span>
        <span class="p">},</span>
        <span class="nx">dataType</span><span class="o">:</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span>
        <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">response</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#result&quot;</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">response</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">jqxhr</span><span class="p">,</span> <span class="nx">textStatus</span><span class="p">,</span> <span class="nx">reason</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#result&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">reason</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span>

<span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#plus&quot;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">do_arithmetic</span><span class="p">(</span><span class="s2">&quot;add&quot;</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#minus&quot;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">do_arithmetic</span><span class="p">(</span><span class="s2">&quot;subtract&quot;</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#times&quot;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">do_arithmetic</span><span class="p">(</span><span class="s2">&quot;multiply&quot;</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#divide&quot;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">do_arithmetic</span><span class="p">(</span><span class="s2">&quot;divide&quot;</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">do_arithmetic()</span></tt> function is called whenever the operation buttons are
clicked; it contains a call to the JQuery <tt class="docutils literal"><span class="pre">ajax()</span></tt> function, which prepares a
URL with query parameters then retrieves data from it.  The <tt class="docutils literal"><span class="pre">success</span></tt> callback
then takes the response from the URL and places it on the webpage so the user
can see the result.  In this way, your web application front end can connect to
the Python back end via Ajax.</p>
<div class="section" id="return-types">
<span id="id1"></span><h3>Return Types<a class="headerlink" href="#return-types" title="Permalink to this headline">¶</a></h3>
<p>The type of the value returned from the <tt class="docutils literal"><span class="pre">run()</span></tt> function determines how Tangelo creates
content for the associated web endpoint.  In the example above, the function
returns a number; Tangelo receives this number and turns it into a string (which
is then delivered to the <tt class="docutils literal"><span class="pre">success</span></tt> callback in the JavaScript code above).  In
general, Tangelo follows this set of steps to determine what to do with the
returned value from a Python service:</p>
<ol class="arabic">
<li><p class="first">If the return value is a <strong>Python object containing a</strong> <tt class="docutils literal"><span class="pre">next()</span></tt>
<strong>method</strong>, Tangelo stores the object in the streaming table, and its
contents can be retrieved via the <a class="reference internal" href="advanced-usage.html#streaming"><em>streaming API</em></a>.</p>
</li>
<li><p class="first">Otherwise, if the return value is a <strong>JSON-serializable Python object</strong>,
Tangelo calls <tt class="docutils literal"><span class="pre">json.dumps()</span></tt> on it to convert it into a string, and then
delivers that string as the content.</p>
<p>Python&#8217;s numeric types are JSON-serializable by default, as is the value
<tt class="docutils literal"><span class="pre">None</span></tt>.  Lists and tuples of serializable items are converted into JSON
lists, while dictionaries with serializable keys and values are converted
into JSON objects.  Finally, any Python object <em>can be made</em>
JSON-serializable by extending <tt class="docutils literal"><span class="pre">json.JSONEncoder</span></tt> (see the
<a class="reference external" href="http://docs.python.org/2/library/json.html#json.JSONEncoder">Python documentation</a> for more
information).</p>
<p>If a <strong>non</strong>-JSON-serializable object is returned, this will result in a
server error.</p>
</li>
<li><p class="first">Otherwise, if the return value is a <strong>string</strong>, then Tangelo treats the
return value as the final result; i.e., it delivers the return value without
changing it.</p>
</li>
<li><p class="first">Finally, if the return value <strong>does not fit into any of the above
steps</strong>, Tangelo will report a server error.</p>
</li>
</ol>
</div>
<div class="section" id="specifying-a-custom-return-type-converter">
<h3>Specifying a Custom Return Type Converter<a class="headerlink" href="#specifying-a-custom-return-type-converter" title="Permalink to this headline">¶</a></h3>
<p>Similarly to the <a class="reference internal" href="tangelo-py.html#tangelo.types" title="tangelo.types"><tt class="xref py py-func docutils literal"><span class="pre">tangelo.types()</span></tt></a> decorator mentioned above, services
can specify a custom return type via the <a class="reference internal" href="tangelo-py.html#tangelo.return_type" title="tangelo.return_type"><tt class="xref py py-func docutils literal"><span class="pre">tangelo.return_type()</span></tt></a>
decorator.  It takes a single argument, a function to convert the object
returned from the service function to a string (or other legal service return
type; see <a class="reference internal" href="#return-types"><em>Return Types</em></a>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">tangelo</span>

<span class="k">def</span> <span class="nf">excited</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">+</span> <span class="s">&quot;!!!&quot;</span>

<span class="nd">@tangelo.return_type</span><span class="p">(</span><span class="n">excited</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">return</span> <span class="s">&quot;hello </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>
</div>
<p>Given <tt class="docutils literal"><span class="pre">Data</span></tt> as an input, this service will return the string <tt class="docutils literal"><span class="pre">Hello</span>
<span class="pre">Data!!!</span></tt> to the client.</p>
<p>A more likely use case for this decorator is special-purpose JSON converters,
such as Pymongo&#8217;s <tt class="docutils literal"><span class="pre">bson.json_util.dumps()</span></tt> function, which can handle certain
non-standard objects such as Python <tt class="docutils literal"><span class="pre">datetime</span></tt> objects when converting to JSON
text.</p>
</div>
</div>
<div class="section" id="restful-services">
<h2>RESTful Services<a class="headerlink" href="#restful-services" title="Permalink to this headline">¶</a></h2>
<p>Tangelo also supports the creation of REST services.  Instead of placing
functionality in a <tt class="docutils literal"><span class="pre">run()</span></tt> function, such a service has one function per
desired REST verb.  For example, a rudimentary service to manage a collection of
databases might look like the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">tangelo</span>
<span class="kn">import</span> <span class="nn">lcarsdb</span>

<span class="nd">@tangelo.restful</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">dbname</span><span class="p">,</span> <span class="n">query</span><span class="p">):</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">lcarsdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&quot;enterprise.starfleet.mil&quot;</span><span class="p">,</span> <span class="n">dbname</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">db</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">db</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>

<span class="nd">@tangelo.restful</span>
<span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="n">dbname</span><span class="p">):</span>
    <span class="n">connection</span> <span class="o">=</span> <span class="n">lcarsdb</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s">&quot;enterprise.starfleet.mil&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">connection</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">&quot;FAIL&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">success</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">createDB</span><span class="p">(</span><span class="n">dbname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;OK&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;FAIL&quot;</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="tangelo-py.html#tangelo.restful" title="tangelo.restful"><tt class="xref py py-func docutils literal"><span class="pre">tangelo.restful()</span></tt></a> decorator is used to explicitly mark the
functions that are part of the RESTful interface so as to avoid (1) restricting
REST verbs to just the set of commonly used ones and (2) exposing every function
in the service as part of a REST interface (since some of those could simply be
helper functions).</p>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>You can optionally include a configuration file alongside the service itself.
For instance, suppose the following service is implemented in <cite>autodestruct.py</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">tangelo</span>
<span class="kn">import</span> <span class="nn">starship</span>

<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">officer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">countdown</span><span class="o">=</span><span class="mi">20</span><span class="o">*</span><span class="mi">60</span><span class="p">):</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">tangelo</span><span class="o">.</span><span class="n">config</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">officer</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">code</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">&quot;status&quot;</span><span class="p">:</span> <span class="s">&quot;failed&quot;</span><span class="p">,</span>
                <span class="s">&quot;reason&quot;</span><span class="p">:</span> <span class="s">&quot;missing officer or code argument&quot;</span><span class="p">}</span>

    <span class="k">if</span> <span class="n">officer</span> <span class="o">!=</span> <span class="n">config</span><span class="p">[</span><span class="s">&quot;officer&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">&quot;status&quot;</span><span class="p">:</span> <span class="s">&quot;failed&quot;</span><span class="p">,</span>
                <span class="s">&quot;reason&quot;</span><span class="p">:</span> <span class="s">&quot;unauthorized&quot;</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">code</span> <span class="o">!=</span> <span class="n">config</span><span class="p">[</span><span class="s">&quot;code&quot;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s">&quot;status&quot;</span><span class="p">:</span> <span class="s">&quot;failed&quot;</span><span class="p">,</span>
                <span class="s">&quot;reason&quot;</span><span class="p">:</span> <span class="s">&quot;incorrect code&quot;</span><span class="p">}</span>

    <span class="n">starship</span><span class="o">.</span><span class="n">autodestruct</span><span class="p">(</span><span class="n">countdown</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span> <span class="s">&quot;status&quot;</span><span class="p">:</span> <span class="s">&quot;complete&quot;</span><span class="p">,</span>
             <span class="s">&quot;message&quot;</span><span class="p">:</span> <span class="s">&quot;Auto destruct in </span><span class="si">%d</span><span class="s"> seconds!&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">countdown</span><span class="p">)</span> <span class="p">}</span>
</pre></div>
</div>
<p>Via the <tt class="xref py py-func docutils literal"><span class="pre">tangelo.config()</span></tt> function, this service attempts to match the
input data against credentials stored in the module level configuration, which
is stored in <cite>autodestruct.json</cite>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;officer&quot;</span><span class="o">:</span> <span class="s2">&quot;picard&quot;</span><span class="p">,</span>
    <span class="s2">&quot;code&quot;</span><span class="o">:</span> <span class="s2">&quot;echo november golf alpha golf echo four seven enable&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The two files must have the same base name (<cite>autodestruct</cite> in this case) and be
in the same location. Any time the module for a service is loaded, the
configuration file will be parsed and loaded as well.  Changing either file will
cause the module to be reloaded the next time it is invoked.  The
<tt class="docutils literal"><span class="pre">tangelo.config()</span></tt> function returns a copy of the configuration dictionary, to
prevent an errant service from updating the configuration in a persistent way.
For this reason, it is advisable to only call this function once, capturing the
result in a variable, and retrieving values from it as needed.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tangelo Web Services</a><ul>
<li><a class="reference internal" href="#general-services">General Services</a><ul>
<li><a class="reference internal" href="#return-types">Return Types</a></li>
<li><a class="reference internal" href="#specifying-a-custom-return-type-converter">Specifying a Custom Return Type Converter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#restful-services">RESTful Services</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="basic-usage.html"
                        title="previous chapter">Basic Usage</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="advanced-usage.html"
                        title="next chapter">Advanced Usage</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/python-services.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="advanced-usage.html" title="Advanced Usage"
             >next</a> |</li>
        <li class="right" >
          <a href="basic-usage.html" title="Basic Usage"
             >previous</a> |</li>
        <li><a href="index.html">Tangelo Web Framework 0.7 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Kitware, Inc..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>