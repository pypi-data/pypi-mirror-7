Установка приложения в проекте
==============================

* Установить приложение в окружение

* Добавить в *settings.MIDDLEWARE_CLASSES*, *django_smoknur.middleware.WriteRequests*

* Добавить в *settings.INSTALLED_APPS*, *django_smoknur*

* Добавить в *urls*, урл приложения::

     from django_smoknur.urls import get_urls
     urlpatterns += get_urls()

* Опциональные параметры *settings*

    * *SMOKNUR_EXCLUDE_APP_DUMPDATA* - кортеж приложений, которые необходимо исключить при дампе БД через приложение
    * *SMOKNUR_USERNAME*, *SMOKNUR_PASSWORD* - параметры пользоватея. если они заданы, пользователь автоматический авторизуется перед каждым тестом
    * *SMOKNUR_EXCLUDE_APPS* - приложения, исключенные из тестов
    * *SMOKNUR_NEW_DJANGO_TESTCASE* - включает фикс для теста, для нормальной работы в джанго 1.6. По умолчанию включен. В *TransactionTestCase*, в методе *_fixture_setup* отсутствует вызов *call_command('flush', ...)*, что на мой взгляд не правильно.

Пример записи сценария
======================

1. Имеется чистая БД с 1 пользователем.

2. Пользователь авторизуется.

3. Заходим на страничку */smoknur*

4. Сохраняем дамп БД.

    * Скачается *.json* файл дампа БД, который может быть использован в качетсве фикстур для конкретного сценария.  
    
    * Файлик был получен командой *./manage.py dumpdata*, исключая приложения *settings.SMOKNUR_EXCLUDE_APP_DUMPDATA*.

5. Включаем запись отладочной информации. 

6. Переходим на главную страницу проекта и работаем с проектом  
    
    * В это время, мидлвара *smoknur.middleware.WriteRequests* будет записывать все запросы на сервер в *.dbg* файлик, с POST параметрами.

7. Заходим на страничку */smoknur*

8. Выключаем *запись отладочной информации*

9. Скачиваем *отладочную информацию*

10. Кладем файлик сценария в соответствующее приложение, в папку *smoknur*, при необходимости файлик фикстур туда же.


Как работают тесты
==================

1. Запускаем тест *./manage.py django-smoknur*
2. На каждое приложение из *settings.PROJECTS_APPS* создается *TestCase*, если приложение имеет папку *smoknur*
  
    * Если в папке имеется *.json* файл, он будет использован в качестве начальной фикстуры  
    
    * Все *.dbg* файлы читаются, и прогоняются запросы к системы из этих фалов.


Также в модуле имеется менедж команда *load_dbg*, которой передается 1 параметр, название приложения. 
Данная команда отправляет запросы, находящиеся в папке *smoknur* приложения.
Иногда необходима для востановления состояния БД, для последующих тестов.
Фикстуры приложения она не заливает.