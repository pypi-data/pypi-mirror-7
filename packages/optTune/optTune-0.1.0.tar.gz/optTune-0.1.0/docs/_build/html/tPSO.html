<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>tPSO &mdash; optTune 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="optTune 0.1.0 documentation" href="index.html" />
    <link rel="next" title="FBM" href="FBM.html" />
    <link rel="prev" title="tMOPSO" href="tMOPSO.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="FBM.html" title="FBM"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tMOPSO.html" title="tMOPSO"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">optTune 0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-optTune.tPSO_code">
<span id="tpso"></span><h1>tPSO<a class="headerlink" href="#module-optTune.tPSO_code" title="Permalink to this headline">¶</a></h1>
<p>tuning particle swarm optimiser (tPSO) for tuning optimization algorithms according to single objective.
tPSO is a stripped down version of tMOPSO, which only focuses on a single OFE budget only.</p>
<dl class="class">
<dt id="optTune.tPSO">
<em class="property">class </em><tt class="descclassname">optTune.</tt><tt class="descname">tPSO</tt><big>(</big><em>optAlg</em>, <em>OFE_budget</em>, <em>CPV_lb</em>, <em>CPV_ub</em>, <em>CPV_validity_checks</em>, <em>sampleSizes</em>, <em>gammaBudget</em>, <em>N=15</em>, <em>w=0.4</em>, <em>c_g=2.0</em>, <em>c_p=2.0</em>, <em>resampling_interruption_confidence=0.9</em>, <em>constrain_to_initilization_bounds=False</em>, <em>saveTo=None</em>, <em>saveInterval=10</em>, <em>printFunction=&lt;function to_stdout at 0x2b1de403dcf8&gt;</em>, <em>printLevel=2</em>, <em>addtoBatch=&lt;function _passfunction at 0x2b1ddd480230&gt;</em>, <em>processBatch=&lt;function _passfunction at 0x2b1ddd480230&gt;</em>, <em>post_iteration_function=&lt;function _passfunction at 0x2b1ddd480230&gt;</em>, <em>record_X_hist=True</em>, <em>record_V_hist=True</em><big>)</big><a class="headerlink" href="#optTune.tPSO" title="Permalink to this definition">¶</a></dt>
<dd><p>Single-objective particle swarm optimisation for tuning optimization algorithms to single OFE  budget</p>
<dl class="docutils">
<dt>Required Args</dt>
<dd><ul class="first last simple">
<li>optAlg - function called with args (CPVs, OFE_budget, randomSeed) and return best solution error, (i.e f_found_opt - f_min)</li>
<li>OFE_budget - OFE budget under which optAlg is tuned</li>
<li>CPV_lb - initialization lower bound for CPV tuning, i.e.  numpy.array([CPV_1_init_lb, CPV_2_init_lb, ...])</li>
<li>CPV_ub - numpy.array([CPV_1_init_ub, CPV_2_init_ub, ...])</li>
<li>CPV_validity_checks - function used to check validity of candidate CPVs. Usage CPV_validity_checks(CPV_array, OFE_budget) returns tuple (valid, msg) where msg is string of why invalid. Should be a cheap function, as candidate CPVs are regenerated if they do not satisfy it. Use to prevent negative population sizes, populations size larger then OFE_budget checks, etcetera.</li>
<li>CPV_ineq - vector which returned the amount by which each inequality constraint is violated. This should be a cheap function, as candidate CPVs are regenerated if they do not satisfy it. Use to prevent negative population sizes etcetera. Input vector of CPVs like CPV_lb</li>
<li>sampleSizes - sample sizes used to generate and refined CPV utility values. For example if the sampleSizes are [5,15,30] all candidate CPVs will be sampled 5 times, the possible not dominated CPVs are then sampled another 15 times, and if still promising another 30 times. CPV which returned performances are therefore averaged over 50 independent instances.</li>
<li>gammaBudget - the number of application layer evaluations (evaluation of the function optAlg optimizes) allocated for the tuning. NB include repeats, i.e. assessing optAlg for on OFE budget of 100 at 5 repeats, counts as a gamma of 500.</li>
</ul>
</dd>
<dt>Optional Args</dt>
<dd><ul class="first last simple">
<li>saveTo - filename used to save optimization progress (one save per itteration), use None to disable saving</li>
<li>N - tMOPSO population size</li>
<li>w - tMOPSO particle inertia factor</li>
<li>c_g - parameter controling the attraction towards the global guide</li>
<li>c_p - parameter controling the attraction towards the particles personal guide</li>
<li>resampling_interruption_confidence - re-sampling interuption confindence level used by noise stratergy</li>
<li>printLevel - 0 no printing, 1 only warnings, 2 overall info, 3 lots of info, 4 verbose (not implemented)</li>
<li>addtoBatch - args for optAlg, passed to this function before optAlg is called,</li>
<li>processBatch - function is called after all addtoBatch_function have been called. If used then optAlg, should be retrieve solutions from this functions results</li>
<li>post_iteration_function - at the end of each iteration this function is called with tPSO instance as the only arg.</li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Pure Python example</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Tune the simulated annealing algorithm from the scipy package to the 5D Rosenbrock problem, for multiple objective function evaluation budgets simulatenously. The contorl parameter values (CPVs)  tuned are those which control are those which control the rate of exploration versus the rate of exploitation, namely </span>
<span class="sd"> * m - control how quickly the Temperature cools down, i.e. higher m = higher exploration and lower exploitation.</span>
<span class="sd">        c = m * exp(-n * quench)</span>
<span class="sd">        T_new = T0 * exp(-c * k**quench)</span>
<span class="sd"> * dwell - evaluation at each tempreture</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="kn">from</span> <span class="nn">optTune</span> <span class="kn">import</span> <span class="n">tPSO</span>


<span class="k">def</span> <span class="nf">Ros_ND</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">:</span>
    <span class="s">&quot;gerneralised Rossenbrock function&quot;</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>

<span class="k">def</span> <span class="nf">run_simulated_annealing</span><span class="p">(</span><span class="n">CPVs</span><span class="p">,</span> <span class="n">OFE_budget</span><span class="p">,</span> <span class="n">randomSeed</span><span class="p">):</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">anneal</span><span class="p">(</span><span class="n">Ros_ND</span><span class="p">,</span> 
                    <span class="n">x0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.048</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mf">2.048</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
                    <span class="n">dwell</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">CPVs</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> 
                    <span class="n">m</span> <span class="o">=</span> <span class="n">CPVs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">T0</span> <span class="o">=</span> <span class="mf">500.0</span><span class="p">,</span>
                    <span class="n">lower</span><span class="o">=</span> <span class="o">-</span><span class="mf">2.048</span><span class="p">,</span>
                    <span class="n">upper</span><span class="o">=</span>  <span class="mf">2.048</span><span class="p">,</span>
                    <span class="n">maxeval</span> <span class="o">=</span> <span class="n">OFE_budget</span><span class="p">,</span> <span class="c">#termination criteria</span>
                    <span class="n">feps</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> 
                    <span class="n">Tf</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="k">return</span>  <span class="n">Ros_ND</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c"># where xMin = R[0]</span>

<span class="k">def</span> <span class="nf">CPV_valid</span><span class="p">(</span><span class="n">CPVs</span><span class="p">,</span> <span class="n">OFE_budget</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">CPVs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">OFE_budget</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;dwell,CPVs[0] &gt; OFE budget&#39;</span>
    <span class="k">if</span> <span class="n">CPVs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span><span class="p">,</span><span class="s">&#39;dwell,CPVs[0] &lt; 5&#39;</span>
    <span class="k">if</span> <span class="n">CPVs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span><span class="p">,</span><span class="s">&#39;CPVs[1] &lt; 0.0001&#39;</span>
    <span class="k">return</span> <span class="bp">True</span><span class="p">,</span><span class="s">&#39;&#39;</span>

<span class="n">tuningOpt</span> <span class="o">=</span> <span class="n">tPSO</span><span class="p">(</span> 
    <span class="n">optAlg</span> <span class="o">=</span> <span class="n">run_simulated_annealing</span><span class="p">,</span> 
    <span class="n">CPV_lb</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> 
    <span class="n">CPV_ub</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">50</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">]),</span>
    <span class="n">CPV_validity_checks</span> <span class="o">=</span> <span class="n">CPV_valid</span><span class="p">,</span>
    <span class="n">OFE_budget</span><span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="n">sampleSizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span> <span class="c">#resampling size of 30</span>
    <span class="n">resampling_interruption_confidence</span> <span class="o">=</span> <span class="mf">0.6</span><span class="p">,</span>
    <span class="n">gammaBudget</span> <span class="o">=</span> <span class="mi">500</span><span class="o">*</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tuningOpt</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">&#39;&#39;&#39;Best CPVs founds for Rossenbrock 5D, given an OFE budget of </span><span class="si">%i</span><span class="s">, </span>
<span class="s">  - dwell               </span><span class="si">%f</span><span class="s"></span>
<span class="s">  - cool down rate (m)  </span><span class="si">%f</span><span class="s"></span>
<span class="s">&#39;&#39;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tuningOpt</span><span class="o">.</span><span class="n">OFE_budget</span><span class="p">,</span> <span class="n">tuningOpt</span><span class="o">.</span><span class="n">x_gb</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tuningOpt</span><span class="o">.</span><span class="n">x_gb</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">tPSO</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tMOPSO.html"
                        title="previous chapter">tMOPSO</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="FBM.html"
                        title="next chapter">FBM</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tPSO.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="FBM.html" title="FBM"
             >next</a> |</li>
        <li class="right" >
          <a href="tMOPSO.html" title="tMOPSO"
             >previous</a> |</li>
        <li><a href="index.html">optTune 0.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Antoine Dymond.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>