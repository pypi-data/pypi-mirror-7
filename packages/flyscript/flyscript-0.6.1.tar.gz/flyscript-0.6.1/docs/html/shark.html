<html>
<head>
<link rel="stylesheet" href="ridl.css" />
<link rel="stylesheet" href="flyscript.css" />
<title>FlyScript Documentation</title>
</head>

<body>
<div class="header">
<a href="http://www.riverbed.com"><img src="rb-logo.png" align="left"></a>
<div>
<p class="headerleft">FlyScript Documentation</p>
<p class="headerright"> Version 0.6.1
 - last updated May 01, 2014 at 01:05 PM</p>

</div>

</div>

<div class="navbar">

<div class="links" markdown="1">

<p><span class="toctitle">Quick Links:</span></p>
<ul>
<li><a href="index.html">Home</a></li>
<li><a href="tutorials.html">Tutorials</a></li>
<li>Modules<ul>
<li><a href="common.html"><code>rvbd.common</code></a></li>
<li><a href="shark.html"><code>rvbd.shark</code></a></li>
<li><a href="profiler.html"><code>rvbd.profiler</code></a></li>
</ul>
</li>
<li><a href="rest_apis.html">REST APIs</a></li>
<li><a href="glossary.html">Glossary</a></li>
</ul>
</div>

<div class="toc"><span class="toctitle">On this page:</span><ul>
<li><a href="#rvbdshark">rvbd.shark</a><ul>
<li><a href="#sharkobjects">Shark objects</a></li>
<li><a href="#sourceobjects">Packet source objects</a><ul>
<li><a href="#capturejobobjects">Capture Job objects</a></li>
<li><a href="#traceclips">Trace Clip objects</a></li>
</ul>
</li>
<li><a href="#extractorobjects">Extractor Field objects</a></li>
<li><a href="#viewobjects">View objects</a><ul>
<li><a href="#outputobjects">Output objects</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#rvbdsharkviewutils">rvbd.shark.viewutils</a><ul>
<li><a href="#utilities-for-writing-view-data">Utilities for writing view data</a></li>
<li><a href="#mixing-multiple-view-outputs">Mixing multiple view outputs</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div class="content">

<h1 id="rvbdshark">rvbd.shark</h1>
<p>The Shark package offers a set of interfaces to control and work with
a Cascade Shark Appliance.
The functionality in the module includes:</p>
<p>This documentation assumes you are already familiar with the
Riverbed Shark Appliance,
specifically concepts like Capture Jobs and Views.
If you are not already familiar with these concepts,
see the <a href="background">introduction to the Shark architecture</a>
and/or the <a href="http://www.riverbed.com/us/products/cascade/cascade_shark_overview.php">Shark manual</a>.</p>
<p>The primary interface to the Shark-related flyscript functionality
is the class <code>rvbd.shark.Shark</code>.
An instance of this object represents a connection to a Shark server,
and can be used to examine packet sources and existing views on the
server, as well as to configure and create new views, capture jobs, etc.</p>
<p>There are many more classes in the Shark libraries, representing
things like views, capture jobs, trace clips, etc.
But these should never be instantiated directly from scripts,
they are returned by methods on Shark objects.</p>
<h2 class="linkable" id="sharkobjects"><a href="#sharkobjects">Shark objects</a><span class="link-icon"></span></h2>
<p><a name="class_rvbd_shark_Shark" href="#class_rvbd_shark_Shark" class="linkable">class <code>rvbd.shark.Shark</code><span class="link-icon"></span></a></p>
<p>The Shark class is the main interface to interact with a Shark Appliance.
Among other things, it makes it possible to manage <a href="glossary.html#view">views</a>, jobs, files and
<a href="glossary.html#traceclip">trace clips</a>, and to query and modify the appliance settings.</p>
<p><strong>Shark</strong>(<em>host</em>, <em>port</em>=None, <em>auth</em>=None, <em>force_version</em>=None)</p>
<p><div class="docstring" markdown="1">
Establishes a connection to a Shark appliance.</p>
<p><code>host</code> is the name or IP address of the Shark to connect to</p>
<p><code>port</code> is the TCP port on which the Shark appliance listens.
         if this parameter is not specified, the function will
         try to automatically determine the port.</p>
<p><code>auth</code> defines the authentication method and credentials to use
         to access the Shark.  It should be an instance of
         <a href="common.html#userauth">rvbd.common.UserAuth</a> or <a href="common.html#oauth">rvbd.common.OAuth</a>.</p>
<p><code>force_version</code> is the API version to use when communicating.
         if unspecified, this will use the latest version supported
         by both this implementation and the Shark appliance.</p>
<p>See the base <a href="common.html#service">Service</a> class for more information
about additional functionality supported.</p>
</div>

<p>The following methods provide general information about a Shark</p>
<p><a name="method_rvbd_shark_Shark_get_serverinfo" href="#method_rvbd_shark_Shark_get_serverinfo" class="linkable"><strong>get_serverinfo</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Get the Shark appliance overall info.</p>
<p>Return Value: a named tuple with the server parameters</p>
</div>

<p><a name="method_rvbd_shark_Shark_get_protocol_version" href="#method_rvbd_shark_Shark_get_protocol_version" class="linkable"><strong>get_protocol_version</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return the API protocol version used by this shark.</p>
</div>

<p><a name="method_rvbd_shark_Shark_get_logininfo" href="#method_rvbd_shark_Shark_get_logininfo" class="linkable"><strong>get_logininfo</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return a dictionary with the information useful prior to
logging in to the shark, including the protocol version,
banner, and whether or not a login purpose should be
requested from the user.</p>
</div>

<p><a name="method_rvbd_shark_Shark_get_stats" href="#method_rvbd_shark_Shark_get_stats" class="linkable"><strong>get_stats</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Get the Shark appliance storage info</p>
</div>

<hr />
<p>The following methods are used to access <a href="glossary.html#view">views</a>.
Each of these methods returns a <a href="#viewobjects">view object</a>.</p>
<p><a name="method_rvbd_shark_Shark_get_open_views" href="#method_rvbd_shark_Shark_get_open_views" class="linkable"><strong>get_open_views</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Get a list of View objects, one for each open <a href="glossary.html#view">view</a> on
the Shark appliance.</p>
</div>

<p><a name="method_rvbd_shark_Shark_get_open_view_by_handle" href="#method_rvbd_shark_Shark_get_open_view_by_handle" class="linkable"><strong>get_open_view_by_handle</strong>(<em>handle</em>)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Look up the <a href="glossary.html#view">view</a> <code>handle</code> and return its View object</p>
</div>

<p><a name="method_rvbd_shark_Shark_create_view" href="#method_rvbd_shark_Shark_create_view" class="linkable"><strong>create_view</strong>(<em>src</em>, <em>columns</em>, <em>filters</em>=None, <em>start_time</em>=None, <em>end_time</em>=None, <em>name</em>=None, <em>charts</em>=None, <em>sync</em>=True, <em>sampling_time_msec</em>=None)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Create a new <a href="glossary.html#view">view</a> on this Shark.</p>
<p><code>src</code> identifies the source of packets to be analyzed.
It may be any <a href="shark.html#sourceobjects">packet source object</a>.</p>
<p><code>columns</code> specifies what information is extracted from
packets and presented in this <a href="glossary.html#view">view</a>.  It should be a list
of <code>Key</code> and <code>Value</code> objects.</p>
<p><code>filters</code> is an optional list of filters that can be used
to limit which packets from the <a href="glossary.html#packetsource">packet source</a> are processed
by this <a href="glossary.html#view">view</a>.</p>
</div>

<p><a name="method_rvbd_shark_Shark_create_view_from_template" href="#method_rvbd_shark_Shark_create_view_from_template" class="linkable"><strong>create_view_from_template</strong>(<em>source</em>, <em>template</em>, <em>name</em>=None, <em>sync</em>=True)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Create a new <a href="glossary.html#view">view</a> on this Shark using <code>template</code>.
For 9.5.x and earlier, <code>template</code> should be an XML <a href="glossary.html#view">view</a>
document, for later releases, <code>template</code> should be a
JSON <a href="glossary.html#view">view</a> description.</p>
</div>

<hr />
<p>The following methods are used to access packet sources
(e.g., to obtain an object that can be used as an argument to
<a href="#method_rvbd_shark_create_view"><code>create_view</code></a>, <a href="#method_rvbd_shark_create_job"><code>create_job</code></a>, etc...
The objects they return are described below in the section
<a href="#sourceobjects">Packet source objects</a>.</p>
<p><a name="method_rvbd_shark_Shark_get_interfaces" href="#method_rvbd_shark_Shark_get_interfaces" class="linkable"><strong>get_interfaces</strong>(<em>force_refetch</em>=False)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return a list of Interface objects, corresponding to the
capture interfaces available on the Shark.</p>
<p>If <code>force_refetch</code> is True, the list of interfaces will be
re-fetched from the Shark.  Otherwise, the list may be cached.</p>
</div>

<p><a name="method_rvbd_shark_Shark_get_interface_by_name" href="#method_rvbd_shark_Shark_get_interface_by_name" class="linkable"><strong>get_interface_by_name</strong>(<em>ifname</em>, <em>force_refetch</em>=False)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return an Interface object corresponding to the
interface named <code>ifname</code>.</p>
<p>If <code>force_refetch</code> is True, the list of interfaces will be
re-fetched from the Shark.  Otherwise, the list may be cached.</p>
</div>

<p><a name="method_rvbd_shark_Shark_get_capture_jobs" href="#method_rvbd_shark_Shark_get_capture_jobs" class="linkable"><strong>get_capture_jobs</strong>(<em>force_refetch</em>=False)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return a list of CaptureJob objects, corresponding to the
<a href="glossary.html#capturejob">capture jobs</a> currently running on the Shark.</p>
<p>If <code>force_refetch</code> is True, the list of jobs will be
re-fetched from the Shark.  Otherwise, the list may be cached.</p>
</div>

<p><a name="method_rvbd_shark_Shark_get_capture_job_by_name" href="#method_rvbd_shark_Shark_get_capture_job_by_name" class="linkable"><strong>get_capture_job_by_name</strong>(<em>jobname</em>, <em>force_refetch</em>=False)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return a CaptureJob object for the <a href="glossary.html#capturejob">capture job</a> <code>jobname</code></p>
<p>If <code>force_refetch</code> is True, the list of jobs will be
re-fetched from the Shark.  Otherwise, the list may be cached.</p>
</div>

<p><a name="method_rvbd_shark_Shark_create_job" href="#method_rvbd_shark_Shark_create_job" class="linkable"><strong>create_job</strong>(<em>interface</em>, <em>name</em>, <em>packet_retention_size_limit</em>, <em>packet_retention_packet_limit</em>=None, <em>packet_retention_time_limit</em>=None, <em>bpf_filter</em>=None, <em>snap_length</em>=65525, <em>indexing_size_limit</em>=None, <em>indexing_synced</em>=False, <em>indexing_time_limit</em>=None, <em>start_immediately</em>=False, <em>requested_start_time</em>=None, <em>requested_stop_time</em>=None, <em>stop_rule_size_limit</em>=None, <em>stop_rule_packet_limit</em>=None, <em>stop_rule_time_limit</em>=None)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Create a Capture Job on this Shark, and return it as a
a <a href="glossary.html#capturejob">capture job</a> object that can be used to work with the new job.</p>
<p><code>interface</code> is an interface object identifying the source of the packets
that this job will capture. The method <a href="#method_rvbd_shark_Shark_get_interfaces"><code>get_interfaces()</code></a> returns
interface objects for all interfaces on this shark.</p>
<p><code>name</code> is the name that the job will have after being created,
and that will be used to identify the job for successive operations.</p>
<p><code>packet_retention_size_limit</code> is the maximum size on disk that the job
will reach before old packets begin to be discarded.
<code>packet_retention_size_limit</code> can be expressed as a number
(in which case the unit will be bytes), or as a string.
The format of the string can be Number and unit (e.g. "1.3GB"),
or percentage of total disk spoace (e.g. "20%").</p>
<p><code>packet_retention_packet_limit</code>: the maximum number of packets that
the job can contain before old packets begin to be discarded.</p>
<p><code>packet_retention_time_limit</code> a <code>datetime.timedelta</code> object
specifying the maximum time interval that the job may contain before
old packets begin to be discarded.</p>
<p><code>bpf_filter</code> is a filter, based on the Wireshark capture filter
syntax, that selects which incoming packets should be saved
in the job.</p>
<p><code>snap_length</code> is the portion of each packet that will be written on
disk, in bytes. The default value of 65535 ensure that every packet is
captured in its entirety.</p>
<p><code>indexing_size_limit</code> is the maximum size on disk that the index may
reach before old index data may be discarded.
It is specified in the same format as <code>keep_size</code>.</p>
<p>If <code>indexing_synced</code> is True the job Microflow Index will be
automatically pruned to cover the same time extension of the captured
packets.</p>
<p><code>indexing_time_limit</code> is a <code>datetime.timedelta</code> object indicating
how long index data should be retained.  This argument is only
meaningful if <code>index_and_capture_synced</code> is False.</p>
<p>If <code>start_immediately</code> is True, the Job is started after it has been
created.</p>
<p><code>requested_start_time</code> and <code>requested_stop_time</code> are <code>datetime.datetime</code>
objects that, if specified, determine the absolute time when the
job will start/stop.</p>
<p>If <code>stop_rule_size_limit</code> is specified, the job will stop storing
new packets when the given size on disk is reached.  It is specified
in the same format as <code>keep_size</code>.</p>
<p>If <code>stop_rule_packet_limit</code> is specified, the job will stop storing new
packets when the given number of packets is reached.</p>
<p>If <code>stop_rule_time_limit</code> is specified, it should be a
<code>datetime.timedelta</code> object, and the job will stop storing new
packets when the given time has elapsed.</p>
</div>

<p><a name="method_rvbd_shark_Shark_get_clips" href="#method_rvbd_shark_Shark_get_clips" class="linkable"><strong>get_clips</strong>(<em>force_refetch</em>=False)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return a list of TraceClip objects, corresponding to the
<a href="glossary.html#traceclip">trace clips</a> available on the Shark.</p>
<p>If <code>force_refetch</code> is True, the list of clips will be
re-fetched from the Shark.  Otherwise, the list may be cached.</p>
</div>

<p><a name="method_rvbd_shark_Shark_create_clip" href="#method_rvbd_shark_Shark_create_clip" class="linkable"><strong>create_clip</strong>(<em>job</em>, <em>filters</em>, <em>description</em>, <em>locked</em>=True)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Create a clip in the Shark appliance</p>
</div>

<p><a name="method_rvbd_shark_Shark_get_trace_clip_by_description" href="#method_rvbd_shark_Shark_get_trace_clip_by_description" class="linkable"><strong>get_trace_clip_by_description</strong>(<em>description</em>, <em>force_refetch</em>=False)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return a TraceClip object for the <a href="glossary.html#traceclip">trace clip</a> with the given
description.</p>
<p>If <code>force_refetch</code> is True, the list of jobs will be
re-fetched from the Shark.  Otherwise, the list may be cached.</p>
<p><strong>Note</strong>: Clips don't have descriptions by default. A description can
be added to a clip by right-clicking on it in Pilot.</p>
</div>

<p><a name="method_rvbd_shark_Shark_get_files" href="#method_rvbd_shark_Shark_get_files" class="linkable"><strong>get_files</strong>(<em>force_refetch</em>=False)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return a list of TraceFile, MergedFile or Multisegment objects,
corresponding to the trace files available on the Shark.</p>
<p>If <code>force_refetch</code> is True, the list of files will be
re-fetched from the Shark.  Otherwise, the list may be cached.</p>
</div>

<hr />
<p>The following methods are used to work directly with trace files
on the Shark appliance filesystem:</p>
<p><a name="method_rvbd_shark_Shark_get_dir" href="#method_rvbd_shark_Shark_get_dir" class="linkable"><strong>get_dir</strong>(<em>path</em>)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Get a directory. It will trigger an exception if the directory does not
exist.
Return Value: a reference to the directory</p>
</div>

<p><a name="method_rvbd_shark_Shark_get_file" href="#method_rvbd_shark_Shark_get_file" class="linkable"><strong>get_file</strong>(<em>path</em>)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Given a path retrieve the <code>File</code> associated with it</p>
</div>

<p><a name="method_rvbd_shark_Shark_exists" href="#method_rvbd_shark_Shark_exists" class="linkable"><strong>exists</strong>(<em>path</em>)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Check if a path exists, works for files or directories.
Return Value: true if the path exists, false otherwise</p>
</div>

<p><a name="method_rvbd_shark_Shark_create_dir" href="#method_rvbd_shark_Shark_create_dir" class="linkable"><strong>create_dir</strong>(<em>path</em>)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Create a new directory. It will trigger an exception if the directory
exist.
Return Value: a reference to the new directory</p>
</div>

<p><a name="method_rvbd_shark_Shark_create_multisegment_file" href="#method_rvbd_shark_Shark_create_multisegment_file" class="linkable"><strong>create_multisegment_file</strong>(<em>path</em>, <em>files</em>=None)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Creates a multisegment file. 'path' is the new file full name and
'files' is a File objects list
Return Value: a reference to the new file</p>
</div>

<p><a name="method_rvbd_shark_Shark_create_merged_file" href="#method_rvbd_shark_Shark_create_merged_file" class="linkable"><strong>create_merged_file</strong>(<em>path</em>, <em>files</em>=None)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Creates a merged file. 'path' is the new file full name and
'files' is a File objects list
Return Value: a reference to the new file</p>
</div>

<p><a name="method_rvbd_shark_Shark_upload_trace_file" href="#method_rvbd_shark_Shark_upload_trace_file" class="linkable"><strong>upload_trace_file</strong>(<em>path</em>, <em>local_file</em>)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Uploads a new trace file. 'path' is the complete destination path,
'local_file' is the the local file to upload.
Return Value: reference to the new trace file</p>
</div>

<hr />
<p>The following methods are used to access
<a href="glossary.html#extractorfield">extractor fields</a>.</p>
<p><a name="method_rvbd_shark_Shark_get_extractor_fields" href="#method_rvbd_shark_Shark_get_extractor_fields" class="linkable"><strong>get_extractor_fields</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return a list of all <a href="glossary.html#extractor">extractor fields</a> available on this shark</p>
</div>

<p><a name="method_rvbd_shark_Shark_find_extractor_field_by_name" href="#method_rvbd_shark_Shark_find_extractor_field_by_name" class="linkable"><strong>find_extractor_field_by_name</strong>(<em>fname</em>)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return a specific <a href="glossary.html#extractor">extractor field</a> given its name</p>
</div>

<p><a name="method_rvbd_shark_Shark_search_extractor_fields" href="#method_rvbd_shark_Shark_search_extractor_fields" class="linkable"><strong>search_extractor_fields</strong>(<em>string</em>)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Search through the <a href="glossary.html#extractor">extractor fields</a> to find the ones that
match the given string in either the field name or the
description.</p>
</div>

<h2 class="linkable" id="sourceobjects"><a href="#sourceobjects">Packet source objects</a><span class="link-icon"></span></h2>
<p>The objects described in this section are used to access packet sources.
None of these objects are directly instantiated from external code,
they are returned by methods on <code>Shark</code> or other routines.
Any of the objects in this section may be used as the <code>src</code>
argument to <a href="#method_rvbd_shark_Shark_create_view"><code>Shark.create_view</code></a>.</p>
<h3 class="linkable" id="capturejobobjects"><a href="#capturejobobjects">Capture Job objects</a><span class="link-icon"></span></h3>
<p>Capture job objects are used to work with capture jobs.
These objects are not instantiated directly but are returned from
<a href="#method_rvbd_shark_Shark_get_capture_jobs"><code>Shark.get_capture_jobs</code></a>
and <a href="#method_rvbd_shark_Shark_get_capture_job_by_name"><code>Shark.get_capture_job_by_name</code></a>.</p>
<p>Capture job objects have the following properties:</p>
<p><a name="method_rvbd_shark__source4_Job4_name" href="#method_rvbd_shark__source4_Job4_name" class="linkable"><strong>name</strong><span class="link-icon"></span></a></p>
<div class="docstring">

<p>The <a href="glossary.html#capturejob">capture job</a> name</p>
</div>

<p><a name="method_rvbd_shark__source4_Job4_size_on_disk" href="#method_rvbd_shark__source4_Job4_size_on_disk" class="linkable"><strong>size_on_disk</strong><span class="link-icon"></span></a></p>
<div class="docstring">

<p>The <a href="glossary.html#capturejob">capture job</a> actual size, corresponding to the one shown by the
Shark UI shows.</p>
</div>

<p><a name="method_rvbd_shark__source4_Job4_size_limit" href="#method_rvbd_shark__source4_Job4_size_limit" class="linkable"><strong>size_limit</strong><span class="link-icon"></span></a></p>
<div class="docstring">

<p>The <a href="glossary.html#capturejob">capture job</a> maximum size, corresponding to the one shown by the
Shark UI shows.</p>
</div>

<p><a name="method_rvbd_shark__source4_Job4_packet_start_time" href="#method_rvbd_shark__source4_Job4_packet_start_time" class="linkable"><strong>packet_start_time</strong><span class="link-icon"></span></a></p>
<div class="docstring">

<p><em>(no docstring)</em></p>
</div>

<p><a name="method_rvbd_shark__source4_Job4_packet_end_time" href="#method_rvbd_shark__source4_Job4_packet_end_time" class="linkable"><strong>packet_end_time</strong><span class="link-icon"></span></a></p>
<div class="docstring">

<p><em>(no docstring)</em></p>
</div>

<p><a name="method_rvbd_shark__source4_Job4_interface" href="#method_rvbd_shark__source4_Job4_interface" class="linkable"><strong>interface</strong><span class="link-icon"></span></a></p>
<div class="docstring">

<p>an :py:class:<code>Interface</code> object, representing the interface used as a packet
source for this job.</p>
</div>

<p><a name="method_rvbd_shark__source4_Job4_handle" href="#method_rvbd_shark__source4_Job4_handle" class="linkable"><strong>handle</strong><span class="link-icon"></span></a></p>
<div class="docstring">

<p>The internal <a href="glossary.html#capturejob">capture job</a> handle. The handle is sometimes required
for advanced operations on the job.</p>
</div>

<hr />
<p>The following methods access information about a job:</p>
<p><a name="method_rvbd_shark__source4_Job4_get_status" href="#method_rvbd_shark__source4_Job4_get_status" class="linkable"><strong>get_status</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return status information about the <a href="glossary.html#capturejob">capture job</a>.</p>
</div>

<p><a name="method_rvbd_shark__source4_Job4_get_state" href="#method_rvbd_shark__source4_Job4_get_state" class="linkable"><strong>get_state</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return the state of the job (e.g. RUNNING, STOPPED)</p>
</div>

<p><a name="method_rvbd_shark__source4_Job4_get_stats" href="#method_rvbd_shark__source4_Job4_get_stats" class="linkable"><strong>get_stats</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return statistics about the <a href="glossary.html#capturejob">capture job</a>.</p>
</div>

<p><a name="method_rvbd_shark__source4_Job4_get_index_info" href="#method_rvbd_shark__source4_Job4_get_index_info" class="linkable"><strong>get_index_info</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return statistics about the <a href="glossary.html#capturejob">capture job</a> index.</p>
</div>

<hr />
<p>The following methods are useful for controlling a capture job:</p>
<p><a name="method_rvbd_shark__source4_Job4_start" href="#method_rvbd_shark__source4_Job4_start" class="linkable"><strong>start</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Start a job in the Shark appliance</p>
</div>

<p><a name="method_rvbd_shark__source4_Job4_stop" href="#method_rvbd_shark__source4_Job4_stop" class="linkable"><strong>stop</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Stop a job in the Shark appliance</p>
</div>

<p><a name="method_rvbd_shark__source4_Job4_clear" href="#method_rvbd_shark__source4_Job4_clear" class="linkable"><strong>clear</strong>(<em>restart</em>=False)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Clear data in the Shark appliance</p>
</div>

<hr />
<p>The following methods can be used to create and delete jobs,
though <code>create()</code> does the same thing as <code>Shark.create_clip()</code>.</p>
<p><a name="method_rvbd_shark__source4_Job4_create" href="#method_rvbd_shark__source4_Job4_create" class="linkable"><strong>create</strong>(<em>shark</em>, <em>interface</em>, <em>name</em>, <em>packet_retention_size_limit</em>, <em>packet_retention_packet_limit</em>=None, <em>packet_retention_time_limit</em>=None, <em>bpf_filter</em>=None, <em>snap_length</em>=65525, <em>indexing_size_limit</em>=None, <em>indexing_synced</em>=False, <em>indexing_time_limit</em>=None, <em>start_immediately</em>=False, <em>requested_start_time</em>=None, <em>requested_stop_time</em>=None, <em>stop_rule_size_limit</em>=None, <em>stop_rule_packet_limit</em>=None, <em>stop_rule_time_limit</em>=None)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Create a new <a href="glossary.html#capturejob">capture job</a></p>
</div>

<p><a name="method_rvbd_shark__source4_Job4_delete" href="#method_rvbd_shark__source4_Job4_delete" class="linkable"><strong>delete</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Delete job from the Shark appliance</p>
</div>

<hr />
<p>Finally, these methods are useful for creating trace clips and
for downloading raw packets from a capture job.</p>
<p><a name="method_rvbd_shark__source4_Job4_add_clip" href="#method_rvbd_shark__source4_Job4_add_clip" class="linkable"><strong>add_clip</strong>(<em>filters</em>, <em>description</em>, <em>locked</em>=True)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Create a new <a href="glossary.html#traceclip">trace clip</a> under this job.</p>
<p><code>filters</code> limit which packets from the clip should go into
this clip.  Since all packets in the new clip will be kept on
disk if the clip is locked, this field typically includes
time filters to limit the clip to a fixed time interval.</p>
<p><code>description</code> is a name for the clip, it is shown next to the
clip in the Pilot user interface.</p>
<p>If <code>locked</code> is True, packets in the new clip will not be deleted
from disk as long as the clip exists.  Note that locking packets
in <a href="glossary.html#traceclip">trace clips</a> necessarily reduces the amount of disk capacity
for existing <a href="glossary.html#capturejob">capture jobs</a>.</p>
<p>Returns a <a href="glossary.html#traceclip">trace clip</a> object representing the new clip.</p>
</div>

<p><a name="method_rvbd_shark__source4_Job4_download" href="#method_rvbd_shark__source4_Job4_download" class="linkable"><strong>download</strong>(<em>path</em>=None)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Download the Job packets to a path.
If path is None packets will be exported to a temporary file.
A file object that contains the packets is returned.</p>
</div>

<h3 class="linkable" id="traceclips"><a href="#traceclips">Trace Clip objects</a><span class="link-icon"></span></h3>
<p>Trace clip objects are used to work with trace clips.
These objects are not instantiated directly but are returned from
methods such as <a href="#method_rvbd_shark__source4_Shark_get_clips"><code>Shark.get_clips</code></a>.</p>
<p>These methods provide a way to obtain clip objects, though it
is usually easier to use methods like <code>Shark.get_clips</code>.</p>
<p><a name="method_rvbd_shark__source4_Clip4_get" href="#method_rvbd_shark__source4_Clip4_get" class="linkable"><strong>get</strong>(<em>shark</em>, <em>id</em>, <em>name</em>=None)<span class="link-icon"></span></a></p>
<div class="docstring">

<p><em>(no docstring)</em></p>
</div>

<p><a name="method_rvbd_shark__source4_Clip4_get_all" href="#method_rvbd_shark__source4_Clip4_get_all" class="linkable"><strong>get_all</strong>(<em>shark</em>)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Get the complete list of trace files on given a Shark.</p>
<p><code>shark</code> is an <code>rvbd.shark.shark.Shark</code> object</p>
<p>Returns a list of <code>TraceFile</code> objects</p>
</div>

<p>Trace clip objects have the following properties:</p>
<!-- document properties -->

<p><a name="method_rvbd_shark__source4_Clip4_description" href="#method_rvbd_shark__source4_Clip4_description" class="linkable"><strong>description</strong><span class="link-icon"></span></a></p>
<div class="docstring">

<p>Returns the description of the clip</p>
</div>

<p><a name="method_rvbd_shark__source4_Clip4_size" href="#method_rvbd_shark__source4_Clip4_size" class="linkable"><strong>size</strong><span class="link-icon"></span></a></p>
<div class="docstring">

<p>Returns the size of the clip</p>
</div>

<p><a name="method_rvbd_shark__source4_Clip4_add" href="#method_rvbd_shark__source4_Clip4_add" class="linkable"><strong>add</strong>(<em>shark</em>, <em>job</em>, <em>filters</em>, <em>description</em>, <em>locked</em>=True)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Create a new clip given a Shark connection and a job handle.</p>
<p><code>shark</code> is a Shark object</p>
<p><code>description</code> will be associated with the new clip.
(The description is shown near the clip in grey in Pilot)</p>
<p><code>job</code> is the <a href="glossary.html#capturejob">capture job</a> to use</p>
<p><code>filters</code> is the list of filters to associate to the clip.
In order for the clip to be valid, there must be at list one
time filter in this list</p>
<p>Returns a <a href="glossary.html#traceclip">trace clip</a> object for the new clip.</p>
</div>

<p><a name="method_rvbd_shark__source4_Clip4_delete" href="#method_rvbd_shark__source4_Clip4_delete" class="linkable"><strong>delete</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Erase the clip from shark</p>
</div>

<p><a name="method_rvbd_shark__source4_Clip4_download" href="#method_rvbd_shark__source4_Clip4_download" class="linkable"><strong>download</strong>(<em>path</em>=None)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Download the Clip packets to a file.
If path is None packets will be exported to a temporary file.
A file object that contains the packets is returned.</p>
</div>

<h2 class="linkable" id="extractorobjects"><a href="#extractorobjects">Extractor Field objects</a><span class="link-icon"></span></h2>
<p>Extractor Field objects represent individual extractor fields.
These objects are returned by <code>Shark.get_extractor_fields</code>,
<code>Shark.find_extractor_field_by_name</code>, and <code>Shark.search_extractor_fields</code>.</p>
<!--
replace ticks above with method references when ridl issues
worked out
[`Shark.get_extractor_fields`](#method_rvbd_shark__source4_Shark_get_extractor_fields),
[`Shark.find_extractor_field_by_name`](#method_rvbd_shark__source4_Shark_find_extractor_field_by_name), and
[`Shark.search_extractor_fields`](#method_rvbd_shark__source4_Shark_search_extractor_fields).
-->

<p>Each extractor field is a python
<a href="http://docs.python.org/library/collections.html#collections.namedtuple"><code>namedtuple</code></a>
with the following fields:</p>
<ul>
<li><code>name</code>: the name of the field, e.g., <code>ip.source_ip</code></li>
<li><code>desc</code>: a brief description of the field</li>
<li><code>type</code>: a string describing the type of the field
     (e.g., integer, string ip address, etc.)</li>
</ul>
<h2 class="linkable" id="viewobjects"><a href="#viewobjects">View objects</a><span class="link-icon"></span></h2>
<p>View objects are returned from <code>Shark.create_view</code>.</p>
<!-- [`Shark.create_view`](#method_rvbd_shark__source4_Shark_create_view) -->

<p>A View object encapsulates everything needed to read data from
an existing view on a Shark.
Every view has one or more associated <em>outputs</em>.
For example, the standard "Bandwidth over time" view has separate
outputs for "bits over time", "bytes over time", and "packets over time".
In flyscript, a View object contains an associated Output object for
each output.  To read data from a view, you must first locate the
appropriate Output object, then use the method
!methodref Output.get_data .</p>
<p>View objects have the following methods:</p>
<p><a name="method_rvbd_shark__view4_View4_is_ready" href="#method_rvbd_shark__view4_View4_is_ready" class="linkable"><strong>is_ready</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Returns a boolean indicating whether data can be
retrieved from this <a href="glossary.html#view">view</a> or not.  If this function returns
False, the <a href="glossary.html#view">view</a> data is still being computed, its progress
can be followed with the method get_progress().</p>
</div>

<p><a name="method_rvbd_shark__view4_View4_get_progress" href="#method_rvbd_shark__view4_View4_get_progress" class="linkable"><strong>get_progress</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>For <a href="glossary.html#view">views</a> applied to non-live sources (i.e., to <a href="glossary.html#traceclip">trace clips</a>
or trace files), returns an integer between 0 and 100 indicating
the percentage of the <a href="glossary.html#packetsource">packet source</a> that has been processed.
Output data is not available on the <a href="glossary.html#view">view</a> until this value reaches
100%</p>
</div>

<p><a name="method_rvbd_shark__view4_View4_get_timeinfo" href="#method_rvbd_shark__view4_View4_get_timeinfo" class="linkable"><strong>get_timeinfo</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return a dictionary object with details about the time
range covered by this <a href="glossary.html#view">view</a>.  The returned object has the
following entries:</p>
<ul>
<li><code>start</code>: the time of the first packet for which data is available</li>
<li><code>end</code>: the end time of the last sample</li>
<li><code>delta</code>: the sampling time of each sample</li>
</ul>
<p>This function adds a delta to the end time of the <a href="glossary.html#view">view</a> provided by shark
If you need the timeinfo provided by shark as it is use _get_timeinfo</p>
</div>

<p><a name="method_rvbd_shark__view4_View4_close" href="#method_rvbd_shark__view4_View4_close" class="linkable"><strong>close</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Close this <a href="glossary.html#view">view</a> on the server (which permanently deletes
the <a href="glossary.html#view">view</a> plus any associated configuration and output data).</p>
</div>

<p><a name="method_rvbd_shark__view4_View4_get_legend" href="#method_rvbd_shark__view4_View4_get_legend" class="linkable"><strong>get_legend</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Returns the legend from the output in this <a href="glossary.html#view">view</a>.
Shorthand for <code>all_outputs()[0].get_legend()</code>.</p>
<p>Raises a LookupError if the <a href="glossary.html#view">view</a> has more than one output.</p>
</div>

<p><a name="method_rvbd_shark__view4_View4_get_data" href="#method_rvbd_shark__view4_View4_get_data" class="linkable"><strong>get_data</strong>(<em>args, </em>*kwargs)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Returns the data from the output in this <a href="glossary.html#view">view</a>.
Shorthand for <code>all_outputs()[0].get_data()</code>.</p>
<p>Raises a LookupError if the <a href="glossary.html#view">view</a> has more than one output.</p>
<p>For a full description of the function arguments, refer to the
method Output.get_data().</p>
</div>

<p><a name="method_rvbd_shark__view4_View4_get_iterdata" href="#method_rvbd_shark__view4_View4_get_iterdata" class="linkable"><strong>get_iterdata</strong>(<em>args, </em>*kwargs)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Returns an iterator for the data from the output
in this <a href="glossary.html#view">view</a>.  Shorthand for <code>all_outputs()[0].get_iterdata()</code>.</p>
<p>Raises a LookupError if the <a href="glossary.html#view">view</a> has more than one output.</p>
<p>For a full description of the function arguments, refer to the
method Output.get_iterdata()</p>
</div>

<p><a name="method_rvbd_shark__view4_View4_all_outputs" href="#method_rvbd_shark__view4_View4_all_outputs" class="linkable"><strong>all_outputs</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return a list of Output objects, one for each output
in this <a href="glossary.html#view">view</a></p>
</div>

<p><a name="method_rvbd_shark__view4_View4_get_output" href="#method_rvbd_shark__view4_View4_get_output" class="linkable"><strong>get_output</strong>(<em>id</em>)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return the Output object corresponding to
the output <code>id</code>.</p>
</div>

<h3 class="linkable" id="outputobjects"><a href="#outputobjects">Output objects</a><span class="link-icon"></span></h3>
<p><a name="method_rvbd_shark__view4_Output4_get_legend" href="#method_rvbd_shark__view4_Output4_get_legend" class="linkable"><strong>get_legend</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return the legend for this output.  The legend consists of
an ordered list of entries, one for each column of data in this
output.  Each entry is a dictionary object with the following
entries:</p>
<ul>
<li><code>name</code>: A short name for the field</li>
<li><code>description</code>: A slightly longer, more descriptive name for the field</li>
<li><code>field</code>: the name of the <a href="glossary.html#extractor">extractor field</a> that produces this column</li>
<li><code>calculation</code>: how data from multiple packets in a sample
  is aggregated (e.g., "SUM", "AVG", etc.)</li>
</ul>
<p>The following parameters are intended for internal shark use:</p>
<ul>
<li><code>type</code></li>
<li><code>id</code></li>
<li><code>base</code></li>
<li><code>dimension</code></li>
</ul>
</div>

<p><a name="method_rvbd_shark__view4_Output4_get_data" href="#method_rvbd_shark__view4_Output4_get_data" class="linkable"><strong>get_data</strong>(<em>start</em>=None, <em>end</em>=None, <em>delta</em>=None, <em>aggregated</em>=False, <em>sortby</em>=None, <em>sorttype</em>="descending", <em>fromentry</em>=0, <em>toentry</em>=0)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Get the data for this <a href="glossary.html#view">view</a>. This function downloads the whole
dataset before returning it, so it's useful when random access to the
<a href="glossary.html#view">view</a> data is necessary.</p>
<p>The arguments have the same meanings as corresponding arguments
to get_iterdata(), see its documentation for a full explanation
of all arguments and their meanings.</p>
</div>

<p><a name="method_rvbd_shark__view4_Output4_get_iterdata" href="#method_rvbd_shark__view4_Output4_get_iterdata" class="linkable"><strong>get_iterdata</strong>(<em>start</em>=None, <em>end</em>=None, <em>delta</em>=None, <em>aggregated</em>=False, <em>sortby</em>=None, <em>sorttype</em>="descending", <em>fromentry</em>=0, <em>toentry</em>=0)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Returns an iterator to the output data. This function is ideal for
sequential parsing of the <a href="glossary.html#view">view</a> data, because it downloads the
dataset incrementally as it is accessed.</p>
<p><code>start</code> and <code>end</code> are <code>datetime.datetime</code> objects representing
the earliest and latest packets that should be considered.
If <code>start</code> and <code>end</code> are unspecified, the start/end of the
underlying <a href="glossary.html#packetsource">packet source</a> are used.</p>
<p><code>delta</code> is a <code>datetime.timedelta</code> object that can be used to
override the default data aggregation interval.  If this
parameter is unspecified, the underlying <a href="glossary.html#view">view</a> sample interval
(which defaults to 1 second) is used.  If this parameter is
specified, it must be an even multiple of the underlying
<a href="glossary.html#view">view</a> sample interval.</p>
<p>If <code>aggregated</code> is True, the parameter <code>delta</code> is automatically
computed to be the full extent of this request (i.e., the difference
between the effective start and end times).  This is useful if
you do not care about timeseries data (e.g., if the data from
this <a href="glossary.html#view">view</a> is to be plotted in a single chart that has no
time component).</p>
<p>The <code>sortby</code> parameter is one of the fields of the output (x1, x2 ...)</p>
<p>The <code>sorttype</code> can be:
<em> <code>ascending</code>: the output is sorted from smallest to largest
</em> <code>descending</code>: the output is sorted largest to smallest</p>
<p>The <code>fromentry</code> parameter represent the first sorted item we want
to appear in the output.  0 means from the first one.</p>
<p>The <code>toentry</code> parameter represent the last sorted item we want to
appear in the output.  0 means all of them.</p>
</div>

<h1 id="rvbdsharkviewutils">rvbd.shark.viewutils</h1>
<p>This is a set of utility functions for working with <a href="glossary.html#view">views</a>.</p>
<h2 id="utilities-for-writing-view-data">Utilities for writing view data</h2>
<p><a name="function_rvbd_shark_viewutils_print_data" href="#function_rvbd_shark_viewutils_print_data" class="linkable"><strong>print_data</strong>(<em>legend</em>, <em>stream</em>, <em>timeformat</em>="%Y/%m/%d&nbsp;%H:%M:%S.%f", <em>include_sample_times</em>=True, <em>widths</em>=None, <em>limit</em>=None, <em>line_prefix</em>="")<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Print the data of a given <a href="glossary.html#view">view</a> output to stdout.</p>
<p><code>widths</code> is an optional list of integers, specifying how
many characters wide each column should be.  If it is not
specified, reasonable defaults are chosen.</p>
<p>If <code>limit</code> is specified, only the first <code>limit</code> rows are printed.</p>
<p><code>line_prefix</code> is a string that is printed at the start of every line.</p>
</div>

<p><a name="function_rvbd_shark_viewutils_write_csv" href="#function_rvbd_shark_viewutils_write_csv" class="linkable"><strong>write_csv</strong>(<em>filename</em>, <em>legend</em>, <em>stream</em>, <em>include_column_names</em>=True, <em>include_sample_times</em>=True)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Saves the data of a <a href="glossary.html#view">view</a> output to a comma separated values (csv) file.</p>
<p><code>legend</code> is an output legend, typically just the result
of <code>output.get_legend()</code></p>
<p><code>stream</code> is a series of data samples, typically the result
of <code>output.get_data()</code> or <code>output.get_iterdata()</code></p>
<p>If <code>include_column_names</code> is True, the first line in the file
will be a summary row indicating the fileds that the file contains.</p>
<p>If <code>include_sample_times</code> is True, the first column will be a
timestamp.</p>
</div>

<h2 id="mixing-multiple-view-outputs">Mixing multiple view outputs</h2>
<p><a name="class_rvbd_shark_viewutils_OutputMixer" href="#class_rvbd_shark_viewutils_OutputMixer" class="linkable">class <code>rvbd.shark.viewutils.OutputMixer</code><span class="link-icon"></span></a></p>
<p>Helper class that blends multiple data streams (ie from View.get_data)
into a single combined stream.
For example, given a "Bandwidth Over Time" <a href="glossary.html#view">view</a> with separate
outputs for bytes and packets, this class can be used to create
a single output stream with bytes and packets columns.</p>
<p>Mixing is only supported on simple time-based <a href="glossary.html#view">views</a> that do
not include any keys (e.g., bandwidth over time, etc.)</p>
<p>See examples/shark/readview.py for typical usage.</p>
<p><strong>OutputMixer</strong>()</p>
<div class="docstring">

</div>

<p><a name="method_rvbd_shark_viewutils_OutputMixer_add_source" href="#method_rvbd_shark_viewutils_OutputMixer_add_source" class="linkable"><strong>add_source</strong>(<em>src</em>, <em>prefix</em>=None)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Add new source to mixer</p>
<p><code>src</code> is time-based <a href="glossary.html#view">view</a> object</p>
</div>

<p><a name="method_rvbd_shark_viewutils_OutputMixer_get_legend" href="#method_rvbd_shark_viewutils_OutputMixer_get_legend" class="linkable"><strong>get_legend</strong>()<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return the legend for each of the source objects</p>
</div>

<p><a name="method_rvbd_shark_viewutils_OutputMixer_get_iterdata" href="#method_rvbd_shark_viewutils_OutputMixer_get_iterdata" class="linkable"><strong>get_iterdata</strong>(<em>args, </em>*kwargs)<span class="link-icon"></span></a></p>
<div class="docstring">

<p>Return a generator for the combined stream of outputs from each source object</p>
</div>

</div>

<div class="footer">
Copyright &copy; 2013 Riverbed Technology
</div></body>
</html>
