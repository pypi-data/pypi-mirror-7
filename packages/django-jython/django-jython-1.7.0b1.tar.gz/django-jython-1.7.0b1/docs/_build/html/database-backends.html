

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Database backends &mdash; django-jython 1.7.0b1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.7.0b1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="django-jython 1.7.0b1 documentation" href="index.html" />
    <link rel="next" title="Creating a .war archive for deployment" href="war-deployment.html" />
    <link rel="prev" title="QuickStart" href="quickstart.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="war-deployment.html" title="Creating a .war archive for deployment"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="quickstart.html" title="QuickStart"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">django-jython 1.7.0b1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="database-backends">
<span id="id1"></span><h1>Database backends<a class="headerlink" href="#database-backends" title="Permalink to this headline">¶</a></h1>
<p>Backends are implemented using the great Jython&#8217;s zxJDBC package, which makes
any database with a working JDBC driver accessible through the DB-API 2.0
specification. Thus, to use any backend from this project, you will also need
the corresponding JDBC driver somewhere in your <tt class="docutils literal"><span class="pre">CLASSPATH</span></tt>. On Unix-based
environments this can be done on the console by running:</p>
<div class="highlight-python"><pre>$ export CLASSPATH="$CLASSPATH:/path/to/driver.jar"</pre>
</div>
<p>Note that this is a ephemeral setting that will only have effect on the current
shell session.</p>
<div class="section" id="postgresql">
<h2>PostgreSQL<a class="headerlink" href="#postgresql" title="Permalink to this headline">¶</a></h2>
<p>Developed and tested against PostgreSQL v9.3 with the JDBC driver
9.1-902.jdbc4. To use it set the following in your Django project settings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="c"># ...</span>
    <span class="s">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s">&#39;doj.db.backends.postgresql&#39;</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Download the JDBC Driver from <a class="reference external" href="http://jdbc.postgresql.org/download.html">http://jdbc.postgresql.org/download.html</a> and
remember to put the JAR file on the <tt class="docutils literal"><span class="pre">CLASSPATH</span></tt>.</p>
</div>
<div class="section" id="sqlite3">
<h2>SQLite3<a class="headerlink" href="#sqlite3" title="Permalink to this headline">¶</a></h2>
<p>Developed and tested against SQLite3 v3.7.6 with the JDBC driver
3.7.2. To use it set the following in your Django project settings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="c"># ...</span>
    <span class="s">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s">&#39;doj.db.backends.sqlite&#39;</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Download the JDBC Driver from <a class="reference external" href="https://bitbucket.org/xerial/sqlite-jdbc/downloads">https://bitbucket.org/xerial/sqlite-jdbc/downloads</a> and
remember to put the JAR file on the <tt class="docutils literal"><span class="pre">CLASSPATH</span></tt>.</p>
</div>
<div class="section" id="mysql">
<h2>MySQL<a class="headerlink" href="#mysql" title="Permalink to this headline">¶</a></h2>
<p>Developed and tested against SQLite3 v3.7.6 with the JDBC driver
3.7.2. To use it set the following in your Django project settings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="c"># ...</span>
    <span class="s">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s">&#39;doj.db.backends.mysql&#39;</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Download the JDBC Driver from <a class="reference external" href="https://bitbucket.org/xerial/sqlite-jdbc/downloads">https://bitbucket.org/xerial/sqlite-jdbc/downloads</a> and
remember to put the JAR file on the <tt class="docutils literal"><span class="pre">CLASSPATH</span></tt>.</p>
</div>
<div class="section" id="mssql">
<h2>MSSQL<a class="headerlink" href="#mssql" title="Permalink to this headline">¶</a></h2>
<p>Developed and tested against MSSQL 2008 with the JDBC driver
1.3.0. To use it set the following in your Django project settings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="c"># ...</span>
    <span class="s">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s">&#39;doj.db.backends.mssql&#39;</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Download the JDBC Driver from <a class="reference external" href="http://jtds.sourceforge.net/">http://jtds.sourceforge.net/</a> and
remember to put the JAR file on the <tt class="docutils literal"><span class="pre">CLASSPATH</span></tt>.</p>
</div>
<div class="section" id="jndi-support">
<h2>JNDI support<a class="headerlink" href="#jndi-support" title="Permalink to this headline">¶</a></h2>
<p>All the backends documented on the previous sections support JNDI lookups to
leverage connection pools provided by Java application servers. To use JNDI,
simply add the following line to the project&#8217;s <tt class="docutils literal"><span class="pre">settings.py</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="c"># ...</span>
    <span class="s">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">&#39;JNDI_NAME&#39;</span><span class="p">:</span> <span class="s">&#39;java:comp/env/jdbc/myDataSource&#39;</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And make sure that the datasource specified as the <tt class="docutils literal"><span class="pre">JNDI_NAME</span></tt> is defined on
the application server in which you will deploy your application.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using JNDI and with the exception of <tt class="docutils literal"><span class="pre">ENGINE</span></tt>, all the other
options will be ignored by django-jython. For ease of
development you may want to add the <tt class="docutils literal"><span class="pre">JNDI_NAME</span></tt> option <strong>only</strong> to the staging
and production servers. After all, on most cases you won&#8217;t really need
database connection pooling when testing on your development machine.</p>
</div>
<div class="section" id="specifying-additional-jndi-options">
<h3>Specifying additional JNDI options<a class="headerlink" href="#specifying-additional-jndi-options" title="Permalink to this headline">¶</a></h3>
<p>Additionally, you can use the <tt class="docutils literal"><span class="pre">'JNDI_CONTEXT_OPTIONS'</span></tt> entry of the
<tt class="docutils literal"><span class="pre">OPTIONS</span></tt> dictionary to pass <a class="reference external" href="http://java.sun.com/j2se/1.5.0/docs/api/javax/naming/Context.html#INITIAL_CONTEXT_FACTORY">additional options</a>
to set up the underlying JNDI <tt class="docutils literal"><span class="pre">InitialContext</span></tt>. The options are themselves
specified as another dictionary. For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="c"># ...</span>
    <span class="s">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">&#39;JNDI_NAME&#39;</span><span class="p">:</span> <span class="s">&#39;java:comp/env/jdbc/myDataSource&#39;</span><span class="p">,</span>
      <span class="s">&#39;JNDI_CONTEXT_OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&#39;java.naming.factory.initial&#39;</span><span class="p">:</span> <span class="s">&#39;com.sun.appserv.naming.S1ASCtxFactory&#39;</span><span class="p">,</span>
        <span class="s">&#39;com.sun.appserv.iiop.endpoints&#39;</span><span class="p">:</span> <span class="s">&#39;localhost:3700&#39;</span><span class="p">,</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that usually you don&#8217;t need to pass additional options for JNDI to work if
the application has been deployed on a JavaEE container (such as Tomcat,
Glassfish, JBoss, Websphere, Weblogic, etc). We provide this setting for
flexibility and completeness. But on most cases the configuration will look like
the one-liner shown on the first JNDI settings example.</p>
</div>
<div class="section" id="jndi-and-tomcat">
<h3>JNDI and Tomcat<a class="headerlink" href="#jndi-and-tomcat" title="Permalink to this headline">¶</a></h3>
<p>To use django-jython JNDI support on top of Apache Tomcat, add the JNDI
configuration line to your settings.py:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="c"># ...</span>
    <span class="s">&#39;OPTIONS&#39;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s">&#39;JNDI_NAME&#39;</span><span class="p">:</span> <span class="s">&#39;java:comp/env/jdbc/myDataSource&#39;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Do <strong>not</strong> remove the other database settings, as they will be used by
django-jython to help you create your JNDI configuration.</p>
<p>Deploy your application as normal. It won&#8217;t work (raising a JNDI exception
telling you that <em>the jdbc name is not bound in this Context</em>), but we will fix
that now. Use the <tt class="docutils literal"><span class="pre">jndiconfig</span></tt> management command to get a sample context XML
file to set up your data source:</p>
<div class="highlight-python"><pre>$ jython manage.py jndiconfig</pre>
</div>
<p>You will see an output similar to this:</p>
<div class="highlight-python"><pre>&lt;!-- This is the JNDI datasource configuration for mysite --&gt;
&lt;Context&gt;
  &lt;!-- Some documentation... --&gt;
  &lt;Resource name="jdbc/myDataSource"
            auth="Container"
            type="javax.sql.DataSource"
            username="root"
            password="root"
            driverClassName="com.mysql.jdbc.Driver"
            url="jdbc:mysql://localhost:3306/mydatabase?zeroDateTimeBehavior=convertToNull"
            maxActive="8"
            maxIdle="4"
            maxWait="10000"/&gt;
&lt;/Context&gt;

Usage hint:
  For a basic configuration of JNDI on your Tomcat server, create a file named mysite.xml on
  '/path/to/apache-tomcat-6.x.x/conf/Catalina/localhost/' with the content printed above.</pre>
</div>
<p>Follow the instructions, restart Tomcat and it will be working as expected.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Database backends</a><ul>
<li><a class="reference internal" href="#postgresql">PostgreSQL</a></li>
<li><a class="reference internal" href="#sqlite3">SQLite3</a></li>
<li><a class="reference internal" href="#mysql">MySQL</a></li>
<li><a class="reference internal" href="#mssql">MSSQL</a></li>
<li><a class="reference internal" href="#jndi-support">JNDI support</a><ul>
<li><a class="reference internal" href="#specifying-additional-jndi-options">Specifying additional JNDI options</a></li>
<li><a class="reference internal" href="#jndi-and-tomcat">JNDI and Tomcat</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="quickstart.html"
                        title="previous chapter">QuickStart</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="war-deployment.html"
                        title="next chapter">Creating a .war archive for deployment</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/database-backends.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="war-deployment.html" title="Creating a .war archive for deployment"
             >next</a> |</li>
        <li class="right" >
          <a href="quickstart.html" title="QuickStart"
             >previous</a> |</li>
        <li><a href="index.html">django-jython 1.7.0b1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Josh Juneau and Andreas Stocker.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>