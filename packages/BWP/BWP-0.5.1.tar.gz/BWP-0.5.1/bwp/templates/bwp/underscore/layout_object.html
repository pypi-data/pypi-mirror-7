{# Шаблон Underscore #}{% load bwp_verbatim %}{% verbatim %}
<div class="row-fluid">
{% if (data.composes.length >0) { %}
    <div class="btn-group subtabs" data-toggle="buttons-radio" data-id="{{ data.id }}">
        <button class="btn btn-mini btn-primary active"
            data-toggle="tab"
            data-target="#objectpane_{{ data.id }}">
            Объект
        </button>
    {% _.each(data.composes, function(compose) { %}
        {%/* Если объект не сохранён в DB, то запрещаем операции с вложениями */%}
        {% var _compose_btn_class = ''; if (compose.is_m2m) { _compose_btn_class = 'btn-info'} %}
        <button class="btn btn-mini {{ _compose_btn_class }}"
        {% if (!data.pk) { %}
            disabled="disabled"
        {% } else { %}
            data-toggle="tab"
            data-loading="true"
        {% } %}
            data-target="#layout_{{ compose.id }}"
            data-id="{{ compose.id }}">
            {{ compose.label }}
        </button>
    {% }); %}
    </div>
    <div class="btn-group subtabs">
    {% if ((data.model.object_reports) && (data.pk)) { %}
        <button class="btn btn-mini dropdown-toggle"
            data-toggle="dropdown">            
            <i class="icon-print"></i> Отчёты
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu">
            {% _.each(data.model.object_reports, function(report) { %}
                <li><a href="#" data-action="object_print"
                    data-id={{ data.id }}
                    data-model={{ data.model.name }}
                    data-pk={{ data.pk }}
                    data-report={{ report.pk }}>
                        {{ report.title }}
                    </a>
                </li>
            {% }); %}
        </ul>
    {% }; %}
    </div>
{% } %}
    <div class="tab-content">
    {% _.each(data.composes, function(compose) { %}
        <div class="tab-pane" id="layout_{{ compose.id }}">
            {% endverbatim %}
            <div align="center"><img src="{{ STATIC_URL }}img/bwp/ajax-loader.gif" /> загрузка данных...</div>
            {% verbatim %}
        </div>
    {% }); %}
        <div class="tab-pane active" id="objectpane_{{ data.id }}">
            <h3>{{ data.label }} <span class="pull-right">{{ data.pk }}</span></h3>
            <table class="table table-condensed" data-id="{{ data.id }}">
                <tbody>
        {% endverbatim %}
                {% include "bwp/underscore/_object_fields.html" %}
                </tbody>
                <tfoot>
                    <tr>
                        <th colspan="2" class="align-center">
                            <div class="control-group">
                                <div class="controls">
                                    <div class="btn-group">
                                        {% include "bwp/underscore/_button_delete.html" %}
                                        {% include "bwp/underscore/_button_reset.html" %}
                                        {% include "bwp/underscore/_button_copy.html" %}
                                        {% include "bwp/underscore/_button_apply.html" %}
                                        {% include "bwp/underscore/_button_save.html" %}
                                    </div>
                                </div>
                            </div>
                        </th>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>
</div>
