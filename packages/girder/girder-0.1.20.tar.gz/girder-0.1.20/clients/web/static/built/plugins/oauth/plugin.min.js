this.jade=this.jade||{},this.jade.templates=this.jade.templates||{},this.jade.templates.oauth_config=function(a){var b,c=[],d=a||{},e=d.google;return c.push('<div class="g-config-breadcrumb-container"></div><div class="g-oauth-provider-list-title">Configure supported providers below</div><div id="g-oauth-provider-accordion" class="panel-group"><div class="panel panel-default"><div class="panel-heading"><div class="panel-title"><a data-toggle="collapse" data-parent="#g-oauth-provider-accordion" href="#g-oauth-provider-google"><i class="icon-gplus"></i> Google</a></div></div><div id="g-oauth-provider-google" class="panel-collapse collapse in"><div class="panel-body"><p>Client IDs and secret keys are managed in the Google Developer Console. When\ncreating your client ID there, use the following values:</p><div class="g-oauth-value-container"><b>Authorized javascript origins:</b><span class="g-oauth-value">'+jade.escape(null==(b=e.jsOrigin)?"":b)+'</span></div><div class="g-oauth-value-container"><b>Authorized redirect URI:</b><span class="g-oauth-value">'+jade.escape(null==(b=e.redirectUri)?"":b)+'</span></div><form id="g-oauth-provider-google-form" role="form"><div class="form-group"><label for="g-oauth-provider-google-client-id" class="control-label">Google client ID</label><input id="g-oauth-provider-google-client-id" type="text" placeholder="Client ID" class="input-sm form-control"/></div><div class="form-group"><label for="g-oauth-provider-google-client-secret" class="control-label">Google client secret</label><input id="g-oauth-provider-google-client-secret" type="text" placeholder="Client secret" class="input-sm form-control"/></div><p id="g-oauth-provider-google-error-message" class="g-validation-failed-message"></p><input type="submit" value="Save" class="btn btn-sm btn-primary"/></form></div></div></div></div>'),c.join("")},this.jade.templates.oauth_login=function(a){var b,c=[],d=a||{},e=d.buttons;return c.push('<div class="g-oauth-container"><div class="g-oauth-section-header"><div class="g-oauth-section-header-text">Or log in with</div></div>'),function(){var a=e;if("number"==typeof a.length)for(var d=0,f=a.length;f>d;d++){var g=a[d];c.push("<div"+jade.attr("g-provider",""+g.provider,!0,!1)+jade.cls(["g-oauth-button",""+g.class],[null,!0])+'><div class="g-oauth-button-icon"><i'+jade.cls(["icon-"+g.icon],[!0])+'></i></div><div class="g-oauth-button-text">'+jade.escape(null==(b=g.text||g.provider)?"":b)+"</div></div>")}else{var f=0;for(var d in a){f++;var g=a[d];c.push("<div"+jade.attr("g-provider",""+g.provider,!0,!1)+jade.cls(["g-oauth-button",""+g.class],[null,!0])+'><div class="g-oauth-button-icon"><i'+jade.cls(["icon-"+g.icon],[!0])+'></i></div><div class="g-oauth-button-text">'+jade.escape(null==(b=g.text||g.provider)?"":b)+"</div></div>")}}}.call(this),c.push("</div>"),c.join("")},girder.views.oauth_ConfigView=girder.View.extend({events:{"submit #g-oauth-provider-google-form":function(a){a.preventDefault(),this.$("#g-oauth-provider-google-error-message").empty(),this._saveSettings([{key:"oauth.google_client_id",value:this.$("#g-oauth-provider-google-client-id").val().trim()},{key:"oauth.google_client_secret",value:this.$("#g-oauth-provider-google-client-secret").val().trim()}])}},initialize:function(){girder.restRequest({type:"GET",path:"system/setting",data:{list:JSON.stringify(["oauth.google_client_id","oauth.google_client_secret"])}}).done(_.bind(function(a){this.render(),this.$("#g-oauth-provider-google-client-id").val(a["oauth.google_client_id"]),this.$("#g-oauth-provider-google-client-secret").val(a["oauth.google_client_secret"])},this))},render:function(){var a=window.location.protocol+"//"+window.location.host;return this.$el.html(jade.templates.oauth_config({google:{jsOrigin:a,redirectUri:a+girder.apiRoot+"/oauth/google/callback"}})),this.breadcrumb||(this.breadcrumb=new girder.views.PluginConfigBreadcrumbWidget({pluginName:"OAuth login",el:this.$(".g-config-breadcrumb-container")}).render()),this},_saveSettings:function(a){girder.restRequest({type:"PUT",path:"system/setting",data:{list:JSON.stringify(a)},error:null}).done(_.bind(function(){girder.events.trigger("g:alert",{icon:"ok",text:"Settings saved.",type:"success",timeout:4e3})},this)).error(_.bind(function(a){this.$("#g-oauth-provider-google-error-message").text(a.responseJSON.message)},this))}}),girder.router.route("plugins/oauth/config","oauthConfig",function(){girder.events.trigger("g:navigateTo",girder.views.oauth_ConfigView)}),girder.views.oauth_LoginView=girder.View.extend({events:{"click .g-oauth-button":function(a){var b=$(a.currentTarget).attr("g-provider");window.location=this.providers[b]}},initialize:function(){var a=girder.dialogs.splitRoute(window.location.href).base;girder.restRequest({path:"oauth/provider",data:{redirect:a}}).done(_.bind(function(a){this.providers=a,this.render()},this))},render:function(){var a=[];_.each(this.providers,function(b,c){var d=this._buttons[c];d?(d.provider=c,a.push(d)):console.warn("Unsupported OAuth provider: "+c)},this),this.$el.append(jade.templates.oauth_login({buttons:a}))},_buttons:{Google:{icon:"gplus","class":"g-oauth-button-google"}}}),girder.wrap(girder.views.LoginView,"render",function(a){return a.call(this),new girder.views.oauth_LoginView({el:this.$(".modal-body")}),this}),girder.exposePluginConfig("oauth","plugins/oauth/config");
//# sourceMappingURL=plugin.min.map