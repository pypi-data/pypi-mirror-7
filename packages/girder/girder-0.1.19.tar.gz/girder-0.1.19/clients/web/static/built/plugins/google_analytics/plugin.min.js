this.jade=this.jade||{},this.jade.templates=this.jade.templates||{},this.jade.templates.google_analytics_config=function(){var a=[];return a.push('<div class="g-config-breadcrumb-container"></div><div class="g-google-analytics-description">To track pageviews in Girder, enter your Google Analytics tracking ID here.</div><form id="g-google_analytics-form" role="form"><div class="form-group"><label for="google_analytics.tracking_id" class="control-label">Google Analytics Tracking ID</label><input id="google_analytics" type="text" placeholder="Tracking ID" class="input-sm form-control tracking_id"/></div><p id="g-oauth-provider-google-error-message" class="g-validation-failed-message"></p><input type="submit" value="Save" class="btn btn-sm btn-primary"/></form>'),a.join("")},girder.views.google_analytics_ConfigView=girder.View.extend({events:{"submit #g-google_analytics-form":function(a){a.preventDefault(),this.$("#g-google_analytics-error-message").empty(),this._saveSettings([{key:"google_analytics.tracking_id",value:this.$("#google_analytics.tracking_id").val().trim()}])}},initialize:function(){girder.restRequest({type:"GET",path:"system/setting",data:{list:JSON.stringify(["google_analytics.tracking_id"])}}).done(_.bind(function(a){this.render(),this.$("#google_analytics.tracking_id").val(a["google_analytics.tracking_id"])},this))},render:function(){return this.$el.html(jade.templates.google_analytics_config()),this.breadcrumb||(this.breadcrumb=new girder.views.PluginConfigBreadcrumbWidget({pluginName:"Google Analytics",el:this.$(".g-config-breadcrumb-container")}).render()),this},_saveSettings:function(a){girder.restRequest({type:"PUT",path:"system/setting",data:{list:JSON.stringify(a)},error:null}).done(_.bind(function(){girder.events.trigger("g:alert",{icon:"ok",text:"Settings saved.",type:"success",timeout:4e3})},this)).error(_.bind(function(a){this.$("#g-google_analytics-error-message").text(a.responseJSON.message)},this))}}),girder.router.route("plugins/google_analytics/config","google_analyticsConfig",function(){girder.events.trigger("g:navigateTo",girder.views.google_analytics_ConfigView)}),function(a){"use strict";"function"==typeof define&&define.amd?define(["backbone"],a):"object"==typeof exports?module.exports=a(require("backbone")):a(window.Backbone)}(function(a){"use strict";var b=a.History.prototype.loadUrl;a.History.prototype.loadUrl=function(){var a=b.apply(this,arguments),c=this.fragment;if(!this.options.silent)return this.options.silent=!0,a;/^\//.test(c)||(c="/"+c),"undefined"!=typeof window._gaq&&window._gaq.push(["_trackPageview",c]);var d;return d=window.GoogleAnalyticsObject&&"ga"!==window.GoogleAnalyticsObject?window.GoogleAnalyticsObject:window.ga,"undefined"!=typeof d&&d("send","pageview",c),a}}),girder.exposePluginConfig("google_analytics","plugins/google_analytics/config"),girder.events.on("g:appload.after",function(){!function(a,b,c,d,e,f,g){a.GoogleAnalyticsObject=e,a[e]=a[e]||function(){(a[e].q=a[e].q||[]).push(arguments)},a[e].l=1*new Date,f=b.createElement(c),g=b.getElementsByTagName(c)[0],f.async=1,f.src=d,g.parentNode.insertBefore(f,g)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),girder.restRequest({type:"GET",path:"system/setting",data:{list:JSON.stringify(["google_analytics.tracking_id"])}}).done(_.bind(function(a){ga("create",a["google_analytics.tracking_id"],"none")},this))}),girder.events.on("g:hierarchy.route",function(a){var b=a.route;/^\//.test(b)||(b="/"+b),ga("send","pageview",b)});
//# sourceMappingURL=plugin.min.map