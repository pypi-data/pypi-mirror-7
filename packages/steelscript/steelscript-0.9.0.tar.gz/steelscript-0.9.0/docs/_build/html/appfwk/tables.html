<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6.8. Tables &mdash; steelscript  documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="steelscript  documentation" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">steelscript  documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="tables">
<h1>6.8. Tables<a class="headerlink" href="#tables" title="Permalink to this headline">¶</a></h1>
<p>All data in the application framework is associated with a Table.
Fundamentally, a Table is a Django model instance that defines the
columns and attributes.  In many senses that Table definition is
similar to a SQL TABLE construct.</p>
<div class="section" id="overview">
<h2>6.8.1. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Tables are defined as part of report configuration source files.  All
tables are defined by instantiating a subclass of <tt class="docutils literal"><span class="pre">DatasourceTable</span></tt>
that is specific to a particular data source.</p>
<p>Defining tables involves the following definitions:</p>
<p><strong>Tables</strong></p>
<blockquote>
<div>Tables are the fundamental mechanism for defining the data that is
to collected.  Each table is a specific to a data source and is
tied to a function in that data source to generate data based on
the table&#8217;s columns as well as any static and dynamic criteria.</div></blockquote>
<p><strong>Columns</strong></p>
<blockquote>
<div>A table is fundamentally a two dimensional construct of rows and
columns.  The report configuration source file defines the columns
associated with a table.  The column binds a label and data type
to data source specific fields that the table query function uses
to populate data.  Similar to a SQL table, some columns are key
columns, the rest are data or metrics columns.</div></blockquote>
<p><strong>Table Fields</strong></p>
<blockquote>
<div>Table fields define the required and optional criteria associated
with a table.  Each data source can define a set of table fields
that are required or optional for each type of table</div></blockquote>
<p>Note that while tables are defined in the context of a report
configuration source file, tables are only loosely coupled with a
report via widgets.  In fact, it is possible to run tables at the
command line without running an entire report.</p>
<div class="section" id="sample-table-definition">
<h3>6.8.1.1. Sample Table Definition<a class="headerlink" href="#sample-table-definition" title="Permalink to this headline">¶</a></h3>
<p>The following table is taken from the Wave sample plugin:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">steelscript.wave.appfwk.datasources.wave_source</span> <span class="kn">as</span> <span class="nn">wave</span>

<span class="c"># Define a waves table with 3 separate waves.</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">wave</span><span class="o">.</span><span class="n">WaveTable</span><span class="o">.</span><span class="n">create</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">&#39;wave-table&#39;</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="s">&#39;15min&#39;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s">&#39;1s&#39;</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c"># Add columns for time and the related waves</span>
<span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="s">&#39;Time&#39;</span><span class="p">,</span> <span class="n">datatype</span><span class="o">=</span><span class="n">Column</span><span class="o">.</span><span class="n">DATATYPE_TIME</span><span class="p">,</span> <span class="n">iskey</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">&#39;sin1&#39;</span><span class="p">,</span> <span class="s">&#39;Sine Wave 1&#39;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="s">&#39;sin&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="s">&#39;5min&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">&#39;sin2&#39;</span><span class="p">,</span> <span class="s">&#39;Sine Wave 2&#39;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="s">&#39;sin&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="s">&#39;8min&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">&#39;cos&#39;</span><span class="p">,</span>  <span class="s">&#39;Cosine Wave&#39;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="s">&#39;cos&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="s">&#39;3min&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-tables">
<h2>6.8.2. Creating Tables<a class="headerlink" href="#creating-tables" title="Permalink to this headline">¶</a></h2>
<p>Table objects are Django model instances backed by the database.
Tables are created by calling the <tt class="docutils literal"><span class="pre">create</span></tt> class method of specific
table of interest.  Each table type is programmed to generate data
differently.</p>
<p>The term &#8220;data source&#8221; is intentionally vague, as all that is required
of a given type of table is that it can, on demand, produce a
data set &#8211; a two dimensional set of rows and columns that match
the requested table configruation (options and columns) as well as
dynamic user provided criteria.  The following are some examples of
valid data sources:</p>
<ul class="simple">
<li>leverage configured devices to run queries on remote machines</li>
<li>generate data based on some algorithm</li>
<li>read data from a file or database</li>
<li>merge data from other tables or source and produce a modified table</li>
</ul>
<p>The following table lists some of the data source tables
available:</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">DatasourceTable Subclass Name</th>
<th class="head">Package</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>WaveTable</td>
<td>steelscript.wave.appfwk.datasources.wave_source</td>
</tr>
<tr class="row-odd"><td>AnalysisTable</td>
<td>steelscript.appfwk.apps.datasource.modules.analysis</td>
</tr>
<tr class="row-even"><td>HTMLTable</td>
<td>steelscript.appfwk.apps.datasource.modules.html</td>
</tr>
<tr class="row-odd"><td>SharepointTable</td>
<td>steelscript.appfwk.apps.plugins.builtin.sharepoint.datasources.sharepoint</td>
</tr>
<tr class="row-even"><td>SolarwindsTable</td>
<td>steelscript.appfwk.apps.plugins.builtin.solarwinds.datasources.solarwinds</td>
</tr>
<tr class="row-odd"><td>NetProfilerTable</td>
<td>steelscript.netprofiler.appfwk.datasources.netprofiler</td>
</tr>
<tr class="row-even"><td>NetProfilerTimeSeriesTable</td>
<td>steelscript.netprofiler.appfwk.datasources.netprofiler</td>
</tr>
<tr class="row-odd"><td>NetProfilerGroupbyTable</td>
<td>steelscript.netprofiler.appfwk.datasources.netprofiler</td>
</tr>
<tr class="row-even"><td>NetProfilerDeviceTable</td>
<td>steelscript.netprofiler.appfwk.datasources.netprofiler_devices</td>
</tr>
<tr class="row-odd"><td>NetProfilerTemplateTable</td>
<td>steelscript.netprofiler.appfwk.datasources.netprofiler_template</td>
</tr>
<tr class="row-even"><td>NetSharkTable</td>
<td>steelscript.netshark.appfwk.datasources.netshark</td>
</tr>
<tr class="row-odd"><td>WiresharkTable</td>
<td>steelscript.wireshark.appfwk.datasources.wireshark_source</td>
</tr>
</tbody>
</table>
<p>Tables are created by calling the <tt class="docutils literal"><span class="pre">create</span></tt> class method of the
DatasourceTable subclass:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="o">&lt;</span><span class="n">package</span><span class="o">&gt;</span> <span class="kn">import</span> <span class="o">&lt;</span><span class="n">cls</span><span class="o">&gt;</span>
<span class="n">table</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">cls</span><span class="o">&gt;.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="p">[</span><span class="n">table_options</span><span class="p">],</span> <span class="p">[</span><span class="n">field_options</span><span class="p">])</span>
</pre></div>
</div>
<dl class="classmethod">
<dt id="steelscript.appfwk.apps.datasource.models.DatasourceTable.create">
<em class="property">classmethod </em><tt class="descclassname">DatasourceTable.</tt><tt class="descname">create</tt><big>(</big><em>name</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#steelscript.appfwk.apps.datasource.models.DatasourceTable.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) &#8211; Unique identifier for this table</td>
</tr>
</tbody>
</table>
<p>Standard keyword arguments:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>rows</strong> (<em>int</em>) &#8211; set maximum number of rows to save after
sorting (defaults to -1, no maximum)</li>
<li><strong>resample</strong> (<em>bool</em>) &#8211; if True, timeseries data returned by the
data source will be resampled to <tt class="docutils literal"><span class="pre">criteria.resample_resolution</span></tt>
or <tt class="docutils literal"><span class="pre">criteria.resolution</span></tt></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Additional table and field options keyword arguments may
be provided that are unique to the specific data source
table being instantiatied:</p>
<p><tt class="docutils literal"><span class="pre">table_options</span></tt></p>
<blockquote>
<div>These options define subclass-specific options that allow
customization of a table instance. Table options are <em>not</em>
visible to users running reports via the UI.  Option
values are provided at table creation and are considered
static for the life of this table instance.</div></blockquote>
<p><tt class="docutils literal"><span class="pre">field_options</span></tt></p>
<blockquote>
<div><p>Most tables are designed to take input from the user via table
fields.  The user fills in values for each table field and the set
of input becomes the report <em>criteria</em>.</p>
<p>Field options allow the report writer to customize the aspects of
table fields such as the initial value of a form field or the list
of choices in a drop-down selection field.</p>
</div></blockquote>
</dd></dl>

<div class="section" id="adding-columns">
<h3>6.8.2.1. Adding Columns<a class="headerlink" href="#adding-columns" title="Permalink to this headline">¶</a></h3>
<p>Columns define the keys and values of the data set that this table
will collect.  They are added to a table using
<a class="reference internal" href="#steelscript.appfwk.apps.datasource.models.DatasourceTable.add_column" title="steelscript.appfwk.apps.datasource.models.DatasourceTable.add_column"><tt class="xref py py-meth docutils literal"><span class="pre">DatasourceTable.add_column()</span></tt></a>.</p>
<p>When a query is run, the data source associated with a table
inspects the list of key and value columns and generates a
data table matching the requested column set.</p>
<dl class="method">
<dt id="steelscript.appfwk.apps.datasource.models.DatasourceTable.add_column">
<tt class="descclassname">DatasourceTable.</tt><tt class="descname">add_column</tt><big>(</big><em>name</em>, <em>label=None</em>, <em>sortasc=False</em>, <em>sortdesc=False</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#steelscript.appfwk.apps.datasource.models.DatasourceTable.add_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a column to this table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>str</em>) &#8211; Unique identifier for this column</li>
<li><strong>label</strong> (<em>str</em>) &#8211; Display string, defaults to name</li>
<li><strong>sortasc, sortdesc</strong> (<em>bool</em>) &#8211; Sort table based on this columns data</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Standard keyword arguments:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>iskey</strong> (<em>bool</em>) &#8211; Set True for key columns</li>
<li><strong>datatype</strong> (<em>enum</em>) &#8211; <p>type of data his column contains,
defaults to &#8216;float&#8217;:</p>
<ul>
<li>float</li>
<li>integer</li>
<li>time</li>
<li>string</li>
<li>html</li>
</ul>
</li>
<li><strong>units</strong> (<em>enum</em>) &#8211; <p>Units for data in this column, defaults to none:</p>
<ul>
<li>none - no units</li>
<li>s - seconds</li>
<li>ms - milliseconds</li>
<li>B - bytes</li>
<li>B/s - bytes per second</li>
<li>pct - percentage</li>
</ul>
</li>
<li><strong>position</strong> (<em>float</em>) &#8211; Display position relative to other columns, automatically
computed by default</li>
<li><strong>synthetic</strong> (<em>bool</em>) &#8211; Set True to compute this columns value
according to <tt class="docutils literal"><span class="pre">compute_expression</span></tt></li>
<li><strong>compute_expression</strong> (<em>str</em>) &#8211; Computation expression for syntetic columns</li>
<li><strong>compute_post_resample</strong> (<em>bool</em>) &#8211; If true, compute this synthetic column
after resampling (time series only)</li>
<li><strong>resample_operation</strong> (<em>str</em>) &#8211; Operation to use on this column to aggregate
multiple rows during resampling, defaults to sum</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="synthetic-columns">
<h3>6.8.2.2. Synthetic Columns<a class="headerlink" href="#synthetic-columns" title="Permalink to this headline">¶</a></h3>
<p>In addition to columnar data generated by a data source, additional
<em>synthetic</em> columns may be attached to a table.  Synthetic
columns provide an easy way to perform computations on other
data columns in the same table.</p>
<p>This is best explained by an example based on the WaveTable above:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">&#39;sin1&#39;</span><span class="p">,</span> <span class="s">&#39;Sine Wave 1&#39;</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="s">&#39;sin&#39;</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="s">&#39;5min&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="s">&#39;sin1-doubled&#39;</span><span class="p">,</span> <span class="n">synthetic</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">compute_expression</span><span class="o">=</span><span class="s">&#39;2*{sin1}&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The first is a normal column whose data will be provided by
the wave data source.  The second column is a synthetic column
that is simply the &#8216;sin1&#8217; column multipled by 2.</p>
<p>The <tt class="docutils literal"><span class="pre">compute_expression</span></tt> column keyword defines the operation to
perform:</p>
<ul class="simple">
<li>Other column values are referenced using the syntax <tt class="docutils literal"><span class="pre">{name}</span></tt>,
where <tt class="docutils literal"><span class="pre">name</span></tt> is the name assigned to another column in the same
table.  Any number of other columns may be referenced</li>
<li>Standard mathemtical operators may be used: <tt class="docutils literal"><span class="pre">+</span></tt>, <tt class="docutils literal"><span class="pre">-</span></tt>, <tt class="docutils literal"><span class="pre">*</span></tt>,
<tt class="docutils literal"><span class="pre">/</span></tt>, and others.</li>
<li><tt class="docutils literal"><span class="pre">{name}</span></tt> is actually a Python Pandas Series object, and thus
functions on series data can be leveraged either by methods on the
series object or by using the full package path:<ul>
<li><tt class="docutils literal"><span class="pre">{name}.quantile(0.95)</span></tt> will compute the 95th percentile for the
data in column {name}</li>
<li><tt class="docutils literal"><span class="pre">pandas.stats.moments.ewma({name},</span> <span class="pre">span=20)</span></tt> will compute the
EWMA (exponential weighted moving average) of the <tt class="docutils literal"><span class="pre">{name}</span></tt>
column using a span of 20 data points.</li>
</ul>
</li>
</ul>
<p>For more advanced analysis techniques, see <a class="reference internal" href="analysis.html"><em>Analysis Tables</em></a>.</p>
</div>
<div class="section" id="resamping-time-series-tables">
<h3>6.8.2.3. Resamping Time Series Tables<a class="headerlink" href="#resamping-time-series-tables" title="Permalink to this headline">¶</a></h3>
<p>When working with time series data, a common operation is to resample
that data:</p>
<ul class="simple">
<li>Incoming data is at 1 minute resolution, but the output needs to be
at 5 minute resolution</li>
<li>Incoming data has erratic non-normalized timestamps, the output
should be graphed at steady 1 minute resolution</li>
</ul>
<p>The application framework will automatically resample timeseries data
when the <tt class="docutils literal"><span class="pre">resample=True</span></tt> at creation.  In addition, there must be
a critieria field named either <tt class="docutils literal"><span class="pre">resample_resolution</span></tt> or just
<tt class="docutils literal"><span class="pre">resolution</span></tt>, which sets the target resample interval.</p>
<p>When resampling, data from multiple rows must be aggregated (each row
represents a timestamp or time interval).  The aggregation operation
is different for different types of data:</p>
<ul class="simple">
<li>Counted metrics such as &#8220;total bytes&#8221; involves
computing the &#8220;sum&#8221; of all rows covered by the new interval.</li>
<li>Peak metrics such as &#8220;peak network RTT&#8221; require computing the &#8220;max&#8221;
of all metrics.</li>
</ul>
<p>Each data column may be set up with a different <tt class="docutils literal"><span class="pre">resample_operation</span></tt>
based.  The default is <tt class="docutils literal"><span class="pre">sum</span></tt>, but this is not always appropriate for
all data types.</p>
<p>Note that when using synthetic columns as describe above, you can
choose to compute the synthetic columns before or after resampling by
setting <tt class="docutils literal"><span class="pre">compute_post_resample</span></tt>.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/rb-ss-logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="overview.html">SteelScript Application Framework</a></h3>
  <ul>
<li><a class="reference internal" href="#">6.8. Tables</a><ul>
<li><a class="reference internal" href="#overview">6.8.1. Overview</a><ul>
<li><a class="reference internal" href="#sample-table-definition">6.8.1.1. Sample Table Definition</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-tables">6.8.2. Creating Tables</a><ul>
<li><a class="reference internal" href="#adding-columns">6.8.2.1. Adding Columns</a></li>
<li><a class="reference internal" href="#synthetic-columns">6.8.2.2. Synthetic Columns</a></li>
<li><a class="reference internal" href="#resamping-time-series-tables">6.8.2.3. Resamping Time Series Tables</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/appfwk/tables.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>
<a href="../license.html">License</a>
</h3>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">steelscript  documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014 Riverbed Technology, Inc..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>