<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6.9. Plugins &mdash; steelscript  documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="steelscript  documentation" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">steelscript  documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="plugins">
<h1>6.9. Plugins<a class="headerlink" href="#plugins" title="Permalink to this headline">¶</a></h1>
<p id="create-a-new-plugin">A plugin is some collection of one or more of the following:</p>
<ul class="simple">
<li>core - low-level classes and functions, may involve interacting with
remote systems</li>
<li>devices - abstraction for managing new device types</li>
<li>data sources<ul>
<li>new table types for collecting data from devices</li>
<li>analyais tables for manipulating data from other data sources</li>
</ul>
</li>
<li>reports - defined based on new tables and or tables from other
plugins</li>
</ul>
<p>Each plugin is fundamentally a Python Package, and thus yeilds
all the benefits that such packaging provides:</p>
<ul class="simple">
<li>setup.py - single script for building a distribution for sharing</li>
<li>versioning - major.minor.patch version numbers to faciitate tracking and upgrade</li>
<li>simple installation both from source as well as from a single distribution file</li>
</ul>
<div class="section" id="creating-a-new-plugin">
<h2>6.9.1. Creating a new plugin<a class="headerlink" href="#creating-a-new-plugin" title="Permalink to this headline">¶</a></h2>
<p>New Application Framwork plugins can be created at any time using
<tt class="docutils literal"><span class="pre">steel</span> <span class="pre">appfwk</span> <span class="pre">mkplugin</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>$ steel appfwk mkplugin -h
Usage: steel appfwk mkplugin [options]

Create a new SteelScript Application Framwork plugin

Options:
  --version             show program&#39;s version number and exit
  -h, --help            show this help message and exit
  -n NAME, --name=NAME  Simple name for the plugin
  -t TITLE, --title=TITLE
                        Title for the plugin
  -D DESCRIPTION, --description=DESCRIPTION
                        Short description
  -a AUTHOR, --author=AUTHOR
                        Author&#39;s name
  -e AUTHOR_EMAIL, --author-email=AUTHOR_EMAIL
                        Author&#39;s email
  --non-interactive     Accept defaults for all options not specified
  -d DIR, --dir=DIR     Location to create the new package
  -w, --wave            Create the sample wave plugin rather than empty
  --nogit               Do not initialize project as new git repo
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can create a fully functional sample &#8220;Wave Generator&#8221; plugin
using the command <tt class="docutils literal"><span class="pre">steel</span> <span class="pre">appfwk</span> <span class="pre">plugin</span> <span class="pre">-w</span></tt>.  This will populate
<tt class="docutils literal"><span class="pre">steelscript-wave</span></tt> in the current directory with all the files
associated with this plugin.  The source files are well documented.
Once created, <tt class="docutils literal"><span class="pre">cd</span> <span class="pre">steelscript-wave</span></tt> followed by <tt class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.</span></tt>
will install the plugin and make it available in your current
application project.</p>
</div>
<p>You will need to give your new plugin a short name &#8211; this should be
all lowercase and very simple and short.  A directory will be named
<tt class="docutils literal"><span class="pre">steelscript-{name}</span></tt> and all your code will be available via
<tt class="docutils literal"><span class="pre">import</span> <span class="pre">steelscript.{name}.*</span></tt>.</p>
<p>Use the title for a one-liner and description for even more detail.
You can change the title and description later by editing <tt class="docutils literal"><span class="pre">setup.py</span></tt>
and <tt class="docutils literal"><span class="pre">plugin.py</span></tt> (see below).</p>
<p>The new plugin will have skeleton code in most files with comments
to describe the functionality that is to be placed in each file.
See the <tt class="docutils literal"><span class="pre">wave</span></tt> plugin for an example of a fully functional plugin
that demonstrates many aspects of a plugin from core to
<a class="reference internal" href="analysis.html"><em>AnalysisTables</em></a>.</p>
<p>By default the new source tree is initialized as a local git
repository if <tt class="docutils literal"><span class="pre">git</span></tt> is available.  Specify <tt class="docutils literal"><span class="pre">--nogit</span></tt> to disable
this.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The rest of this page will use name <tt class="docutils literal"><span class="pre">wave</span></tt> as an example.</p>
</div>
</div>
<div class="section" id="directory-layout">
<h2>6.9.2. Directory layout<a class="headerlink" href="#directory-layout" title="Permalink to this headline">¶</a></h2>
<p>Once a new plugin has been created, the following items will
be present:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">File/directory</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>gitpy_versioning</td>
<td>Source files to manage versioning</td>
</tr>
<tr class="row-odd"><td>LICENSE</td>
<td>MIT License text</td>
</tr>
<tr class="row-even"><td>MANIFEST.in</td>
<td>List of files/directories to include/exclude for packaging</td>
</tr>
<tr class="row-odd"><td>README.rst</td>
<td>Description of the project</td>
</tr>
<tr class="row-even"><td>RELEASE-VERSION</td>
<td>Version file</td>
</tr>
<tr class="row-odd"><td>setup.py</td>
<td>Python script for creating distributions and installing</td>
</tr>
<tr class="row-even"><td>steelscript/</td>
<td>Root directory for all source code</td>
</tr>
<tr class="row-odd"><td>steelscript/wave/appfwk/</td>
<td>Sub-directory of all Application Framework related sources</td>
</tr>
<tr class="row-even"><td>steelscript/wave/appfwk/datasources/</td>
<td>Directory for defining new data source</td>
</tr>
<tr class="row-odd"><td>steelscript/wave/appfwk/devices/</td>
<td>Directory for defining new device types</td>
</tr>
<tr class="row-even"><td>steelscript/wave/appfwk/libs/</td>
<td>Miscellaneous helper functions / class for appfwk</td>
</tr>
<tr class="row-odd"><td>steelscript/wave/appfwk/models.py</td>
<td>Database models specific to this plugin</td>
</tr>
<tr class="row-even"><td>steelscript/wave/appfwk/plugin.py</td>
<td>Settings for the appfwk plugin</td>
</tr>
<tr class="row-odd"><td>steelscript/wave/appfwk/reports/</td>
<td>Custom reports</td>
</tr>
<tr class="row-even"><td>steelscript/wave/commands/</td>
<td>Sub-commands for <tt class="docutils literal"><span class="pre">steel</span></tt></td>
</tr>
<tr class="row-odd"><td>steelscript/wave/core/</td>
<td>Low-level functions and classes</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="installing-from-source">
<h2>6.9.3. Installing from source<a class="headerlink" href="#installing-from-source" title="Permalink to this headline">¶</a></h2>
<p>Once you have created the source tree for you new plugin, you will
need to install it in order for your application framework project
to find it.</p>
<p>The preferred installation method during development is as follows
(from within a virtualenv, as necessary):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> <span class="nb">cd </span>steelscript-wave
<span class="gp">$</span> pip install -e .
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">-e</span></tt> argument indicates that the package should be installed in
<em>editable</em> mode.  That means you can make changes to the code in the
local directory and they will take effect in the environment where you
are installing the package.  Without this flag, source files will
instead be <em>copied</em> into the <tt class="docutils literal"><span class="pre">site-packages</span></tt> directory.</p>
<p>Once your package is installed, it should show up in the output of
<tt class="docutils literal"><span class="pre">steel</span> <span class="pre">about</span></tt>:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> steel about

<span class="go">Installed SteelScript Packages</span>
<span class="go">Core packages:</span>
<span class="go">  steelscript                               0.6.0.post43</span>
<span class="go">  steelscript.netprofiler                   0.6.0.post23</span>
<span class="go">  steelscript.netshark                      0.6.0.post21</span>
<span class="go">  steelscript.wave                          0.0.1              &lt;== new plugin</span>
<span class="go">  steelscript.wireshark                     0.9.0rc2.post3</span>
</pre></div>
</div>
<p>This means that in any of your scripts you can now import your code
via the module path <tt class="docutils literal"><span class="pre">steelscript.wave</span></tt>.</p>
</div>
<div class="section" id="plugin-reports">
<h2>6.9.4. Plugin Reports<a class="headerlink" href="#plugin-reports" title="Permalink to this headline">¶</a></h2>
<p>A typical first step is to write a test report or two as part of
your plugin.</p>
<p>Note that while report source files are in your plugin directory, they
must be copied to your project using the <tt class="docutils literal"><span class="pre">collectreports</span></tt> command as
described in <a class="reference internal" href="managing.html#collecting-reports"><em>Collecting Reports</em></a> (probably with the
<tt class="docutils literal"><span class="pre">--overwrite</span></tt> flag).  Then you must <a class="reference internal" href="managing.html#reloading-reports"><em>reload reports</em></a>.  This must be executed each time you make a change to the
reports.</p>
</div>
<div class="section" id="creating-a-distribution">
<h2>6.9.5. Creating a Distribution<a class="headerlink" href="#creating-a-distribution" title="Permalink to this headline">¶</a></h2>
<p>Once you have successfully created a plugin and are ready to share it,
you need to make a distribution.  This is a fairly simple process that
requires only setting a version number and building the package.</p>
<div class="section" id="setting-a-version">
<h3>6.9.5.1. Setting a version<a class="headerlink" href="#setting-a-version" title="Permalink to this headline">¶</a></h3>
<p>If your new project was set up with git, then versioning is based
on git annotated tags.  At creation a tag of 0.0.1 was added to the
very first commit.</p>
<p>Tag a new version using <tt class="docutils literal"><span class="pre">git</span> <span class="pre">tag</span></tt>:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> git commit -a -m <span class="s2">&quot;Checking in all outstanding changes&quot;</span>
<span class="gp">$</span> git tag -a 0.0.2 -m 0.0.2
</pre></div>
</div>
<p>This will commit all outstanding changes since the last commit (to the
local repository only).  Then a tag of 0.0.2 is added.   Ideally
we recommend following <a class="reference external" href="http://semver.org/">Semantic Versioning</a>
which uses the model of <tt class="docutils literal"><span class="pre">&lt;major&gt;.&lt;minor&gt;.&lt;patch&gt;</span></tt>.  In any event
you should use <em>increasing</em> version numbers using this pattern to
ensure that upgrades happen properly.</p>
<p>If you are not using git, simple edit the <tt class="docutils literal"><span class="pre">RELEASE-VERSION</span></tt> file in
the root of the project to designate the desired version.</p>
</div>
<div class="section" id="packaging">
<h3>6.9.5.2. Packaging<a class="headerlink" href="#packaging" title="Permalink to this headline">¶</a></h3>
<p>Once you have set a version, a tar-file is created with one command:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> <span class="nb">cd </span>steelscript-wave
<span class="gp">$</span> python setup.py sdist
<span class="go">running sdist</span>
<span class="go">running egg_info</span>
<span class="go">writing dependency_links to steelscript.wave.egg-info/dependency_links.txt</span>
<span class="go">writing requirements to steelscript.wave.egg-info/requires.txt</span>
<span class="go">writing steelscript.wave.egg-info/PKG-INFO</span>
<span class="go">writing top-level names to steelscript.wave.egg-info/top_level.txt</span>
<span class="go">writing namespace_packages to steelscript.wave.egg-info/namespace_packages.txt</span>
<span class="go">writing entry points to steelscript.wave.egg-info/entry_points.txt</span>
<span class="go">reading manifest file &#39;steelscript.wave.egg-info/SOURCES.txt&#39;</span>
<span class="go">reading manifest template &#39;MANIFEST.in&#39;</span>
<span class="go">writing manifest file &#39;steelscript.wave.egg-info/SOURCES.txt&#39;</span>
<span class="go">running check</span>
<span class="go">warning: check: missing required meta-data: url</span>

<span class="go">creating steelscript.wave-0.0.2</span>
<span class="go">creating steelscript.wave-0.0.2/gitpy_versioning</span>
<span class="go">creating steelscript.wave-0.0.2/steelscript</span>

<span class="go">...</span>
<span class="go">...</span>

<span class="go">Writing steelscript.wave-0.0.2/setup.cfg</span>
<span class="go">creating dist</span>
<span class="go">Creating tar archive</span>
<span class="go">removing &#39;steelscript.wave-0.0.2&#39; (and everything under it)</span>
</pre></div>
</div>
<p>When this is complete you should see a file in the <tt class="docutils literal"><span class="pre">dist</span></tt> directory:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> ls dist
<span class="go">total 20K</span>
<span class="go">20K steelscript.wave-0.0.2.tar.gz</span>
</pre></div>
</div>
<p>This is your new package!</p>
</div>
<div class="section" id="sharing-and-installing">
<h3>6.9.5.3. Sharing and Installing<a class="headerlink" href="#sharing-and-installing" title="Permalink to this headline">¶</a></h3>
<p>This new package can be installed on any other steelscript
installation.  Simply upload to the new machine, start up the
virtualenv and run:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> pip install steelscript.wave-0.0.2.tar.gz
</pre></div>
</div>
<p>Thats about it!  When you&#8217;re ready, you can post your entire tree up
on github or even share it via PyPI, the Python Package Index.</p>
</div>
</div>
<div class="section" id="custom-data-sources-and-analysis-tables">
<h2>6.9.6. Custom Data sources and Analysis Tables<a class="headerlink" href="#custom-data-sources-and-analysis-tables" title="Permalink to this headline">¶</a></h2>
<p>The real power in plugins is the ability to write fully custom
code to extract data from remote devices or perform complex analysis
on data retrieved from other tables.  See the Wave plugin for an
example of what&#8217;s possible.</p>
<p>Move on to <a class="reference internal" href="analysis.html"><em>Analysis Tables</em></a> for a detailed guide
to writing custom analysis classes.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/rb-ss-logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="overview.html">SteelScript Application Framework</a></h3>
  <ul>
<li><a class="reference internal" href="#">6.9. Plugins</a><ul>
<li><a class="reference internal" href="#creating-a-new-plugin">6.9.1. Creating a new plugin</a></li>
<li><a class="reference internal" href="#directory-layout">6.9.2. Directory layout</a></li>
<li><a class="reference internal" href="#installing-from-source">6.9.3. Installing from source</a></li>
<li><a class="reference internal" href="#plugin-reports">6.9.4. Plugin Reports</a></li>
<li><a class="reference internal" href="#creating-a-distribution">6.9.5. Creating a Distribution</a><ul>
<li><a class="reference internal" href="#setting-a-version">6.9.5.1. Setting a version</a></li>
<li><a class="reference internal" href="#packaging">6.9.5.2. Packaging</a></li>
<li><a class="reference internal" href="#sharing-and-installing">6.9.5.3. Sharing and Installing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#custom-data-sources-and-analysis-tables">6.9.6. Custom Data sources and Analysis Tables</a></li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/appfwk/plugins.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>
<a href="../license.html">License</a>
</h3>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">steelscript  documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014 Riverbed Technology, Inc..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>