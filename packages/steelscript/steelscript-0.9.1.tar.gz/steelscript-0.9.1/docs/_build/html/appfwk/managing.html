<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6.5. Managing the server &mdash; steelscript  documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="steelscript  documentation" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">steelscript  documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="managing-the-server">
<h1>6.5. Managing the server<a class="headerlink" href="#managing-the-server" title="Permalink to this headline">¶</a></h1>
<p>The Application Framework server can be run in two different
modes, using the built-in development server, or a more
robust production-ready server such as Apache or Nginx.</p>
<p>For many purposes, the development server will be fine, when
deploying to a dedicated server for use by more than one person
at a time, Apache will be more appropriate.  See <a class="reference internal" href="#running-the-server"><em>Running the server</em></a>
below for more information about both deployments.</p>
<div class="section" id="maintenance-rebuilding">
<h2>6.5.1. Maintenance / Rebuilding<a class="headerlink" href="#maintenance-rebuilding" title="Permalink to this headline">¶</a></h2>
<p>Several commands support ongoing maintenance of the App Framework server,
useful during development, debugging, or upgrading.</p>
<div class="section" id="collecting-reports">
<span id="id1"></span><h3>6.5.1.1. Collecting Reports<a class="headerlink" href="#collecting-reports" title="Permalink to this headline">¶</a></h3>
<p>When a new App Framework project gets created, all the available
example and default reports are copied to the <a class="reference internal" href="projects.html#directory-layout"><em>reports directory</em></a>.
These reports can be updated, or deleted freely, and can be restored
using the <tt class="docutils literal"><span class="pre">collectreports</span></tt> command:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> python manage.py collectreports --help
<span class="go">Usage: manage.py collectreports [options] None</span>

<span class="go">Collects reports into App Framework project.</span>

<span class="go">Options:</span>
<span class="go">  -v VERBOSITY, --verbosity=VERBOSITY</span>
<span class="go">                        Verbosity level; 0=minimal output, 1=normal output,</span>
<span class="go">                        2=verbose output, 3=very verbose output</span>
<span class="go">  --settings=SETTINGS   The Python path to a settings module, e.g.</span>
<span class="go">                        &quot;myproject.settings.main&quot;. If this isn&#39;t provided, the</span>
<span class="go">                        DJANGO_SETTINGS_MODULE environment variable will be</span>
<span class="go">                        used.</span>
<span class="go">  --pythonpath=PYTHONPATH</span>
<span class="go">                        A directory to add to the Python path, e.g.</span>
<span class="go">                        &quot;/home/djangoprojects/myproject&quot;.</span>
<span class="go">  --traceback           Print traceback on exception</span>
<span class="go">  --overwrite           Overwrite ALL existing reports.</span>
<span class="go">  --version             show program&#39;s version number and exit</span>
<span class="go">  -h, --help            show this help message and exit</span>
</pre></div>
</div>
<p>When adding a new package, or plugin to the system, this command should be
run to copy over any new example reports included.</p>
<p>Use the <tt class="docutils literal"><span class="pre">overwrite</span></tt> option carefully, this will overwrite any changes
you have made to the reports in your folder.</p>
</div>
<div class="section" id="reloading-reports">
<span id="id2"></span><h3>6.5.1.2. Reloading Reports<a class="headerlink" href="#reloading-reports" title="Permalink to this headline">¶</a></h3>
<p>With any new changes made to the reports in your <a class="reference internal" href="projects.html#directory-layout"><em>reports directory</em></a>
you will want to get those changes recognized by the system.  The most useful
way is to use the <tt class="docutils literal"><span class="pre">Reload</span> <span class="pre">This</span> <span class="pre">Report</span></tt> or <tt class="docutils literal"><span class="pre">Reload</span> <span class="pre">All</span> <span class="pre">Reports</span></tt> from the
upper-right dropdown menu in the browser, but there is also a command-line
option available too:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> python manage.py reload --help
<span class="go">Usage: manage.py reload [options] None</span>

<span class="go">Reloads the configuration defined in the config directory</span>

<span class="go">Options:</span>
<span class="go">  -v VERBOSITY, --verbosity=VERBOSITY</span>
<span class="go">                        Verbosity level; 0=minimal output, 1=normal output,</span>
<span class="go">                        2=verbose output, 3=very verbose output</span>
<span class="go">  --settings=SETTINGS   The Python path to a settings module, e.g.</span>
<span class="go">                        &quot;myproject.settings.main&quot;. If this isn&#39;t provided, the</span>
<span class="go">                        DJANGO_SETTINGS_MODULE environment variable will be</span>
<span class="go">                        used.</span>
<span class="go">  --pythonpath=PYTHONPATH</span>
<span class="go">                        A directory to add to the Python path, e.g.</span>
<span class="go">                        &quot;/home/djangoprojects/myproject&quot;.</span>
<span class="go">  --traceback           Print traceback on exception</span>
<span class="go">  --report-id=REPORT_ID</span>
<span class="go">                        Reload single report.</span>
<span class="go">  --report-name=REPORT_NAME</span>
<span class="go">                        Reload single report by fully qualified name.</span>
<span class="go">  --report-dir=REPORT_DIR</span>
<span class="go">                        Reload reports from this directory.</span>
<span class="go">  --namespace=NAMESPACE</span>
<span class="go">                        Reload reports under this namespace.</span>
<span class="go">  --version             show program&#39;s version number and exit</span>
<span class="go">  -h, --help            show this help message and exit</span>
</pre></div>
</div>
</div>
<div class="section" id="collecting-logs">
<span id="id3"></span><h3>6.5.1.3. Collecting Logs<a class="headerlink" href="#collecting-logs" title="Permalink to this headline">¶</a></h3>
<p>In cases where a problem occurs, the logfiles usually provide a good
indicator of the root cause.  A built-in command helps collect these
files for distribution to the developers or for posting to mailing lists
or archiving:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> python manage.py collect_logs --help
<span class="go">Usage: manage.py collect_logs [options] None</span>

<span class="go">Collects log files and system info and creates file `debug-&lt;timestamp&gt;.zip`</span>

<span class="go">Options:</span>
<span class="go">    &lt;truncated&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="resetting-app-framework-database">
<span id="reset-appfwk"></span><h3>6.5.1.4. Resetting App Framework Database<a class="headerlink" href="#resetting-app-framework-database" title="Permalink to this headline">¶</a></h3>
<p>When wishing to start from a clean slate, the command <tt class="docutils literal"><span class="pre">reset_appfwk</span></tt> can
be used to clear the database, caches, and logs then re-initialize everything.</p>
<p>A helpful warning will be presented (unless skipped with the <tt class="docutils literal"><span class="pre">--force</span></tt>
option) as a reminder that this will completely delete the database!  Though
the warning is dire, there are only a few items which will be irretrieveably
lost, and there are workarounds for users and devices:</p>
<blockquote>
<div><ul class="simple">
<li>users</li>
<li>devices</li>
<li>locations</li>
<li>admin preferences</li>
<li>caches, including job history</li>
</ul>
</div></blockquote>
<p>For users, by default the server will attempt to store the user table offline
before resetting the database, and then restore it afterwards.  This can
be skipped via the <tt class="docutils literal"><span class="pre">--drop-users</span></tt> option which will result in all users
being deleted with only the default admin user remaining.</p>
<p>For devices, each time a new device gets added or updated during normal system
use, a local cache gets created with all the info minus the password, so the
primary inconvenience here requires all passwords to be re-entered after a
reset.</p>
<p>Reports and their defined tables will be re-created as part of the reload
process.</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> python manage.py reset_appfwk --help
<span class="go">Usage: manage.py reset_appfwk [options] None</span>

<span class="go">Reset the database. Prompts for confirmation unless `--force` is included as an argument.</span>

<span class="go">Options:</span>
<span class="go">  -v VERBOSITY, --verbosity=VERBOSITY</span>
<span class="go">                        Verbosity level; 0=minimal output, 1=normal output,</span>
<span class="go">                        2=verbose output, 3=very verbose output</span>
<span class="go">  --settings=SETTINGS   The Python path to a settings module, e.g.</span>
<span class="go">                        &quot;myproject.settings.main&quot;. If this isn&#39;t provided, the</span>
<span class="go">                        DJANGO_SETTINGS_MODULE environment variable will be</span>
<span class="go">                        used.</span>
<span class="go">  --pythonpath=PYTHONPATH</span>
<span class="go">                        A directory to add to the Python path, e.g.</span>
<span class="go">                        &quot;/home/djangoprojects/myproject&quot;.</span>
<span class="go">  --traceback           Print traceback on exception</span>
<span class="go">  --force               Ignore reset confirmation.</span>
<span class="go">  --drop-users          Drop all locally created users, only default admin</span>
<span class="go">                        account will be enabled afterwards. Default will keep</span>
<span class="go">                        all user accounts across reset.</span>
<span class="go">  --version             show program&#39;s version number and exit</span>
<span class="go">  -h, --help            show this help message and exit</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-the-server">
<span id="id4"></span><h2>6.5.2. Running the server<a class="headerlink" href="#running-the-server" title="Permalink to this headline">¶</a></h2>
<p>As decribed above, the server can be run in one of two modes <a class="reference internal" href="#development"><em>Development server</em></a>
and <a class="reference internal" href="#production"><em>Production server</em></a> via sofware like Apache, or nginx.</p>
<div class="section" id="development-server">
<span id="development"></span><h3>6.5.2.1. Development server<a class="headerlink" href="#development-server" title="Permalink to this headline">¶</a></h3>
<p>As described under <a class="reference internal" href="projects.html#creating-a-new-project"><em>Creating a new project</em></a>, a file called
<a class="reference internal" href="projects.html#directory-layout"><em>manage.py</em></a> has been linked inside your project folder.
Executing this file will present a large number of subcommands available for
performing maintenace and development with the server.  The one we are
considering is called <tt class="docutils literal"><span class="pre">runserver</span></tt>.  See below for example help output:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> python manage.py runserver -h
<span class="go">Usage: manage.py runserver [options] [optional port number, or ipaddr:port]</span>

<span class="go">Starts a lightweight Web server for development and also serves static files.</span>

<span class="go">Options:</span>
<span class="go">  -v VERBOSITY, --verbosity=VERBOSITY</span>
<span class="go">                        Verbosity level; 0=minimal output, 1=normal output,</span>
<span class="go">                        2=verbose output, 3=very verbose output</span>
<span class="go">  --settings=SETTINGS   The Python path to a settings module, e.g.</span>
<span class="go">                        &quot;myproject.settings.main&quot;. If this isn&#39;t provided, the</span>
<span class="go">                        DJANGO_SETTINGS_MODULE environment variable will be</span>
<span class="go">                        used.</span>
<span class="go">  --pythonpath=PYTHONPATH</span>
<span class="go">                        A directory to add to the Python path, e.g.</span>
<span class="go">                        &quot;/home/djangoprojects/myproject&quot;.</span>
<span class="go">  --traceback           Print traceback on exception</span>
<span class="go">  -6, --ipv6            Tells Django to use a IPv6 address.</span>
<span class="go">  --nothreading         Tells Django to NOT use threading.</span>
<span class="go">  --noreload            Tells Django to NOT use the auto-reloader.</span>
<span class="go">  --nostatic            Tells Django to NOT automatically serve static files</span>
<span class="go">                        at STATIC_URL.</span>
<span class="go">  --insecure            Allows serving static files even if DEBUG is False.</span>
<span class="go">  --version             show program&#39;s version number and exit</span>
<span class="go">  -h, --help            show this help message and exit</span>
</pre></div>
</div>
<p>In its simplest form, just executing <tt class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">runserver</span></tt> will start
a development server on your local machine at port 8000.  The port can
be overridden, and if you want the server to be accessible to external hosts
(because you are running it inside a virtual machine, for instance), then
pass your explicit ip address and port number.  For example, on many Linux
machines the application <tt class="docutils literal"><span class="pre">facter</span></tt> is available which can present many
basic facts about the host.  Using this command would be like so:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="gp">$</span> python manage.py runserver <span class="sb">`</span>facter ipaddress<span class="sb">`</span>:8000
</pre></div>
</div>
<p>More detailed discussion and explanation of the settings can be found
in the <a class="reference external" href="https://docs.djangoproject.com/en/1.5/ref/django-admin/#runserver-port-or-address-port">official Django documentation</a>.</p>
</div>
<div class="section" id="production-server">
<span id="production"></span><h3>6.5.2.2. Production server<a class="headerlink" href="#production-server" title="Permalink to this headline">¶</a></h3>
<p>Both <a class="reference external" href="http://apache.org">Apache</a> and <a class="reference external" href="http://nginx.org">nginx</a> can be used
to serve App Framework in a dedicated server environment.  Example configurations
for each type of service are included in the <tt class="docutils literal"><span class="pre">example-configs</span></tt> folder:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">example-configs/apache2.conf</span></tt> - example for Apache2 virtual server</li>
<li><tt class="docutils literal"><span class="pre">example-configs/nginx.conf</span></tt> - example for nginx server</li>
</ul>
<p>The Apache configuration assumes that <tt class="docutils literal"><span class="pre">mod_wsgi</span></tt> is enabled for use, more
details on configuration under this approach can be found within the
<a class="reference external" href="https://code.google.com/p/modwsgi/wiki/InstallationInstructions">mod_wsgi documentation</a>.</p>
<p>The nginx configuration primarily provides static media delivery and routes
requests to a WSGI server such as <a class="reference external" href="gunicorn.org">gunicorn</a>.  gunicorn&#8217;s
<a class="reference external" href="http://gunicorn.org/#deployment">deployment page</a> has more detailed guidelines
that may be helpful.</p>
<div class="section" id="enabling-https">
<h4>6.5.2.2.1. Enabling HTTPS<a class="headerlink" href="#enabling-https" title="Permalink to this headline">¶</a></h4>
<p>The example configs setup a server using unencrypted HTTP, which is usually
fine for development purposes.  For deployed instances, HTTPS would be a more
appropriate choice.  The Apache example config includes a commented out section
for setting up an HTTPS virtual server in place of default HTTP.</p>
<p>In addition to the config setup, a certificate will need to be installed in the
server.  A self-signed cert can be used in most cases, or a company cert
could be installed as well.  Check with your local IT department on what
procedures are appropriate for securing and signing your server.</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/rb-ss-logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="overview.html">SteelScript Application Framework</a></h3>
  <ul>
<li><a class="reference internal" href="#">6.5. Managing the server</a><ul>
<li><a class="reference internal" href="#maintenance-rebuilding">6.5.1. Maintenance / Rebuilding</a><ul>
<li><a class="reference internal" href="#collecting-reports">6.5.1.1. Collecting Reports</a></li>
<li><a class="reference internal" href="#reloading-reports">6.5.1.2. Reloading Reports</a></li>
<li><a class="reference internal" href="#collecting-logs">6.5.1.3. Collecting Logs</a></li>
<li><a class="reference internal" href="#resetting-app-framework-database">6.5.1.4. Resetting App Framework Database</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-server">6.5.2. Running the server</a><ul>
<li><a class="reference internal" href="#development-server">6.5.2.1. Development server</a></li>
<li><a class="reference internal" href="#production-server">6.5.2.2. Production server</a><ul>
<li><a class="reference internal" href="#enabling-https">6.5.2.2.1. Enabling HTTPS</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/appfwk/managing.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script><h3>
<a href="../license.html">License</a>
</h3>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">steelscript  documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014 Riverbed Technology, Inc..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>