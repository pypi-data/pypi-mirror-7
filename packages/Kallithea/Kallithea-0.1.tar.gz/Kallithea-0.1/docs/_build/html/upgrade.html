<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <title>Upgrade &mdash; Kallithea 0 documentation</title>

    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Kallithea 0 documentation" href="index.html" />
    <link rel="next" title="General Kallithea usage" href="usage/general.html" />
    <link rel="prev" title="Setup" href="setup.html" />
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="usage/general.html" title="General Kallithea usage"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="setup.html" title="Setup"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Kallithea 0 documentation</a> &raquo;</li>
      </ul>
    </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">

  <div class="section" id="upgrade">
<span id="id1"></span><h1>Upgrade<a class="headerlink" href="#upgrade" title="Permalink to this headline">¶</a></h1>
<div class="section" id="upgrading-from-pypi-aka-cheeseshop">
<h2>Upgrading from PyPI (aka &#8220;Cheeseshop&#8221;)<a class="headerlink" href="#upgrading-from-pypi-aka-cheeseshop" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Firstly, it is recommended that you <strong>always</strong> perform a database and
configuration backup before doing an upgrade.</p>
<p class="last">(These directions will use &#8216;{version}&#8217; to note that this is the version of
Kallithea that these files were used with.  If backing up your Kallithea
instance from version 1.3.6 to 1.4.0, the <tt class="docutils literal"><span class="pre">production.ini</span></tt> file would be
backed up to <tt class="docutils literal"><span class="pre">production.ini.1-3-6</span></tt>.)</p>
</div>
<p>If using a sqlite database, stop the Kallithea process/daemon/service, and
then make a copy of the database file:</p>
<div class="highlight-python"><div class="highlight"><pre>service kallithea stop
cp kallithea.db kallithea.db.{version}
</pre></div>
</div>
<p>Back up your configuration file:</p>
<div class="highlight-python"><div class="highlight"><pre>cp production.ini production.ini.{version}
</pre></div>
</div>
<p>Ensure that you are using the Python Virtual Environment that you&#8217;d originally
installed Kallithea in:</p>
<div class="highlight-python"><div class="highlight"><pre>pip freeze
</pre></div>
</div>
<p>will list all packages installed in the current environment.  If Kallithea
isn&#8217;t listed, change virtual environments to your venv location:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">source</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">kallithea</span><span class="o">-</span><span class="n">venv</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
</pre></div>
</div>
<p>Once you have verified the environment you can upgrade <tt class="docutils literal"><span class="pre">Kallithea</span></tt> with:</p>
<div class="highlight-python"><div class="highlight"><pre>easy_install -U kallithea
</pre></div>
</div>
<p>Or:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install --upgrade kallithea
</pre></div>
</div>
<p>Then run the following command from the installation directory:</p>
<div class="highlight-python"><div class="highlight"><pre>paster make-config Kallithea production.ini
</pre></div>
</div>
<p>This will display any changes made by the new version of Kallithea to your
current configuration. It will try to perform an automerge. It&#8217;s recommended
that you re-check the content after the automerge.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please always make sure your .ini files are up to date. Often errors are
caused by missing params added in new versions.</p>
</div>
<p>It is also recommended that you rebuild the whoosh index after upgrading since
the new whoosh version could introduce some incompatible index changes. Please
Read the changelog to see if there were any changes to whoosh.</p>
<p>The final step is to upgrade the database. To do this simply run:</p>
<div class="highlight-python"><div class="highlight"><pre>paster upgrade-db production.ini
</pre></div>
</div>
<p>This will upgrade the schema and update some of the defaults in the database,
and will always recheck the settings of the application, if there are no new
options that need to be set.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">DB schema upgrade library has some limitations and can sometimes fail if you try to
upgrade from older major releases. In such case simply run upgrades sequentially, eg.
upgrading from 1.2.X to 1.5.X should be done like that: 1.2.X. &gt; 1.3.X &gt; 1.4.X &gt; 1.5.X
You can always specify what version of Kallithea you want to install for example in pip
<cite>pip install Kallithea==1.3.6</cite></p>
</div>
<p>You may find it helpful to clear out your log file so that new errors are
readily apparent:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">echo</span> <span class="o">&gt;</span> <span class="n">kallithea</span><span class="o">.</span><span class="n">log</span>
</pre></div>
</div>
<p>Once that is complete, you may now start your upgraded Kallithea Instance:</p>
<div class="highlight-python"><div class="highlight"><pre>service kallithea start
</pre></div>
</div>
<p>Or:</p>
<div class="highlight-python"><div class="highlight"><pre>paster serve /var/www/kallithea/production.ini
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you&#8217;re using Celery, make sure you restart all instances of it after
upgrade.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<h3>Support Kallithea development</h3>
<div style="text-align:center">
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="EYXFS3SQPHYUL">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>
    <div style="padding:5px">
     <a href="https://flattr.com/thing/922714/Donate-to-Software-Freedom-Conservancy" target="_blank">
     <img src="http://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this" border="0" /></a>
    </div>
</div>

  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Upgrade</a><ul>
<li><a class="reference internal" href="#upgrading-from-pypi-aka-cheeseshop">Upgrading from PyPI (aka &#8220;Cheeseshop&#8221;)</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="setup.html"
                        title="previous chapter">Setup</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="usage/general.html"
                        title="next chapter">General Kallithea usage</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/upgrade.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="usage/general.html" title="General Kallithea usage"
             >next</a> |</li>
        <li class="right" >
          <a href="setup.html" title="Setup"
             >previous</a> |</li>
        <li><a href="index.html">Kallithea 0 documentation</a> &raquo;</li>
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2010-2014 by various authors, licensed as GPLv3..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>