from osiris.appconst import ACCESS_TOKEN_LENGTH, ALLOWED_CHARACTERS
from random import choice


def generate_token(length=ACCESS_TOKEN_LENGTH, allowed_chars=ALLOWED_CHARACTERS):
    # We assume that the token will be enough random, otherwise we need
    # to make sure the generated token doesn't exists previously in DB
    return ''.join([choice(allowed_chars) for i in range(length)])
