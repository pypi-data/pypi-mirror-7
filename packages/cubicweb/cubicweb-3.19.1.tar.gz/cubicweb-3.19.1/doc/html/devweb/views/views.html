
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Principles &mdash; CubicWeb 3.18.3</title>
    
    <link rel="stylesheet" href="../../_static/lglb-sphinx-doc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '3.18.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="CubicWeb 3.18.3" href="../../index.html" />
    <link rel="up" title="The View system" href="index.html" />
    <link rel="next" title="Templates" href="basetemplates.html" />
    <link rel="prev" title="The View system" href="index.html" /> 
  </head>
  <body>
<div class="header">
 <a href="http://www.cubicweb.org">
  <img alt="cubicweb logo" src="../../_static/cubicweb.png"/>
 </a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="basetemplates.html" title="Templates"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="The View system"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">CubicWeb 3.18.3</a> &raquo;</li>
          <li><a href="../index.html" >Web side development</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">The View system</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Principles</a><ul>
<li><a class="reference internal" href="#discovering-possible-views">Discovering possible views</a></li>
<li><a class="reference internal" href="#basic-class-for-views">Basic class for views</a><ul>
<li><a class="reference internal" href="#class-view">Class <tt class="docutils literal"><span class="pre">View</span></tt></a></li>
<li><a class="reference internal" href="#other-basic-view-classes">Other basic view classes</a></li>
<li><a class="reference internal" href="#examples-of-views-class">Examples of views class</a></li>
</ul>
</li>
<li><a class="reference internal" href="#xml-views-binaries-views">XML views, binaries views...</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">The View system</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="basetemplates.html"
                        title="next chapter">Templates</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/devweb/views/views.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="principles">
<span id="views"></span><h1>Principles<a class="headerlink" href="#principles" title="Permalink to this headline">¶</a></h1>
<p>We&#8217;ll start with a description of the interface providing a basic
understanding of the available classes and methods, then detail the
view selection principle.</p>
<p>A <cite>View</cite> is an object responsible for the rendering of data from the
model into an end-user consummable form. They typically churn out an
XHTML stream, but there are views concerned with email other non-html
outputs.</p>
<div class="section" id="discovering-possible-views">
<span id="views-base-class"></span><h2>Discovering possible views<a class="headerlink" href="#discovering-possible-views" title="Permalink to this headline">¶</a></h2>
<p>It is possible to configure the web user interface to have a left box
showing all the views than can be applied to the current result set.</p>
<p>To enable this, click on your login at the top right corner. Chose
&#8220;user preferences&#8221;, then &#8220;boxes&#8221;, then &#8220;possible views box&#8221; and check
&#8220;visible = yes&#8221; before validating your changes.</p>
<p>The views listed there we either not selected because of a lower
score, or they were deliberately excluded by the main template logic.</p>
</div>
<div class="section" id="basic-class-for-views">
<h2>Basic class for views<a class="headerlink" href="#basic-class-for-views" title="Permalink to this headline">¶</a></h2>
<div class="section" id="class-view">
<h3>Class <a class="reference internal" href="#cubicweb.view.View" title="cubicweb.view.View"><tt class="xref py py-class docutils literal"><span class="pre">View</span></tt></a><a class="headerlink" href="#class-view" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="cubicweb.view.View">
<em class="property">class </em><tt class="descclassname">cubicweb.view.</tt><tt class="descname">View</tt><big>(</big><em>req=None</em>, <em>rset=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.view.View" title="Permalink to this definition">¶</a></dt>
<dd><p>This class is an abstraction of a view class, used as a base class for
every renderable object such as views, templates and other user interface
components.</p>
<p>A <cite>View</cite> is instantiated to render a result set or part of a result
set. <cite>View</cite> subclasses may be parametrized using the following class
attributes:</p>
<dl class="docutils">
<dt><tt class="xref py py-attr docutils literal"><span class="pre">templatable</span></tt> indicates if the view may be embedded in a main</dt>
<dd>template or if it has to be rendered standalone (i.e. pure XML views must
not be embedded in the main template of HTML pages)</dd>
<dt><tt class="xref py py-attr docutils literal"><span class="pre">content_type</span></tt> if the view is not templatable, it should set the</dt>
<dd><cite>content_type</cite> class attribute to the correct MIME type (text/xhtml being
the default)</dd>
<dt><tt class="xref py py-attr docutils literal"><span class="pre">category</span></tt> this attribute may be used in the interface to regroup</dt>
<dd>related objects (view kinds) together</dd>
</dl>
<p><tt class="xref py py-attr docutils literal"><span class="pre">paginable</span></tt></p>
<p><tt class="xref py py-attr docutils literal"><span class="pre">binary</span></tt></p>
<p>A view writes to its output stream thanks to its attribute <cite>w</cite> (the
append method of an <cite>UStreamIO</cite>, except for binary views).</p>
<p>At instantiation time, the standard <cite>_cw</cite>, and <cite>cw_rset</cite> attributes are
added and the <cite>w</cite> attribute will be set at rendering time to a write
function to use.</p>
</dd></dl>

<p>The basic interface for views is as follows (remember that the result
set has a tabular structure with rows and columns, hence cells):</p>
<ul class="simple">
<li><cite>render(**context)</cite>, render the view by calling <cite>call</cite> or
<cite>cell_call</cite> depending on the context</li>
<li><cite>call(**kwargs)</cite>, call the view for a complete result set or null
(the default implementation calls <cite>cell_call()</cite> on each cell of the
result set)</li>
<li><cite>cell_call(row, col, **kwargs)</cite>, call the view for a given cell of a
result set (<cite>row</cite> and <cite>col</cite> being integers used to access the cell)</li>
<li><cite>url()</cite>, returns the URL enabling us to get the view with the current
result set</li>
<li><cite>wview(__vid, rset, __fallback_vid=None, **kwargs)</cite>, call the view of
identifier <cite>__vid</cite> on the given result set. It is possible to give a
fallback view identifier that will be used if the requested view is
not applicable to the result set.</li>
<li><cite>html_headers()</cite>, returns a list of HTML headers to be set by the
main template</li>
<li><cite>page_title()</cite>, returns the title to use in the HTML header <cite>title</cite></li>
</ul>
</div>
<div class="section" id="other-basic-view-classes">
<h3>Other basic view classes<a class="headerlink" href="#other-basic-view-classes" title="Permalink to this headline">¶</a></h3>
<p>Here are some of the subclasses of <a class="reference internal" href="#cubicweb.view.View" title="cubicweb.view.View"><tt class="xref py py-class docutils literal"><span class="pre">View</span></tt></a> defined in <tt class="xref py py-mod docutils literal"><span class="pre">cubicweb.view</span></tt>
that are more concrete as they relate to data rendering within the application:</p>
<dl class="class">
<dt id="cubicweb.view.EntityView">
<em class="property">class </em><tt class="descclassname">cubicweb.view.</tt><tt class="descname">EntityView</tt><big>(</big><em>req=None</em>, <em>rset=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.view.EntityView" title="Permalink to this definition">¶</a></dt>
<dd><p>base class for views applying on an entity (i.e. uniform result set)</p>
</dd></dl>

<dl class="class">
<dt id="cubicweb.view.StartupView">
<em class="property">class </em><tt class="descclassname">cubicweb.view.</tt><tt class="descname">StartupView</tt><big>(</big><em>req=None</em>, <em>rset=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.view.StartupView" title="Permalink to this definition">¶</a></dt>
<dd><p>base class for views which doesn&#8217;t need a particular result set to be
displayed (so they can always be displayed!)</p>
</dd></dl>

<dl class="class">
<dt id="cubicweb.view.EntityStartupView">
<em class="property">class </em><tt class="descclassname">cubicweb.view.</tt><tt class="descname">EntityStartupView</tt><big>(</big><em>req</em>, <em>rset=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.view.EntityStartupView" title="Permalink to this definition">¶</a></dt>
<dd><p>base class for entity views which may also be applied to None
result set (usually a default rql is provided by the view class)</p>
</dd></dl>

<dl class="class">
<dt id="cubicweb.view.AnyRsetView">
<em class="property">class </em><tt class="descclassname">cubicweb.view.</tt><tt class="descname">AnyRsetView</tt><big>(</big><em>req=None</em>, <em>rset=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.view.AnyRsetView" title="Permalink to this definition">¶</a></dt>
<dd><p>base class for views applying on any non empty result sets</p>
</dd></dl>

</div>
<div class="section" id="examples-of-views-class">
<h3>Examples of views class<a class="headerlink" href="#examples-of-views-class" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Using <cite>templatable</cite>, <cite>content_type</cite> and HTTP cache configuration</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">RSSView</span><span class="p">(</span><span class="n">XMLView</span><span class="p">):</span>
    <span class="n">__regid__</span> <span class="o">=</span> <span class="s">&#39;rss&#39;</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;rss&#39;</span><span class="p">)</span>
    <span class="n">templatable</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="n">content_type</span> <span class="o">=</span> <span class="s">&#39;text/xml&#39;</span>
    <span class="n">http_cache_manager</span> <span class="o">=</span> <span class="n">MaxAgeHTTPCacheManager</span>
    <span class="n">cache_max_age</span> <span class="o">=</span> <span class="mi">60</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">2</span> <span class="c"># stay in http cache for 2 hours by default</span>
</pre></div>
</div>
<ul class="simple">
<li>Using a custom selector</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">SearchForAssociationView</span><span class="p">(</span><span class="n">EntityView</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;view called by the edition view when the user asks</span>
<span class="sd">    to search for something to link to the edited eid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">__regid__</span> <span class="o">=</span> <span class="s">&#39;search-associate&#39;</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;search for association&#39;</span><span class="p">)</span>
    <span class="n">__select__</span> <span class="o">=</span> <span class="n">one_line_rset</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">match_search_state</span><span class="p">(</span><span class="s">&#39;linksearch&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">is_instance</span><span class="p">(</span><span class="s">&#39;Any&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="xml-views-binaries-views">
<h2>XML views, binaries views...<a class="headerlink" href="#xml-views-binaries-views" title="Permalink to this headline">¶</a></h2>
<p>For views generating other formats than HTML (an image generated dynamically
for example), and which can not simply be included in the HTML page generated
by the main template (see above), you have to:</p>
<ul class="simple">
<li>set the attribute <cite>templatable</cite> of the class to <cite>False</cite></li>
<li>set, through the attribute <cite>content_type</cite> of the class, the MIME
type generated by the view to <cite>application/octet-stream</cite> or any
relevant and more specialised mime type</li>
</ul>
<p>For views dedicated to binary content creation (like dynamically generated
images), we have to set the attribute <cite>binary</cite> of the class to <cite>True</cite> (which
implies that <cite>templatable == False</cite>, so that the attribute <cite>w</cite> of the view could be
replaced by a binary flow instead of unicode).</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="basetemplates.html" title="Templates"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="The View system"
             >previous</a> |</li>
        <li><a href="../../index.html">CubicWeb 3.18.3</a> &raquo;</li>
          <li><a href="../index.html" >Web side development</a> &raquo;</li>
          <li><a href="index.html" >The View system</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2014, Logilab.
      Last updated on Mar 11, 2014.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>