
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The facets system &mdash; CubicWeb 3.18.3</title>
    
    <link rel="stylesheet" href="../_static/lglb-sphinx-doc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.18.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="CubicWeb 3.18.3" href="../index.html" />
    <link rel="up" title="Web side development" href="index.html" />
    <link rel="next" title="Internationalization" href="internationalization.html" />
    <link rel="prev" title="Examples" href="edition/examples.html" /> 
  </head>
  <body>
<div class="header">
 <a href="http://www.cubicweb.org">
  <img alt="cubicweb logo" src="../_static/cubicweb.png"/>
 </a>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="internationalization.html" title="Internationalization"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="edition/examples.html" title="Examples"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">CubicWeb 3.18.3</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Web side development</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The facets system</a><ul>
<li><a class="reference internal" href="#module-cubicweb.web.facet">Base classes for facets</a><ul>
<li><a class="reference internal" href="#classes-you-ll-want-to-use">Classes you&#8217;ll want to use</a></li>
<li><a class="reference internal" href="#classes-for-facets-implementor">Classes for facets implementor</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="edition/examples.html"
                        title="previous chapter">Examples</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="internationalization.html"
                        title="next chapter">Internationalization</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/devweb/facets.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="the-facets-system">
<h1>The facets system<a class="headerlink" href="#the-facets-system" title="Permalink to this headline">¶</a></h1>
<p>Facets allow to restrict searches according to some user friendly criterias.
CubicWeb has a builtin <a class="reference external" href="http://en.wikipedia.org/wiki/Faceted_browser">facet</a> system to define restrictions <a class="reference external" href="http://www.cubicweb.org/blogentry/154152">filters</a> really
as easily as possible.</p>
<p>Here is an exemple of the facets rendering picked from our
<a class="reference external" href="http://www.cubicweb.org">http://www.cubicweb.org</a> web site:</p>
<img alt="../_images/facet_overview.png" src="../_images/facet_overview.png" />
<p>Facets will appear on each page presenting more than one entity that may be
filtered according to some known criteria.</p>
<div class="section" id="module-cubicweb.web.facet">
<span id="base-classes-for-facets"></span><h2>Base classes for facets<a class="headerlink" href="#module-cubicweb.web.facet" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#module-cubicweb.web.facet" title="cubicweb.web.facet"><tt class="xref py py-mod docutils literal"><span class="pre">cubicweb.web.facet</span></tt></a> module contains a set of abstract classes to use
as bases to build your own facets</p>
<p>All facet classes inherits from the <a class="reference internal" href="#cubicweb.web.facet.AbstractFacet" title="cubicweb.web.facet.AbstractFacet"><tt class="xref py py-class docutils literal"><span class="pre">AbstractFacet</span></tt></a> class, though you&#8217;ll
usually find some more handy class that do what you want.</p>
<p>Let&#8217;s see available classes.</p>
<div class="section" id="classes-you-ll-want-to-use">
<h3>Classes you&#8217;ll want to use<a class="headerlink" href="#classes-you-ll-want-to-use" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="cubicweb.web.facet.RelationFacet">
<em class="property">class </em><tt class="descclassname">cubicweb.web.facet.</tt><tt class="descname">RelationFacet</tt><big>(</big><em>req</em>, <em>select=None</em>, <em>filtered_variable=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.RelationFacet" title="Permalink to this definition">¶</a></dt>
<dd><p>Base facet to filter some entities according to other entities to which
they are related. Create concrete facet by inheriting from this class an then
configuring it by setting class attribute described below.</p>
<p>The relation is defined by the <cite>rtype</cite> and <cite>role</cite> attributes.</p>
<p>The <cite>no_relation</cite> boolean flag tells if a special &#8216;no relation&#8217; value should be
added (allowing to filter on entities which <em>do not</em> have the relation set).
Default is computed according the relation&#8217;s cardinality.</p>
<p>The values displayed for related entities will be:</p>
<ul class="simple">
<li>result of calling their <cite>label_vid</cite> view if specified</li>
<li>else their <cite>target_attr</cite> attribute value if specified</li>
<li>else their eid (you usually want something nicer...)</li>
</ul>
<p>When no <cite>label_vid</cite> is set, you will get translated value if <cite>i18nable</cite> is
set. By default, <cite>i18nable</cite> will be set according to the schema, but you can
force its value by setting it has a class attribute.</p>
<p>You can filter out target entity types by specifying <cite>target_type</cite>.</p>
<p>By default, vocabulary will be displayed sorted on <cite>target_attr</cite> value in an
ascending way. You can control sorting with:</p>
<ul class="simple">
<li><cite>sortfunc</cite>: set this to a stored procedure name if you want to sort on the
result of this function&#8217;s result instead of direct value</li>
<li><cite>sortasc</cite>: boolean flag to control ascendant/descendant sorting</li>
</ul>
<p>To illustrate this facet, let&#8217;s take for example an <em>excerpt</em> of the schema
of an office location search application:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Office</span><span class="p">(</span><span class="n">WorkflowableEntityType</span><span class="p">):</span>
    <span class="n">price</span> <span class="o">=</span> <span class="n">Int</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">&#39;euros / m2 / HC / HT&#39;</span><span class="p">)</span>
    <span class="n">surface</span> <span class="o">=</span> <span class="n">Int</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s">&#39;m2&#39;</span><span class="p">)</span>
    <span class="n">has_address</span> <span class="o">=</span> <span class="n">SubjectRelation</span><span class="p">(</span><span class="s">&#39;PostalAddress&#39;</span><span class="p">,</span>
                                  <span class="n">cardinality</span><span class="o">=</span><span class="s">&#39;1?&#39;</span><span class="p">,</span>
                                  <span class="n">composite</span><span class="o">=</span><span class="s">&#39;subject&#39;</span><span class="p">)</span>
    <span class="n">proposed_by</span> <span class="o">=</span> <span class="n">SubjectRelation</span><span class="p">(</span><span class="s">&#39;Agency&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can simply define a facet to filter offices according to the agency
proposing it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AgencyFacet</span><span class="p">(</span><span class="n">RelationFacet</span><span class="p">):</span>
    <span class="n">__regid__</span> <span class="o">=</span> <span class="s">&#39;agency&#39;</span>
    <span class="c"># this facet should only be selected when visualizing offices</span>
    <span class="n">__select__</span> <span class="o">=</span> <span class="n">RelationFacet</span><span class="o">.</span><span class="n">__select__</span> <span class="o">&amp;</span> <span class="n">is_instance</span><span class="p">(</span><span class="s">&#39;Office&#39;</span><span class="p">)</span>
    <span class="c"># this facet is a filter on the &#39;Agency&#39; entities linked to the office</span>
    <span class="c"># through the &#39;proposed_by&#39; relation, where the office is the subject</span>
    <span class="c"># of the relation</span>
    <span class="n">rtype</span> <span class="o">=</span> <span class="s">&#39;has_address&#39;</span>
    <span class="c"># &#39;subject&#39; is the default but setting it explicitly doesn&#39;t hurt...</span>
    <span class="n">role</span> <span class="o">=</span> <span class="s">&#39;subject&#39;</span>
    <span class="c"># we want to display the agency&#39;s name</span>
    <span class="n">target_attr</span> <span class="o">=</span> <span class="s">&#39;name&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="cubicweb.web.facet.RelationAttributeFacet">
<em class="property">class </em><tt class="descclassname">cubicweb.web.facet.</tt><tt class="descname">RelationAttributeFacet</tt><big>(</big><em>req</em>, <em>select=None</em>, <em>filtered_variable=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.RelationAttributeFacet" title="Permalink to this definition">¶</a></dt>
<dd><p>Base facet to filter some entities according to an attribute of other
entities to which they are related. Most things work similarly as
<a class="reference internal" href="#cubicweb.web.facet.RelationFacet" title="cubicweb.web.facet.RelationFacet"><tt class="xref py py-class docutils literal"><span class="pre">RelationFacet</span></tt></a>, except that:</p>
<ul class="simple">
<li><cite>label_vid</cite> doesn&#8217;t make sense here</li>
<li>you should specify the attribute type using <cite>target_attr_type</cite> if it&#8217;s not a
String</li>
<li>you can specify a comparison operator using <cite>comparator</cite></li>
</ul>
<p>Back to our example... if you want to search office by postal code and that
you use a <a class="reference internal" href="#cubicweb.web.facet.RelationFacet" title="cubicweb.web.facet.RelationFacet"><tt class="xref py py-class docutils literal"><span class="pre">RelationFacet</span></tt></a> for that, you won&#8217;t get the expected
behaviour: if two offices have the same postal code, they&#8217;ve however two
different addresses.  So you&#8217;ll see in the facet the same postal code twice,
though linked to a different address entity. There is a great chance your
users won&#8217;t understand that...</p>
<p>That&#8217;s where this class come in! It&#8217;s used to said that you want to filter
according to the <em>attribute value</em> of a relatied entity, not to the entity
itself. Now here is the source code for the facet:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">PostalCodeFacet</span><span class="p">(</span><span class="n">RelationAttributeFacet</span><span class="p">):</span>
    <span class="n">__regid__</span> <span class="o">=</span> <span class="s">&#39;postalcode&#39;</span>
    <span class="c"># this facet should only be selected when visualizing offices</span>
    <span class="n">__select__</span> <span class="o">=</span> <span class="n">RelationAttributeFacet</span><span class="o">.</span><span class="n">__select__</span> <span class="o">&amp;</span> <span class="n">is_instance</span><span class="p">(</span><span class="s">&#39;Office&#39;</span><span class="p">)</span>
    <span class="c"># this facet is a filter on the PostalAddress entities linked to the</span>
    <span class="c"># office through the &#39;has_address&#39; relation, where the office is the</span>
    <span class="c"># subject of the relation</span>
    <span class="n">rtype</span> <span class="o">=</span> <span class="s">&#39;has_address&#39;</span>
    <span class="n">role</span> <span class="o">=</span> <span class="s">&#39;subject&#39;</span>
    <span class="c"># we want to search according to address &#39;postal_code&#39; attribute</span>
    <span class="n">target_attr</span> <span class="o">=</span> <span class="s">&#39;postalcode&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="cubicweb.web.facet.HasRelationFacet">
<em class="property">class </em><tt class="descclassname">cubicweb.web.facet.</tt><tt class="descname">HasRelationFacet</tt><big>(</big><em>req</em>, <em>select=None</em>, <em>filtered_variable=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.HasRelationFacet" title="Permalink to this definition">¶</a></dt>
<dd><p>This class simply filter according to the presence of a relation
(whatever the entity at the other end). It display a simple checkbox that
lets you refine your selection in order to get only entities that actually
have this relation. You simply have to define which relation using the
<cite>rtype</cite> and <cite>role</cite> attributes.</p>
<p>Here is an example of the rendering of thos facet to filter book with image
and the corresponding code:</p>
<img alt="../_images/facet_has_image.png" src="../_images/facet_has_image.png" />
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">HasImageFacet</span><span class="p">(</span><span class="n">HasRelationFacet</span><span class="p">):</span>
    <span class="n">__regid__</span> <span class="o">=</span> <span class="s">&#39;hasimage&#39;</span>
    <span class="n">__select__</span> <span class="o">=</span> <span class="n">HasRelationFacet</span><span class="o">.</span><span class="n">__select__</span> <span class="o">&amp;</span> <span class="n">is_instance</span><span class="p">(</span><span class="s">&#39;Book&#39;</span><span class="p">)</span>
    <span class="n">rtype</span> <span class="o">=</span> <span class="s">&#39;has_image&#39;</span>
    <span class="n">role</span> <span class="o">=</span> <span class="s">&#39;subject&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="cubicweb.web.facet.AttributeFacet">
<em class="property">class </em><tt class="descclassname">cubicweb.web.facet.</tt><tt class="descname">AttributeFacet</tt><big>(</big><em>req</em>, <em>select=None</em>, <em>filtered_variable=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.AttributeFacet" title="Permalink to this definition">¶</a></dt>
<dd><p>Base facet to filter some entities according one of their attribute.
Configuration is mostly similarly as <a class="reference internal" href="#cubicweb.web.facet.RelationAttributeFacet" title="cubicweb.web.facet.RelationAttributeFacet"><tt class="xref py py-class docutils literal"><span class="pre">RelationAttributeFacet</span></tt></a>, except that:</p>
<ul class="simple">
<li><cite>target_attr</cite> doesn&#8217;t make sense here (you specify the attribute using <cite>rtype</cite></li>
<li><cite>role</cite> neither, it&#8217;s systematically &#8216;subject&#8217;</li>
</ul>
<p>So, suppose that in our office search example you want to refine search according
to the office&#8217;s surface. Here is a code snippet achieving this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">SurfaceFacet</span><span class="p">(</span><span class="n">AttributeFacet</span><span class="p">):</span>
    <span class="n">__regid__</span> <span class="o">=</span> <span class="s">&#39;surface&#39;</span>
    <span class="n">__select__</span> <span class="o">=</span> <span class="n">AttributeFacet</span><span class="o">.</span><span class="n">__select__</span> <span class="o">&amp;</span> <span class="n">is_instance</span><span class="p">(</span><span class="s">&#39;Office&#39;</span><span class="p">)</span>
    <span class="c"># this facet is a filter on the office&#39;surface</span>
    <span class="n">rtype</span> <span class="o">=</span> <span class="s">&#39;surface&#39;</span>
    <span class="c"># override the default value of operator since we want to filter</span>
    <span class="c"># according to a minimal value, not an exact one</span>
    <span class="n">comparator</span> <span class="o">=</span> <span class="s">&#39;&gt;=&#39;</span>

    <span class="k">def</span> <span class="nf">vocabulary</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;override the default vocabulary method since we want to</span>
<span class="sd">        hard-code our threshold values.</span>

<span class="sd">        Not overriding would generate a filter containing all existing</span>
<span class="sd">        surfaces defined in the database.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="p">[(</span><span class="s">&#39;&gt; 200&#39;</span><span class="p">,</span> <span class="s">&#39;200&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;&gt; 250&#39;</span><span class="p">,</span> <span class="s">&#39;250&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&#39;&gt; 275&#39;</span><span class="p">,</span> <span class="s">&#39;275&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;&gt; 300&#39;</span><span class="p">,</span> <span class="s">&#39;300&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="cubicweb.web.facet.RQLPathFacet">
<em class="property">class </em><tt class="descclassname">cubicweb.web.facet.</tt><tt class="descname">RQLPathFacet</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.RQLPathFacet" title="Permalink to this definition">¶</a></dt>
<dd><p>Base facet to filter some entities according to an arbitrary rql
path. Path should be specified as a list of 3-uples or triplet string, where
&#8216;X&#8217; represent the filtered variable. You should specify using
<cite>filter_variable</cite> the snippet variable that will be used to filter out
results. You may also specify a <cite>label_variable</cite>. If you want to filter on
an attribute value, you usually don&#8217;t want to specify the later since it&#8217;s
the same as the filter variable, though you may have to specify the attribute
type using <cite>restr_attr_type</cite> if there are some type ambiguity in the schema
for the attribute.</p>
<p>Using this facet, we can rewrite facets we defined previously:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AgencyFacet</span><span class="p">(</span><span class="n">RQLPathFacet</span><span class="p">):</span>
    <span class="n">__regid__</span> <span class="o">=</span> <span class="s">&#39;agency&#39;</span>
    <span class="c"># this facet should only be selected when visualizing offices</span>
    <span class="n">__select__</span> <span class="o">=</span> <span class="n">is_instance</span><span class="p">(</span><span class="s">&#39;Office&#39;</span><span class="p">)</span>
    <span class="c"># this facet is a filter on the &#39;Agency&#39; entities linked to the office</span>
    <span class="c"># through the &#39;proposed_by&#39; relation, where the office is the subject</span>
    <span class="c"># of the relation</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;X has_address O&#39;</span><span class="p">,</span> <span class="s">&#39;O name N&#39;</span><span class="p">]</span>
    <span class="n">filter_variable</span> <span class="o">=</span> <span class="s">&#39;O&#39;</span>
    <span class="n">label_variable</span> <span class="o">=</span> <span class="s">&#39;N&#39;</span>

<span class="k">class</span> <span class="nc">PostalCodeFacet</span><span class="p">(</span><span class="n">RQLPathFacet</span><span class="p">):</span>
    <span class="n">__regid__</span> <span class="o">=</span> <span class="s">&#39;postalcode&#39;</span>
    <span class="c"># this facet should only be selected when visualizing offices</span>
    <span class="n">__select__</span> <span class="o">=</span> <span class="n">is_instance</span><span class="p">(</span><span class="s">&#39;Office&#39;</span><span class="p">)</span>
    <span class="c"># this facet is a filter on the PostalAddress entities linked to the</span>
    <span class="c"># office through the &#39;has_address&#39; relation, where the office is the</span>
    <span class="c"># subject of the relation</span>
    <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;X has_address O&#39;</span><span class="p">,</span> <span class="s">&#39;O postal_code PC&#39;</span><span class="p">]</span>
    <span class="n">filter_variable</span> <span class="o">=</span> <span class="s">&#39;PC&#39;</span>
</pre></div>
</div>
<p>Though some features, such as &#8216;no value&#8217; or automatic internationalization,
won&#8217;t work. This facet class is designed to be used for cases where
<a class="reference internal" href="#cubicweb.web.facet.RelationFacet" title="cubicweb.web.facet.RelationFacet"><tt class="xref py py-class docutils literal"><span class="pre">RelationFacet</span></tt></a> or <a class="reference internal" href="#cubicweb.web.facet.RelationAttributeFacet" title="cubicweb.web.facet.RelationAttributeFacet"><tt class="xref py py-class docutils literal"><span class="pre">RelationAttributeFacet</span></tt></a> can&#8217;t do the trick
(e.g when you want to filter on entities where are not directly linked to
the filtered entities).</p>
</dd></dl>

<dl class="class">
<dt id="cubicweb.web.facet.RangeFacet">
<em class="property">class </em><tt class="descclassname">cubicweb.web.facet.</tt><tt class="descname">RangeFacet</tt><big>(</big><em>req</em>, <em>select=None</em>, <em>filtered_variable=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.RangeFacet" title="Permalink to this definition">¶</a></dt>
<dd><p>This class allows to filter entities according to an attribute of
numerical type.</p>
<p>It displays a slider using <a class="reference external" href="http://www.jqueryui.com/">jquery</a> to choose a lower bound and an upper
bound.</p>
<p>The example below provides an alternative to the surface facet seen earlier,
in a more powerful way since</p>
<ul class="simple">
<li>lower/upper boundaries are computed according to entities to filter</li>
<li>user can specify lower/upper boundaries, not only the lower one</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">SurfaceFacet</span><span class="p">(</span><span class="n">RangeFacet</span><span class="p">):</span>
    <span class="n">__regid__</span> <span class="o">=</span> <span class="s">&#39;surface&#39;</span>
    <span class="n">__select__</span> <span class="o">=</span> <span class="n">RangeFacet</span><span class="o">.</span><span class="n">__select__</span> <span class="o">&amp;</span> <span class="n">is_instance</span><span class="p">(</span><span class="s">&#39;Office&#39;</span><span class="p">)</span>
    <span class="c"># this facet is a filter on the office&#39;surface</span>
    <span class="n">rtype</span> <span class="o">=</span> <span class="s">&#39;surface&#39;</span>
</pre></div>
</div>
<p>All this with even less code!</p>
<p>The image below display the rendering of the slider:</p>
<img alt="../_images/facet_range.png" src="../_images/facet_range.png" />
</dd></dl>

<dl class="class">
<dt id="cubicweb.web.facet.DateRangeFacet">
<em class="property">class </em><tt class="descclassname">cubicweb.web.facet.</tt><tt class="descname">DateRangeFacet</tt><big>(</big><em>req</em>, <em>select=None</em>, <em>filtered_variable=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.DateRangeFacet" title="Permalink to this definition">¶</a></dt>
<dd><p>This class works similarly as the <a class="reference internal" href="#cubicweb.web.facet.RangeFacet" title="cubicweb.web.facet.RangeFacet"><tt class="xref py py-class docutils literal"><span class="pre">RangeFacet</span></tt></a> but for attribute
of date type.</p>
<p>The image below display the rendering of the slider for a date range:</p>
<img alt="../_images/facet_date_range.png" src="../_images/facet_date_range.png" />
</dd></dl>

<dl class="class">
<dt id="cubicweb.web.facet.BitFieldFacet">
<em class="property">class </em><tt class="descclassname">cubicweb.web.facet.</tt><tt class="descname">BitFieldFacet</tt><big>(</big><em>req</em>, <em>select=None</em>, <em>filtered_variable=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.BitFieldFacet" title="Permalink to this definition">¶</a></dt>
<dd><p>Base facet class for Int field holding some bit values using binary
masks.</p>
<p>label / value for each bit should be given using the <tt class="xref py py-attr docutils literal"><span class="pre">choices</span></tt>
attribute.</p>
<p>See also <a class="reference internal" href="edition/form.html#cubicweb.web.formwidgets.BitSelect" title="cubicweb.web.formwidgets.BitSelect"><tt class="xref py py-class docutils literal"><span class="pre">BitSelect</span></tt></a>.</p>
</dd></dl>

<dl class="class">
<dt id="cubicweb.web.facet.AbstractRangeRQLPathFacet">
<em class="property">class </em><tt class="descclassname">cubicweb.web.facet.</tt><tt class="descname">AbstractRangeRQLPathFacet</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.AbstractRangeRQLPathFacet" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#cubicweb.web.facet.AbstractRangeRQLPathFacet" title="cubicweb.web.facet.AbstractRangeRQLPathFacet"><tt class="xref py py-class docutils literal"><span class="pre">AbstractRangeRQLPathFacet</span></tt></a> is the base class for
RQLPathFacet-type facets allowing the use of RangeWidgets-like
widgets (such as (<tt class="xref py py-class docutils literal"><span class="pre">FacetRangeWidget</span></tt>,
class:<cite>DateFacetRangeWidget</cite>) on the parent <a class="reference internal" href="#cubicweb.web.facet.RQLPathFacet" title="cubicweb.web.facet.RQLPathFacet"><tt class="xref py py-class docutils literal"><span class="pre">RQLPathFacet</span></tt></a>
target attribute.</p>
</dd></dl>

<dl class="class">
<dt id="cubicweb.web.facet.RangeRQLPathFacet">
<em class="property">class </em><tt class="descclassname">cubicweb.web.facet.</tt><tt class="descname">RangeRQLPathFacet</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.RangeRQLPathFacet" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#cubicweb.web.facet.RangeRQLPathFacet" title="cubicweb.web.facet.RangeRQLPathFacet"><tt class="xref py py-class docutils literal"><span class="pre">RangeRQLPathFacet</span></tt></a> uses the <tt class="xref py py-class docutils literal"><span class="pre">FacetRangeWidget</span></tt>
on the <a class="reference internal" href="#cubicweb.web.facet.AbstractRangeRQLPathFacet" title="cubicweb.web.facet.AbstractRangeRQLPathFacet"><tt class="xref py py-class docutils literal"><span class="pre">AbstractRangeRQLPathFacet</span></tt></a> target attribute</p>
</dd></dl>

<dl class="class">
<dt id="cubicweb.web.facet.DateRangeRQLPathFacet">
<em class="property">class </em><tt class="descclassname">cubicweb.web.facet.</tt><tt class="descname">DateRangeRQLPathFacet</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.DateRangeRQLPathFacet" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#cubicweb.web.facet.DateRangeRQLPathFacet" title="cubicweb.web.facet.DateRangeRQLPathFacet"><tt class="xref py py-class docutils literal"><span class="pre">DateRangeRQLPathFacet</span></tt></a> uses the
<tt class="xref py py-class docutils literal"><span class="pre">DateFacetRangeWidget</span></tt> on the
<a class="reference internal" href="#cubicweb.web.facet.AbstractRangeRQLPathFacet" title="cubicweb.web.facet.AbstractRangeRQLPathFacet"><tt class="xref py py-class docutils literal"><span class="pre">AbstractRangeRQLPathFacet</span></tt></a> target attribute</p>
</dd></dl>

</div>
<div class="section" id="classes-for-facets-implementor">
<h3>Classes for facets implementor<a class="headerlink" href="#classes-for-facets-implementor" title="Permalink to this headline">¶</a></h3>
<p>Unless you didn&#8217;t find the class that does the job you want above, you may want
to skip those classes...</p>
<dl class="class">
<dt id="cubicweb.web.facet.AbstractFacet">
<em class="property">class </em><tt class="descclassname">cubicweb.web.facet.</tt><tt class="descname">AbstractFacet</tt><big>(</big><em>req</em>, <em>select=None</em>, <em>filtered_variable=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.AbstractFacet" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class for all facets. Facets are stored in their own
&#8216;facets&#8217; registry. They are similar to contextual components since the use
the following configurable properties:</p>
<ul class="simple">
<li><cite>visible</cite>, boolean flag telling if a facet should be displayed or not</li>
<li><cite>order</cite>, integer to control facets display order</li>
<li><cite>context</cite>, telling if a facet should be displayed in the table form filter
(context = &#8216;tablefilter&#8217;) or in the facet box (context = &#8216;facetbox&#8217;) or in
both (context = &#8216;&#8217;)</li>
</ul>
<p>The following methods define the facet API:</p>
<dl class="method">
<dt id="cubicweb.web.facet.AbstractFacet.get_widget">
<tt class="descname">get_widget</tt><big>(</big><big>)</big><a class="headerlink" href="#cubicweb.web.facet.AbstractFacet.get_widget" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the widget instance to use to display this facet, or None if
the facet can&#8217;t do anything valuable (only one value in the vocabulary
for instance).</p>
</dd></dl>

<dl class="method">
<dt id="cubicweb.web.facet.AbstractFacet.add_rql_restrictions">
<tt class="descname">add_rql_restrictions</tt><big>(</big><big>)</big><a class="headerlink" href="#cubicweb.web.facet.AbstractFacet.add_rql_restrictions" title="Permalink to this definition">¶</a></dt>
<dd><p>When some facet criteria has been updated, this method is called to
add restriction for this facet into the rql syntax tree. It should get
back its value in form parameters, and modify the syntax tree
(<cite>self.select</cite>) accordingly.</p>
</dd></dl>

<p>Facets will have the following attributes set (beside the standard
<a class="reference internal" href="../devrepo/vreg.html#cubicweb.appobject.AppObject" title="cubicweb.appobject.AppObject"><tt class="xref py py-class docutils literal"><span class="pre">AppObject</span></tt></a> ones):</p>
<ul class="simple">
<li><cite>select</cite>, the <tt class="xref py py-class docutils literal"><span class="pre">rql.stmts.Select</span></tt> node of the rql syntax tree being
filtered</li>
<li><cite>filtered_variable</cite>, the variable node in this rql syntax tree that we&#8217;re
interested in filtering</li>
</ul>
<p>Facets implementors may also be interested in the following properties /
methods:</p>
<dl class="attribute">
<dt id="cubicweb.web.facet.AbstractFacet.operator">
<tt class="descname">operator</tt><a class="headerlink" href="#cubicweb.web.facet.AbstractFacet.operator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the operator (AND or OR) to use for this facet when multiple
values are selected.</p>
</dd></dl>

<dl class="method">
<dt id="cubicweb.web.facet.AbstractFacet.rqlexec">
<tt class="descname">rqlexec</tt><big>(</big><em>rql</em>, <em>args=None</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.AbstractFacet.rqlexec" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility method to execute some rql queries, and simply returning an
empty list if <tt class="xref py py-exc docutils literal"><span class="pre">Unauthorized</span></tt> is raised.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="cubicweb.web.facet.VocabularyFacet">
<em class="property">class </em><tt class="descclassname">cubicweb.web.facet.</tt><tt class="descname">VocabularyFacet</tt><big>(</big><em>req</em>, <em>select=None</em>, <em>filtered_variable=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#cubicweb.web.facet.VocabularyFacet" title="Permalink to this definition">¶</a></dt>
<dd><p>This abstract class extend <a class="reference internal" href="#cubicweb.web.facet.AbstractFacet" title="cubicweb.web.facet.AbstractFacet"><tt class="xref py py-class docutils literal"><span class="pre">AbstractFacet</span></tt></a> to use the
<tt class="xref py py-class docutils literal"><span class="pre">FacetVocabularyWidget</span></tt> as widget, suitable for facets that may
restrict values according to a (usually computed) vocabulary.</p>
<p>A class which inherits from VocabularyFacet must define at least these methods:</p>
<dl class="method">
<dt id="cubicweb.web.facet.VocabularyFacet.vocabulary">
<tt class="descname">vocabulary</tt><big>(</big><big>)</big><a class="headerlink" href="#cubicweb.web.facet.VocabularyFacet.vocabulary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return vocabulary for this facet, eg a list of 2-uple (label, value).</p>
</dd></dl>

<dl class="method">
<dt id="cubicweb.web.facet.VocabularyFacet.possible_values">
<tt class="descname">possible_values</tt><big>(</big><big>)</big><a class="headerlink" href="#cubicweb.web.facet.VocabularyFacet.possible_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of possible values (as string since it&#8217;s used to
compare to a form value in javascript) for this facet.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="internationalization.html" title="Internationalization"
             >next</a> |</li>
        <li class="right" >
          <a href="edition/examples.html" title="Examples"
             >previous</a> |</li>
        <li><a href="../index.html">CubicWeb 3.18.3</a> &raquo;</li>
          <li><a href="index.html" >Web side development</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2001-2014, Logilab.
      Last updated on Mar 11, 2014.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>