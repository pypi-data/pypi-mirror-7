

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Plugins &mdash; Pylint 1.1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Pylint 1.1.0 documentation" href="index.html" />
    <link rel="next" title="Contribute" href="contribute.html" />
    <link rel="prev" title="IDE integration" href="ide-integration.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="contribute.html" title="Contribute"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ide-integration.html" title="IDE integration"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Pylint 1.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="plugins">
<h1>Plugins<a class="headerlink" href="#plugins" title="Permalink to this headline">¶</a></h1>
<div class="section" id="why-write-a-plugin">
<h2>Why write a plugin?<a class="headerlink" href="#why-write-a-plugin" title="Permalink to this headline">¶</a></h2>
<p>Pylint is a static analysis tool and Python is a dynamically typed language.
So there will be cases where Pylint cannot analyze files properly (this problem
can happen in statically typed languages also if reflection or dynamic
evaluation is used). Plugin is a way to tell Pylint how to handle such cases,
since only the user would know what needs to be done.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Let us run Pylint on a module from the Python source: <a class="reference external" href="http://hg.python.org/cpython/file/2.7/Lib/warnings.py">warnings.py</a> and see what happens:</p>
<div class="highlight-bash"><div class="highlight"><pre>amitdev<span class="nv">$ </span>pylint -E Lib/warnings.py
E:297,36: Instance of <span class="s1">&#39;WarningMessage&#39;</span> has no <span class="s1">&#39;message&#39;</span> member <span class="o">(</span>no-member<span class="o">)</span>
E:298,36: Instance of <span class="s1">&#39;WarningMessage&#39;</span> has no <span class="s1">&#39;filename&#39;</span> member <span class="o">(</span>no-member<span class="o">)</span>
E:298,51: Instance of <span class="s1">&#39;WarningMessage&#39;</span> has no <span class="s1">&#39;lineno&#39;</span> member <span class="o">(</span>no-member<span class="o">)</span>
E:298,64: Instance of <span class="s1">&#39;WarningMessage&#39;</span> has no <span class="s1">&#39;line&#39;</span> member <span class="o">(</span>no-member<span class="o">)</span>
</pre></div>
</div>
<p>Did we catch a genuine error? Let&#8217;s open the code and look at <tt class="docutils literal"><span class="pre">WarningMessage</span></tt> class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">WarningMessage</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

  <span class="sd">&quot;&quot;&quot;Holds the result of a single showwarning() call.&quot;&quot;&quot;</span>

  <span class="n">_WARNING_DETAILS</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;message&quot;</span><span class="p">,</span> <span class="s">&quot;category&quot;</span><span class="p">,</span> <span class="s">&quot;filename&quot;</span><span class="p">,</span> <span class="s">&quot;lineno&quot;</span><span class="p">,</span> <span class="s">&quot;file&quot;</span><span class="p">,</span>
                      <span class="s">&quot;line&quot;</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">lineno</span><span class="p">,</span> <span class="nb">file</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                  <span class="n">line</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="n">local_values</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_WARNING_DETAILS</span><span class="p">:</span>
      <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">local_values</span><span class="p">[</span><span class="n">attr</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_category_name</span> <span class="o">=</span> <span class="n">category</span><span class="o">.</span><span class="n">__name__</span> <span class="k">if</span> <span class="n">category</span> <span class="k">else</span> <span class="bp">None</span>

  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Ah, the fields (<tt class="docutils literal"><span class="pre">message</span></tt>, <tt class="docutils literal"><span class="pre">category</span></tt> etc) are not defined statically on the class.
Instead they are added using <tt class="docutils literal"><span class="pre">setattr</span></tt>. Pylint would have a tough time figuring
this out.</p>
</div>
<div class="section" id="enter-plugin">
<h2>Enter Plugin<a class="headerlink" href="#enter-plugin" title="Permalink to this headline">¶</a></h2>
<p>We can write a plugin to tell Pylint about how to analyze this properly. A
plugin is a module which should have a function <tt class="docutils literal"><span class="pre">register</span></tt> and takes the
<a class="reference external" href="https://bitbucket.org/logilab/pylint/src/f2acea7b640def0237513f66e3de5fa3de73f2de/lint.py?at=default">lint</a> module as input. So a basic hello-world plugin can be implemented as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Inside hello_plugin.py</span>
<span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="n">linter</span><span class="p">):</span>
  <span class="k">print</span> <span class="s">&#39;Hello world&#39;</span>
</pre></div>
</div>
<p>We can run this plugin by placing this module in the PYTHONPATH and invoking as:</p>
<div class="highlight-bash"><div class="highlight"><pre>amitdev<span class="nv">$ </span>pylint -E --load-plugins hello_plugin foo.py
Hello world
</pre></div>
</div>
<p>Back to our example: one way to fix that would be to transform the <tt class="docutils literal"><span class="pre">WarningMessage</span></tt> class
and set the attributes using a plugin so that Pylint can see them. This can be done by
registering a transform function. We can transform any node in the parsed AST like
Module, Class, Function etc. In our case we need to transform a class. It can be done so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">astroid</span> <span class="kn">import</span> <span class="n">MANAGER</span>
<span class="kn">from</span> <span class="nn">astroid</span> <span class="kn">import</span> <span class="n">scoped_nodes</span>

<span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="n">linter</span><span class="p">):</span>
  <span class="k">pass</span>

<span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">cls</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&#39;WarningMessage&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">warnings</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">warnings</span><span class="o">.</span><span class="n">WarningMessage</span><span class="o">.</span><span class="n">_WARNING_DETAILS</span><span class="p">:</span>
      <span class="n">cls</span><span class="o">.</span><span class="n">locals</span><span class="p">[</span><span class="n">f</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">scoped_nodes</span><span class="o">.</span><span class="n">Class</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span>

<span class="n">MANAGER</span><span class="o">.</span><span class="n">register_transform</span><span class="p">(</span><span class="n">scoped_nodes</span><span class="o">.</span><span class="n">Class</span><span class="p">,</span> <span class="n">transform</span><span class="p">)</span>
</pre></div>
</div>
<p>Let&#8217;s go through the plugin. First, we need to register a class transform, which
is done via the <tt class="docutils literal"><span class="pre">register_transform</span></tt> function in <tt class="docutils literal"><span class="pre">MANAGER</span></tt>. It takes the node
type and function as parameters. We need to change a class, so we use <tt class="docutils literal"><span class="pre">scoped_nodes.Class</span></tt>.
We also pass a <tt class="docutils literal"><span class="pre">transform</span></tt> function which does the actual transformation.</p>
<p><tt class="docutils literal"><span class="pre">transform</span></tt> function is simple as well. If the class is <tt class="docutils literal"><span class="pre">WarningMessage</span></tt> then we
add the attributes to its locals (we are not bothered about type of attributes, so setting
them as class will do. But we could set them to any type we want). That&#8217;s it.</p>
<p>Note: We don&#8217;t need to do anything in the <tt class="docutils literal"><span class="pre">register</span></tt> function of the plugin since we
are not modifying anything in the linter itself.</p>
<p>Lets run Pylint with this plugin and see:</p>
<div class="highlight-bash"><pre>amitdev$ pylint -E --load-plugins warning_plugin Lib/warnings.py
amitdev$</pre>
</div>
<p>All the false positives associated with <tt class="docutils literal"><span class="pre">WarningMessage</span></tt> are now gone. This is just
an example, any code transformation can be done by plugins. See <a class="reference external" href="https://bitbucket.org/logilab/astroid/src/64026ffc0d94fe09e4bdc2bf5efaab29444645e7/nodes.py?at=default">nodes</a> and <a class="reference external" href="https://bitbucket.org/logilab/astroid/src/64026ffc0d94fe09e4bdc2bf5efaab29444645e7/scoped_nodes.py?at=default">scoped_nodes</a>
for details about all node types that can be transformed.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Plugins</a><ul>
<li><a class="reference internal" href="#why-write-a-plugin">Why write a plugin?</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#enter-plugin">Enter Plugin</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="ide-integration.html"
                        title="previous chapter">IDE integration</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="contribute.html"
                        title="next chapter">Contribute</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/plugins.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="contribute.html" title="Contribute"
             >next</a> |</li>
        <li class="right" >
          <a href="ide-integration.html" title="IDE integration"
             >previous</a> |</li>
        <li><a href="index.html">Pylint 1.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013-2014, Logilab and contributors.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>