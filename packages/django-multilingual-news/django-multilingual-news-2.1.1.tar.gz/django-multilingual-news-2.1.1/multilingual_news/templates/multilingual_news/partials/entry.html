{% load multilingual_news_tags cms_tags thumbnail i18n %}

<h2>
    {% if not preview %}
        {% if request.user.is_superuser or request.user.is_staff %}
            {% render_model_icon news_entry %}
        {% endif %}
    {% endif %}
    <a href="{{ news_entry.get_absolute_url }}">{% render_model news_entry "title" %}</a>
</h2>

{% if not news_entry.is_published and not preview%}
    <p class="badge">UNPUBLISHED</p>
{% endif %}
<p class="text-muted newsentryDetails">
    {% if news_entry.author %}<span>{% trans "By" %} {{ news_entry.author }}</span>{% endif %}
    <span><span class="glyphicon glyphicon-calendar"></span> {% if news_entry.pub_date %}{{ news_entry.pub_date.date }}{% else %}Mon D, YYYY{% endif %}</span>
    {% if news_entry.categories.all %}
        <span>
            <span class="glyphicon glyphicon-cloud"></span>
                {% for category in news_entry.categories.all %}
                    <a href="{{ category.get_absolute_url }}">{{ category.title }}</a>{% if not forloop.last %},{% endif %}
                {% endfor %}
            </span>
        </span>
    {% endif %}
    {% if news_entry.tags.all %}
        <span>
            <span class="glyphicon glyphicon-tag"></span>
                {% for tagged_item in news_entry.tags.all %}
                    <a href="{% url "news_archive_tagged" tag=tagged_item.tag.slug %}">{{ tagged_item.tag.name }}</a>{% if not forloop.last %},{% endif %}
                {% endfor %}
            </span>
        </span>
    {% endif %}
</p>
{% if news_entry.image %}<img src="{% thumbnail news_entry.image 750x562 crop %}" alt="" />{% endif %}
{% render_placeholder news_entry.content  %}
{% if not preview %}
    {% if request.user.is_superuser or request.user.is_staff %}
        <a href="{% url "news_detail" slug=news_entry.slug %}" class="btn btn-success btn-mini"><span class="glyphicon glyphicon-pencil"></span> {% trans "Open entry to edit" %}</a>
        <a href="{% url "news_delete" pk=news_entry.pk %}" data-class="toggleDeleteModal" class="btn btn-danger" title="{% trans "Delete this entry" %}"><span class="glyphicon glyphicon-minus"></span> {% trans "Delete entry" %}</a>
        <form action="{% url "news_publish" pk=news_entry.pk %}" method="post" style="display: inline;">
            {% csrf_token %}
            <input type="hidden" name="action" value="{% if news_entry.is_published %}unpublish{% else %}publish{% endif %}" />
            <button type="submit" {% if news_entry.is_published %}style="display:none;"{% endif %} class="btn btn-info" title="{% trans "Publish this entry" %}"><span class="glyphicon glyphicon-ok"></span> {% trans "Publish entry" %}</button>
            <button type="submit" {% if not news_entry.is_published %}style="display:none;"{% endif %}  class="btn btn-info" title="{% trans "Unpublish this entry" %}"><span class="glyphicon glyphicon-remove"></span> {% trans "Unpublish entry" %}</button>
        </form>
    {% endif %}
{% endif %}
