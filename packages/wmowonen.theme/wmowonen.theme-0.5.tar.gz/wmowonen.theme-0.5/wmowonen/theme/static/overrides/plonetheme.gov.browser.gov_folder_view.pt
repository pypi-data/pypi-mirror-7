<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

<body>

  <div metal:fill-slot="main">
    <metal:main-macro define-macro="main"
                      tal:define="kssClassesView context/@@kss_field_decorator_view;
                                  getKssClasses nocall:kssClassesView/getKssClassesInlineEditable;
                                  templateId template/getId">

        <!-- h1 metal:use-macro="here/kss_generic_macros/macros/generic_title_view">
            Title or id
        </h1 -->

        <!-- p metal:use-macro="here/kss_generic_macros/macros/generic_description_view">
            Description
        </p -->

        <!-- div tal:replace="structure provider:plone.abovecontentbody" / -->

      <div metal:define-macro="text-field-view"
           id="parent-fieldname-text" class="stx"
           tal:define="kss_class python:getKssClasses('text',
                       templateId=templateId, macro='text-field-view');
                       text here/getText|nothing"
           tal:condition="text"
           tal:attributes="class python:here.Format() in ('text/structured',
                                                 'text/x-rst', ) and 'stx' + kss_class or 'plain' + kss_class">
          <div metal:define-slot="inside" tal:replace="structure text">The body</div>
      </div>

      <metal:listingmacro define-macro="listing">
      <tal:foldercontents define="
          contentFilter contentFilter|request/contentFilter|nothing;
          limit_display limit_display|request/limit_display|nothing;
          more_url more_url|request/more_url|string:folder_contents;
          folderContents python:here.portal_type=='Topic' and here.queryCatalog(contentFilter, batch=True) or here.getFolderContents(contentFilter, batch=True, b_size=limit_display or 100);
          use_view_action site_properties/typesUseViewActionInListings|python:();
          over_limit python: limit_display and len(folderContents) > limit_display;
          folderContents python: (over_limit and folderContents[:limit_display]) or folderContents;
          batch folderContents;">
      <tal:listing condition="folderContents">

        <tal:block tal:repeat="item folderContents">
          <div class="tileItemWrapper">
        	<div class="tileItem visualIEFloatFix vevent"
              tal:define="
                item_url item/getURL|item/absolute_url;
                normalizeString nocall:context/@@plone/normalizeString;
                item_id item/getId|item/id;
                item_title_or_id item/pretty_title_or_id;
                item_description item/Description;
                item_type item/portal_type;
                item_type_title item/Type;
                item_type_class python: 'contenttype-' + normalizeString(item_type);
                item_modified item/ModificationDate;
                item_created item/CreationDate;
                item_wf_state        item/review_state|python: wtool.getInfoFor(item, 'review_state', '');
                item_wf_state_class python:'state-' + normalizeString(item_wf_state);
                item_creator item/Creator;
                item_start item/start/ISO|item/StartDate|nothing;
                item_end item/end/ISO|item/EndDate|nothing;
                item_has_leadimage item/hasContentLeadImage | nothing;
                item_object item/getObject;
                tagInfo python: context.restrictedTraverse('virtualTreeTag').tag(item.Subject);
                tagId tagInfo/id | string:;
		isEvent python: type == 'Event';
                "
              tal:attributes="class python:'tileItem visualIEFloatFix vevent' + ' tag-'+tagId  + ' ' + item_type_class + ' ' + (repeat['item'].even() and 'tileEven' or 'tileOdd')">


            <div class="imgWrapper">
		  <!-- div id="formatted-date"
			tal:define="
			  itemObj python:item.getObject();
			  startdate itemObj/startDate | nothing;
			  months python: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun',
					  'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dec']"
			tal:condition="python: isEvent and startdate">
		      <div class="month"
			  tal:content="python: months[int(startdate.strftime('%m')) - 1]"
			  >Aug</div>
		      <div class="day"
			  tal:content="startdate/day">24</div>
		    </div -->
	    
              <tal:video define="isVideo python:view.isVideo(item.getObject())" condition="isVideo">
              		<div class="tileVideo"
                      tal:define="audio_only python:view.audio_only(item.getObject());
              						   hasLeadImage item/hasContentLeadImage">
                    <a class="autoFlowPlayerFake minimal" href="" tal:attributes="href python:item.getURL() + '/view';
              							onclick python:hasLeadImage and 'config_video.configure(this, true)' or ''" tal:condition="python:not audio_only">
              	      <img src="" class="splash"  alt=""
              		   tal:condition="hasLeadImage"
              		   tal:attributes="src python:item.getURL() + '/leadImage'" />
              	      <img tal:replace="structure here/play-button.png" src="" alt="play video" tal:condition="hasLeadImage"/>
                    </a>
                    <a class="autoFlowPlayer audio" href="" tal:attributes="href python:item.getURL()" tal:condition="audio_only">
                    </a>
                    <p class="tileBody" tal:condition="audio_only">
              	      <span tal:omit-tag="" tal:condition="not:item_description">
              		  &nbsp;
              	      </span>
              	      <span class="description" tal:content="python:view.trimDescription(item_description, 250)">
              		  description
              	      </span>
                    </p>
              	</div>
              </tal:video>

              <a href="#"
                 tal:condition="python:item_type != 'Link'"
                 tal:attributes="href python:item_type in use_view_action and item_url+'/view' or item_url">
                <img src="" alt=""
                     tal:condition="exists:item_object/image_preview"
                     tal:replace="structure python: path('nocall:item_object/tag')(scale='preview', css_class='tileImage')" />
                <img src="" alt=""
                     tal:condition="exists:item_has_leadimage"
                     tal:replace="structure python:view.tag(item_object, css_class='tileImage')" />
              </a>

              <a href="#"
                 class="link-plain"
                 tal:condition="python:item_type == 'Link'"
                 tal:attributes="href item/getRemoteUrl">
                  <img src="" alt=""
                       tal:condition="exists:item_object/image_preview"
                       tal:replace="structure python: path('nocall:item_object/tag')(scale='preview', css_class='tileImage')" />
                  <img src="" alt=""
                       tal:condition="exists:item_has_leadimage"
                       tal:replace="structure python:view.tag(item_object, css_class='tileImage')" />
              </a>

              <!--<div class="addthis_toolbox addthis_default_style"
              	tal:attributes="addthis:url python:(item.portal_type == 'File' or item.portal_type == 'Image') and item_url + '/view' or item_url;
              		        addthis:title item_title_or_id;
              		        addthis:description python:view.trimDescription(item_description, 250);">
                <a class="addthis_button_facebook addthisButton">
                </a>
                      <a class="addthis_button_twitter addthisButton">
                </a>
                <a class="addthis_button_linkedin addthisButton">
                </a>
                <a class="addthis_button_email addthisButton">
                </a>
              </div>-->
            </div>

            <div class="infoWrapper">

              <div class="thema-tag"
                  tal:define="
                      tagInfo python: context.restrictedTraverse('virtualTreeTag').tag(item.Subject);
                      "
                  tal:condition="tagInfo">
                <span tal:define="
                      tagId tagInfo/id;
                      tagTitle tagInfo/title;
                      "
                    tal:attributes="class string:tag-${tagId}"
                    tal:content="tagTitle">
                  Tag
                </span>
              </div>

              <div class="news-date" tal:define="toLocalizedTime nocall:context/@@plone/toLocalizedTime;" tal:condition="python:not view.isVideo(item)">
                  <!-- span i18n:translate="published">Published</span : --> <span tal:content="python:toLocalizedTime(item.Date)" tal:omit-tag="">
                  Date
                  </span>
              </div>

              <div class="visualClear"></div>

              <h2 class="tileHeadline"
                  metal:define-macro="listitem">

                <a href="#"
                   class="summary url"
                   tal:condition="python:item_type != 'Link'"
                   tal:attributes="href python:item_type in use_view_action and item_url+'/view' or item_url;
                                   class python:(context.portal_membership.isAnonymousUser() and 'summary url') or 'summary url state-' + item_wf_state;"
                   tal:content="item_title_or_id">
                    Item Title
                </a>

                <a href="#"
                   class="link-plain"
                   tal:condition="python:item_type == 'Link'"
                   tal:content="item_title_or_id"
                   tal:attributes="href item/getRemoteUrl;
                                   class python:(context.portal_membership.isAnonymousUser() and 'link-plain') or 'link-plain state-' + item_wf_state;">
                    External Link
                </a>
              </h2>

              <p class="tileBody">
                <span tal:omit-tag="" tal:condition="not:item_description">
                    &nbsp;
                </span>
                <span class="description" tal:content="python:view.trimDescription(item_description, 150)"
                                          tal:condition="python:item.portal_type != 'Event'">
                    description
                </span>
                <span class="description" tal:content="python:view.trimDescription(item_description, 90)"
                                          tal:condition="python:item.portal_type == 'Event'">
                    description
                </span>
              </p>
              <!-- infoWrapper -->
            </div>




            <tal:excludedetails condition="python:not view.isVideo(item.getObject())">

            <div class="documentByLine">
              <tal:event condition="python: False and item_type == 'Event'">
                  <span tal:condition="python: item_type == 'Event'">
                		<div class="EventDateInfo" tal:condition="python: item.end >= view.currenttime()">
                			<div class="futureEventDateFrom" tal:attributes="class python:item.start.strftime('%d - %m - %Y') == item.end.strftime('%d - %m - %Y') and 'futureEventDateFrom oneDayDate' or 'futureEventDateFrom'">
                				<div class="eventDayInfo" tal:content="item/start/day">02</div>
                				<div class="eventMonthInfo" tal:content="python:view.translateMonth(item.start.strftime('%b').capitalize())">Jun</div>
                				<div class="eventYearInfo" tal:content="python:item.start.strftime('%Y').capitalize()">2010</div>
                			</div>
                			<span tal:condition="python:item.start.strftime('%d - %m - %Y') != item.end.strftime('%d - %m - %Y')" tal:omit-tag="" >
                			<div class="futureEventDateUntil">
                				<div class="eventDayInfo" tal:content="item/end/day">02</div>
                				<div class="eventMonthInfo" tal:content="python:view.translateMonth(item.end.strftime('%b').capitalize())">Jun</div>
                				<div class="eventYearInfo" tal:content="python:item.end.strftime('%Y').capitalize()">2010</div>
                			</div>
                			<div class="visualClearLeft"><!-- --></div>
                			</span>
                		</div>
                		<div class="EventDateInfo" tal:condition="python: item.end < view.currenttime()">
                			<div class="pastEventDateFrom" tal:attributes="class python:item.start.strftime('%d - %m - %Y') == item.end.strftime('%d - %m - %Y') and 'pastEventDateFrom oneDayDate' or 'pastEventDateFrom'">
                				<div class="eventDayInfo" tal:content="item/start/day">02</div>
                				<div class="eventMonthInfo" tal:content="python:view.translateMonth(item.start.strftime('%b').capitalize())">Jun</div>
                				<div class="eventYearInfo" tal:content="python:item.start.strftime('%Y').capitalize()">2010</div>
                			</div>
                			<span tal:condition="python:item.start.strftime('%d - %m - %Y') != item.end.strftime('%d - %m - %Y')" tal:omit-tag="">
                			<div class="pastEventDateUntil">
                				<div class="eventDayInfo" tal:content="item/end/day">02</div>
                				<div class="eventMonthInfo" tal:content="python:view.translateMonth(item.end.strftime('%b').capitalize())">Jun</div>
                				<div class="eventYearInfo" tal:content="python:item.end.strftime('%Y').capitalize()">2010</div>
                			</div>
                			<div class="visualClearLeft"><!-- --></div>
                			</span>
                		</div>
                   </span>
              </tal:event>
      	    <div class="visualClearLeft"></div>

            <tal:newsitem condition="python: item_type == 'News Item'">
            </tal:newsitem>

          </div>

      	</tal:excludedetails>

      </div>
    	<div tal:condition="python:not repeat['item'].even()" class="visualClear columnBreak"> </div>

    </div> <!-- End of tileItemWrapper -->
  </tal:block>

    <div class="visualClear"></div>
          <!-- Navigation -->
          <div metal:use-macro="here/batch_macros/macros/navigation" />

      </tal:listing>

      <metal:empty metal:define-slot="no_items_in_listing">
          <p class="discreet"
             tal:condition="not: folderContents"
             i18n:translate="description_no_items_in_folder">
              There are currently no items in this folder.
          </p>
      </metal:empty>

      </tal:foldercontents>
      </metal:listingmacro>


      <metal:subtopics use-macro="here/atct_topic_view/macros/folderlisting_macro" />

      <div tal:replace="structure provider:plone.belowcontenttitle" />
      <div tal:replace="structure provider:plone.belowcontentbody" />
<!--
      <script type="text/javascript">
          var addthis_config = {"data_track_clickback":true};
          var addthis_share = {templates: { twitter: '{{title}}: {{url}}' }}
      </script>
      <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#username=intk"></script>
-->
    </metal:main-macro>
  </div>

</body>
</html>

