<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Guide to using begins &mdash; begins 0.8 documentation</title>
    
    <link rel="stylesheet" href="_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="begins 0.8 documentation" href="index.html" />
    <link rel="next" title="The begins API" href="api.html" />
    <link rel="prev" title="A short tutorial on begins" href="tutorial.html" />
    <a href="https://github.com/aliles/begins">
        <img style="position: absolute; top: 0; right: 0; border: 0;"
             src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
             alt="Fork me on GitHub">
    </a>
     

  </head>
  <body>
    <div class="header-wrapper">
      <div class="header">
        <div class="headertitle"><a
          href="index.html">begins 0.8 documentation</a></div>
        <div class="rel">
          <a href="tutorial.html" title="A short tutorial on begins"
             accesskey="P">previous</a> |
          <a href="api.html" title="The begins API"
             accesskey="N">next</a> |
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="guide-to-using-begins">
<span id="guide"></span><h1>Guide to using begins<a class="headerlink" href="#guide-to-using-begins" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Command line programs for <em>lazy</em> humans.</p>
<ul class="simple">
<li>Decorate a function to be your programs starting point.</li>
<li>Generate command line parser based on function signature.</li>
<li>Search system environment for option default values.</li>
</ul>
</div>
<div class="section" id="why-begins">
<h2>Why begins?<a class="headerlink" href="#why-begins" title="Permalink to this headline">¶</a></h2>
<p>I write a lot of
small programs in <a class="reference external" href="http://python.org">Python</a>.
These programs often
accept a small number of
simple command line arguments.
Having to write
command line parsing code
in each of these
small programs both
breaks my train of thought
and greatly increases the
volume of code I am writting.</p>
<p>Begins was implemented to
remove the boilerplate code
from these Python programs.
It&#8217;s not intended to replace
the rich command line processing
needed for larger applications.</p>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>For Python versions earlier
than Python 3.3,
the <a class="reference external" href="https://pypi.python.org/pypi/funcsigs">funcsigs</a> package from the
<a class="reference external" href="https://pypi.python.org/pypi">Python Package Index</a> is
required.</p>
<p>For Python version 2.6,
the <a class="reference external" href="https://pypi.python.org/pypi/argparse">argparse</a> package from the
<a class="reference external" href="https://pypi.python.org/pypi">Python Package Index</a> is
also required.</p>
<p>Both of these dependencies are
listed in the package configuration.
If using <a class="reference external" href="http://www.pip-installer.org">Pip</a> to
install <em>begins</em> then
the required dependencies will
be automatically installed.</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p><em>begins</em> is available
for download from
the <a class="reference external" href="https://pypi.python.org/pypi">Python Package Index</a>.
To install using <a class="reference external" href="http://www.pip-installer.org">Pip</a></p>
<div class="highlight-python"><div class="highlight"><pre>$ pip install begins
</pre></div>
</div>
<p>Alternatively, the latest
development version can be
installed directly
from <a class="reference external" href="https://github.com/aliles/begins">Github</a>.</p>
<div class="highlight-python"><div class="highlight"><pre>$ pip install git+https://github.com/aliles/begins.git
</pre></div>
</div>
<p>Please note that
<em>begins</em> is still in
an alpha state
and therefore
the API or behaviour
could change.</p>
</div>
<div class="section" id="setting-a-programs-starting-point">
<h2>Setting a programs starting point<a class="headerlink" href="#setting-a-programs-starting-point" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">begin.start()</span></tt> function can be
used as a function call
or a decorator.
If called as a function
it returns <tt class="docutils literal"><span class="pre">True</span></tt> when
called from the <tt class="docutils literal"><span class="pre">__main__</span></tt> module.
To do this it inspects
the stack frame of the caller,
checking the <tt class="docutils literal"><span class="pre">__name__</span></tt> global.</p>
<p>This allows the following Python pattern:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<p>To be replace with:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="n">begin</span><span class="o">.</span><span class="n">start</span><span class="p">():</span>
<span class="gp">... </span>   <span class="k">pass</span>
</pre></div>
</div>
<p>If used as a decorator
to annotate a function
the function will be called
if defined in the <tt class="docutils literal"><span class="pre">__main__</span></tt> module
as determined by inspecting
the current stack frame.
Any definitions that follow
the decorated function
wont be created until
after the function call
is complete.</p>
<p>Usage of <tt class="docutils literal"><span class="pre">begin.start()</span></tt> as
a decorator looks like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<p>By deferring the execution
of the function until after
the remainder of the module has loaded
ensures the main function doesn&#8217;t fail
if depending on something
defined in later code.</p>
</div>
<div class="section" id="parsing-command-line-options">
<h2>Parsing command line options<a class="headerlink" href="#parsing-command-line-options" title="Permalink to this headline">¶</a></h2>
<p>If <tt class="docutils literal"><span class="pre">begin.start()</span></tt> decorates a
function accepts parameters
<tt class="docutils literal"><span class="pre">begin.start()</span></tt> will
process the command for
options to pass as
those parameters:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Arther&#39;</span><span class="p">,</span> <span class="n">quest</span><span class="o">=</span><span class="s">&#39;Holy Grail&#39;</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">knights</span><span class="p">):</span>
<span class="gp">... </span>    <span class="s">&quot;tis but a scratch!&quot;</span>
</pre></div>
</div>
<p>The decorated function above
will generate the following
command line help:</p>
<div class="highlight-python"><div class="highlight"><pre>usage: example.py [-h] [-n NAME] [-q QUEST] [-c COLOUR]
                  [knights [knights ...]]

tis but a scratch!

positional arguments:
  knights

optional arguments:
  -h, --help            show this help message and exit
  -n NAME, --name NAME  (default: Arther)
  -q QUEST, --quest QUEST
                        (default: Holy Grail)
  -c COLOUR, --colour COLOUR
                        (default: blue)
</pre></div>
</div>
<p>In Python3, any <a class="reference external" href="http://www.python.org/dev/peps/pep-3107/">function annotations</a>
for a parameter become
the command line option help.
For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span>                                         
<span class="gp">... </span><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="s">&#39;What, is your name?&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">quest</span><span class="p">:</span> <span class="s">&#39;What, is your quest?&#39;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">colour</span><span class="p">:</span> <span class="s">&#39;What, is your favourite colour?&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<p>Will generate command help like:</p>
<div class="highlight-python"><div class="highlight"><pre>usage: holygrail_py3.py [-h] -n NAME -q QUEST -c COLOUR

optional arguments:
  -h, --help            show this help message and exit
  -n NAME, --name NAME  What, is your name?
  -q QUEST, --quest QUEST
                        What, is your quest?
  -c COLOUR, --colour COLOUR
                        What, is your favourite colour?
</pre></div>
</div>
<p>Command line parsing supports:</p>
<ul class="simple">
<li>positional arguments</li>
<li>keyword arguments</li>
<li>default values</li>
<li>variable length arguments</li>
<li>annotations</li>
</ul>
<p>Command line parsing
does not support
variable length keyword arguments,
commonly written as
<tt class="docutils literal"><span class="pre">**kwargs</span></tt>.
If variable length keyword arguments
are used by
the decorated function
an exception
will be raised.</p>
<p>If a parameter
does not have a default,
failing to pass a value
on the command line
will cause running the program to
print an error and exit.</p>
<p>For programs that have
a large number of options
it may be preferable to
only use long options.
To suppress short options,
pass <tt class="docutils literal"><span class="pre">False</span></tt> as the
<tt class="docutils literal"><span class="pre">short_args</span></tt> keyword argument to
the <tt class="docutils literal"><span class="pre">begin.start</span></tt> decorator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span><span class="p">(</span><span class="n">short_args</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Arther&#39;</span><span class="p">,</span> <span class="n">quest</span><span class="o">=</span><span class="s">&#39;Holy Grail&#39;</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">knights</span><span class="p">):</span>
<span class="gp">... </span>    <span class="s">&quot;tis but a scratch!&quot;</span>
</pre></div>
</div>
<p>This program will not
accept <tt class="docutils literal"><span class="pre">-n</span></tt>, <tt class="docutils literal"><span class="pre">-q</span></tt> or <tt class="docutils literal"><span class="pre">-c</span></tt>
as option names.</p>
<p>Similarity, a large number of
command line options may
be better displayed in
alphabetical order.
This can be achieved
by passing <tt class="docutils literal"><span class="pre">lexical_order</span></tt>
as <tt class="docutils literal"><span class="pre">True</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span><span class="p">(</span><span class="n">lexical_order</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">charlie</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<p>This program will list
the command line options as
<tt class="docutils literal"><span class="pre">alpha</span></tt>, <tt class="docutils literal"><span class="pre">beta</span></tt>, <tt class="docutils literal"><span class="pre">charlie</span></tt>
instead of the order
in which the function
accepts them.</p>
</div>
<div class="section" id="boolean-options">
<h2>Boolean options<a class="headerlink" href="#boolean-options" title="Permalink to this headline">¶</a></h2>
<p>If a command line option has
a default value that
is a <tt class="docutils literal"><span class="pre">bool</span></tt> object.
(<tt class="docutils literal"><span class="pre">True</span></tt> or <tt class="docutils literal"><span class="pre">False</span></tt>)
The command line option
will be flags
rather than an option
that accepts a value.
Two flags are generated,
one to set a <tt class="docutils literal"><span class="pre">True</span></tt> value and
one to set a <tt class="docutils literal"><span class="pre">False</span></tt> value.
The two commands will be of
the form <tt class="docutils literal"><span class="pre">--flag</span></tt> and <tt class="docutils literal"><span class="pre">--no-flag</span></tt>.
For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">disable</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<p>Using <tt class="docutils literal"><span class="pre">--enable</span></tt>
or <tt class="docutils literal"><span class="pre">--no-disable</span></tt> when
invoking this program will
invert the associated option.
The options <tt class="docutils literal"><span class="pre">--no-enable</span></tt>
and <tt class="docutils literal"><span class="pre">--disable</span></tt>
have not effect.</p>
</div>
<div class="section" id="sub-commands">
<h2>Sub-Commands<a class="headerlink" href="#sub-commands" title="Permalink to this headline">¶</a></h2>
<p><em>begins</em> supports
using functions as
<a class="reference external" href="http://docs.python.org/dev/library/argparse.html#sub-commands">sub-commands</a> with the
<tt class="docutils literal"><span class="pre">begin.subcommand()</span></tt> decorator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.subcommand</span>                                    
<span class="gp">... </span><span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="n">answer</span><span class="p">):</span>
<span class="gp">... </span>    <span class="s">&quot;What is your name?&quot;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.subcommand</span>                                    
<span class="gp">... </span><span class="k">def</span> <span class="nf">quest</span><span class="p">(</span><span class="n">answer</span><span class="p">):</span>
<span class="gp">... </span>    <span class="s">&quot;What is your quest?&quot;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.subcommand</span>                                    
<span class="gp">... </span><span class="k">def</span> <span class="nf">colour</span><span class="p">(</span><span class="n">answer</span><span class="p">):</span>
<span class="gp">... </span>    <span class="s">&quot;What is your favourite colour?&quot;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<p>This example registers
three sub-commands for
the program:</p>
<div class="highlight-python"><div class="highlight"><pre>usage: subcommands.py [-h] {colour,name,quest} ...

optional arguments:
  -h, --help           show this help message and exit

Available subcommands:
  {colour,name,quest}
    colour             What is your favourite colour?
    name               What is your name?
    quest              What is your quest?
</pre></div>
</div>
<p>The main function will
always be called with
the provided command line arguments.
If a sub-command was chosen
the associated function will
also be called.</p>
<p>It is possible to
create a sub-command with
a different name from
the decorated function&#8217;s name.
To do this pass the
desired sub-command name using
the <tt class="docutils literal"><span class="pre">name</span></tt> keyword argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.subcommand</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;colour&#39;</span><span class="p">)</span>                     
<span class="gp">... </span><span class="k">def</span> <span class="nf">question</span><span class="p">(</span><span class="n">answer</span><span class="p">):</span>
<span class="gp">... </span>    <span class="s">&quot;What is your favourite colour?&quot;</span>
</pre></div>
</div>
<p>Sub-commands can also be
registered with a
specific named group by
passing a <tt class="docutils literal"><span class="pre">group</span></tt> argument to
the <tt class="docutils literal"><span class="pre">begin.subcommand</span></tt> decorator.
The <tt class="docutils literal"><span class="pre">begin.start()</span></tt> decorator can
use sub-commands from
a named group by
passing it a <tt class="docutils literal"><span class="pre">sub_group</span></tt> argument.</p>
<p>Similarly, sub-commands can be
load from <a class="reference external" href="http://peak.telecommunity.com/DevCenter/setuptools#dynamic-discovery-of-services-and-plugins">entry points</a> by
passing the name
of the entry point
through the <tt class="docutils literal"><span class="pre">plugins</span></tt> argument
to the <tt class="docutils literal"><span class="pre">begin.start()</span></tt> decorator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span><span class="p">(</span><span class="n">plugins</span><span class="o">=</span><span class="s">&#39;begins.plugin.demo&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<p>Any functions from
installed packages
that are registered with
the <tt class="docutils literal"><span class="pre">begins.plugin.demo</span></tt> entry point
will be loaded as sub-commands.</p>
</div>
<div class="section" id="multiple-sub-commands">
<h2>Multiple Sub-Commands<a class="headerlink" href="#multiple-sub-commands" title="Permalink to this headline">¶</a></h2>
<p>Some commands may benefit
from being able to be called with
multiple subcommands on
the command line.
The enable multiple sub-commands
a command separator value needs
to be passed to be
passed to <tt class="docutils literal"><span class="pre">begin.start()</span></tt>
as the <tt class="docutils literal"><span class="pre">cmd_delim</span></tt> parameter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.subcommand</span>                                    
<span class="gp">... </span><span class="k">def</span> <span class="nf">subcmd</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">pass</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span><span class="p">(</span><span class="n">cmd_delim</span><span class="o">=</span><span class="s">&#39;--&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<p>When this program is called
from the command line
multiple instances of the
sub-command may be called
if separated by the
command delimiter <tt class="docutils literal"><span class="pre">--</span></tt>.</p>
</div>
<div class="section" id="sub-command-context">
<h2>Sub-Command Context<a class="headerlink" href="#sub-command-context" title="Permalink to this headline">¶</a></h2>
<p>There are use cases where
it is desirable to pass
state from the main function to
a subsequent sub-command.
To support this Begins provides
the <tt class="docutils literal"><span class="pre">begin.context</span></tt> object.
This object will have the
following properties:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">last_return</span></tt>, value returned by previous command function.</li>
<li><tt class="docutils literal"><span class="pre">return_values</span></tt>, iterable of all return values from previous commands.</li>
<li><tt class="docutils literal"><span class="pre">opts_previous</span></tt>, iterable of options object used by previous commands.</li>
<li><tt class="docutils literal"><span class="pre">opts_current</span></tt>, options object for current command.</li>
<li><tt class="docutils literal"><span class="pre">opts_next</span></tt>, iterable of options object for following commands.</li>
<li><strong>(deprecated)</strong> <tt class="docutils literal"><span class="pre">return_value</span></tt>, replaced by <tt class="docutils literal"><span class="pre">last_return</span></tt>.</li>
</ul>
<p>Any other properties set
on the <tt class="docutils literal"><span class="pre">begin.context</span></tt> object
will not be altered by begins.</p>
<p>The <tt class="docutils literal"><span class="pre">last_return</span></tt> property
and <tt class="docutils literal"><span class="pre">return_values</span></tt> will
always be populated,
even in the value
returned from the
main function or
a sub-command function is
the <tt class="docutils literal"><span class="pre">None</span></tt> object.
The length and order of
the <tt class="docutils literal"><span class="pre">return_values</span></tt> will
match those of
<tt class="docutils literal"><span class="pre">opts_previous</span></tt>.</p>
</div>
<div class="section" id="environment-variables">
<h2>Environment Variables<a class="headerlink" href="#environment-variables" title="Permalink to this headline">¶</a></h2>
<p>Environment variables can
be used to override the
default values for
command line options.
To use environment variables
pass a prefix string to
the <tt class="docutils literal"><span class="pre">begin.start()</span></tt> decorator through
the <tt class="docutils literal"><span class="pre">env_prefix</span></tt> parameter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span><span class="p">(</span><span class="n">env_prefix</span><span class="o">=</span><span class="s">&#39;MP_&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Arther&#39;</span><span class="p">,</span> <span class="n">quest</span><span class="o">=</span><span class="s">&#39;Holy Grail&#39;</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">knights</span><span class="p">):</span>
<span class="gp">... </span>    <span class="s">&quot;tis but a scratch!&quot;</span>
</pre></div>
</div>
<p>In the example above,
if an environment variable
<tt class="docutils literal"><span class="pre">MP_NAME</span></tt> existed,
it&#8217;s value would be
used as the default for
the <tt class="docutils literal"><span class="pre">name</span></tt> option.
The options value can
still be set by
explicitly passing a
new value as
a command line option.</p>
</div>
<div class="section" id="configuration-files">
<h2>Configuration files<a class="headerlink" href="#configuration-files" title="Permalink to this headline">¶</a></h2>
<p>Configuration files can
also be used to
override the default values of
command line options.
To use configuration files
pass a base file name to
the <tt class="docutils literal"><span class="pre">begin.start()</span></tt> decorator through
the <tt class="docutils literal"><span class="pre">config_file</span></tt> parameter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span><span class="p">(</span><span class="n">config_file</span><span class="o">=</span><span class="s">&#39;.camelot.cfg&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Arther&#39;</span><span class="p">,</span> <span class="n">quest</span><span class="o">=</span><span class="s">&#39;Holy Grail&#39;</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">knights</span><span class="p">):</span>
<span class="gp">... </span>    <span class="s">&quot;tis but a scratch!&quot;</span>
</pre></div>
</div>
<p>This example will
look for configuration files named
<tt class="docutils literal"><span class="pre">.camelot.cfg</span></tt> in
the current directory and/or
the user&#8217;s home directory.
A command line option&#8217;s
default value can be
changed by an
option value in
a configuration file.
The configuration section
used matches the
decorated function&#8217;s name
by default.
This can be changed by
passing a <tt class="docutils literal"><span class="pre">config_section</span></tt>
parameter to <tt class="docutils literal"><span class="pre">begin.start()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span><span class="p">(</span><span class="n">config_file</span><span class="o">=</span><span class="s">&#39;.camelot.cfg&#39;</span><span class="p">,</span> <span class="n">config_section</span><span class="o">=</span><span class="s">&#39;camelot&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;Arther&#39;</span><span class="p">,</span> <span class="n">quest</span><span class="o">=</span><span class="s">&#39;Holy Grail&#39;</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="s">&#39;blue&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">knights</span><span class="p">):</span>
<span class="gp">... </span>    <span class="s">&quot;tis but a scratch!&quot;</span>
</pre></div>
</div>
<p>In this second example
the section <tt class="docutils literal"><span class="pre">camelot</span></tt>
will be used instead of
a section named <tt class="docutils literal"><span class="pre">run</span></tt>.</p>
</div>
<div class="section" id="argument-type-casting">
<h2>Argument type casting<a class="headerlink" href="#argument-type-casting" title="Permalink to this headline">¶</a></h2>
<p>Command line arguments are
always passed as strings.
Sometimes thought it is
more convenient to
receive arguments of
different types.
For example, this is a
possible function for
starting a web application:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="s">&#39;8080&#39;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="s">&#39;False&#39;</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
<span class="gp">... </span>   <span class="n">debug</span> <span class="o">=</span> <span class="n">begin</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">tobool</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span>
<span class="gp">... </span>   <span class="s">&quot;Run web application&quot;</span>
</pre></div>
</div>
<p>Having to convert
the <tt class="docutils literal"><span class="pre">port</span></tt> argument to
an integer and
the <tt class="docutils literal"><span class="pre">debug</span></tt> argument to
a boolean is
additional boilerplate code.
To avoid this <em>begins</em> provides
the <tt class="docutils literal"><span class="pre">begin.convert()</span></tt> decorator.
This decorator accepts functions
as keyword arguments where
the argument name matches that of
the decorator function.
These functions are used
to convert the
types of arguments.</p>
<p>Rewriting the example above using
the <tt class="docutils literal"><span class="pre">begin.convert()</span></tt> decorator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span>
<span class="gp">... </span><span class="nd">@begin.convert</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">begin</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">tobool</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="gp">... </span>   <span class="s">&quot;Run web application&quot;</span>
</pre></div>
</div>
<p>The module <tt class="docutils literal"><span class="pre">begin.utils</span></tt> contains
useful functions for
converting argument types.</p>
</div>
<div class="section" id="automatic-casting">
<h2>Automatic casting<a class="headerlink" href="#automatic-casting" title="Permalink to this headline">¶</a></h2>
<p>For simple, built-in types
<em>begins</em> can automatically
type cast arguments.
This is achieved by
passing the parameter
<tt class="docutils literal"><span class="pre">_automatic</span></tt> to <tt class="docutils literal"><span class="pre">begin.convert()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span>
<span class="gp">... </span><span class="nd">@begin.convert</span><span class="p">(</span><span class="n">_automatic</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="gp">... </span>    <span class="s">&quot;Run web application&quot;</span>
</pre></div>
</div>
<p>This example is
functionally equivalent to
the example above.</p>
<p>Automatic type casting
works for the following
built-in types.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">int</span></tt> or <tt class="docutils literal"><span class="pre">long</span></tt></li>
<li><tt class="docutils literal"><span class="pre">float</span></tt></li>
<li><tt class="docutils literal"><span class="pre">boolean</span></tt></li>
<li><tt class="docutils literal"><span class="pre">tuple</span></tt> or <tt class="docutils literal"><span class="pre">list</span></tt></li>
</ul>
<p>Additional casting functions
can be provided with
the same call to the
<tt class="docutils literal"><span class="pre">begin.convert()</span></tt> decorator.</p>
<p>Alternatively, use of
<tt class="docutils literal"><span class="pre">begin.convert()</span></tt> can be
dispensed by passing <tt class="docutils literal"><span class="pre">True</span></tt>
to <tt class="docutils literal"><span class="pre">begin.start()</span></tt> via
the <tt class="docutils literal"><span class="pre">auto_convert</span></tt> parameter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span><span class="p">(</span><span class="n">auto_convert</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">8080</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
<span class="gp">... </span>    <span class="s">&quot;Run web application&quot;</span>
</pre></div>
</div>
<p>Again, this example is
functionally equivalent to
the example above.</p>
<p>The limitation of using
<tt class="docutils literal"><span class="pre">auto_convert</span></tt> is that
it is not longer possible to
provide additional casting functions.</p>
</div>
<div class="section" id="command-line-extensions">
<h2>Command Line Extensions<a class="headerlink" href="#command-line-extensions" title="Permalink to this headline">¶</a></h2>
<p>There are behaviours that
are common to many
command line applications,
such as configuring the
<tt class="docutils literal"><span class="pre">logging</span></tt> and
<tt class="docutils literal"><span class="pre">cgitb</span></tt> modules.
<em>begins</em> provides
function decorators that
extend a program&#8217;s
command line arguments to
configure these modules.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">begin.tracebacks()</span></tt></li>
<li><tt class="docutils literal"><span class="pre">begin.logging()</span></tt></li>
</ul>
<p>To use these decorators
they need to decorate
the main function
before <tt class="docutils literal"><span class="pre">begin.start()</span></tt>
is applied.</p>
<div class="section" id="tracebacks">
<h3>Tracebacks<a class="headerlink" href="#tracebacks" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">begin.tracebacks()</span></tt> decorator
adds command line options for
extended traceback reports to
be generated for
unhandled exceptions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span>
<span class="gp">... </span><span class="nd">@begin.tracebacks</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="o">*</span><span class="n">message</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<p>The example above will
now have the following
additional argument group:</p>
<div class="highlight-python"><div class="highlight"><pre>tracebacks:
  Extended traceback reports on failure

  --tracebacks   Enable extended traceback reports
  --tbdir TBDIR  Write tracebacks to directory
</pre></div>
</div>
<p>Passing <tt class="docutils literal"><span class="pre">--tracebacks</span></tt> will
cause extended traceback reports
to be generated for
unhandled exceptions.</p>
<p>Traceback options may
also be set using
configuration files,
if <a class="reference internal" href="#configuration-files">Configuration files</a>
are supported.
The follow options
are used.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">enabled</span></tt>: use any of <tt class="docutils literal"><span class="pre">true</span></tt>, <tt class="docutils literal"><span class="pre">t</span></tt>, <tt class="docutils literal"><span class="pre">yes</span></tt>, <tt class="docutils literal"><span class="pre">y</span></tt>, <tt class="docutils literal"><span class="pre">on</span></tt> or <tt class="docutils literal"><span class="pre">1</span></tt>
to enable tracebacks.</li>
<li><tt class="docutils literal"><span class="pre">directory</span></tt>: write tracebacks to this directory.</li>
</ul>
<p>Options are expected to
be in a <tt class="docutils literal"><span class="pre">tracebacks</span></tt> section.</p>
</div>
<div class="section" id="logging">
<h3>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">begin.logging()</span></tt> decorator
adds command line options for
configuring the logging module:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">logging</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span>
<span class="gp">... </span><span class="nd">@begin.logging</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="o">*</span><span class="n">message</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">message</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<p>The example above will
now have two additional
optional arguments as well as
an additional argument group:</p>
<div class="highlight-python"><div class="highlight"><pre>optional arguments:
  -h, --help            show this help message and exit
  -v, --verbose         Increse logging output
  -q, --quiet           Decrease logging output

logging:
  Detailed control of logging output

  --loglvl {DEBUG,INFO,WARNING,ERROR,CRITICAL}
                        Set explicit log level
  --logfile LOGFILE     Ouput log messages to file
  --logfmt LOGFMT       Log message format
</pre></div>
</div>
<p>The logging level
defaults to <tt class="docutils literal"><span class="pre">INFO</span></tt>.
It can be adjusted
by passing <tt class="docutils literal"><span class="pre">--quiet</span></tt>,
<tt class="docutils literal"><span class="pre">--verbose</span></tt> or
explicitly using <tt class="docutils literal"><span class="pre">--loglvl</span></tt>.</p>
<p>The default log format
depends on whether
log output is
being directed to
standard out or file.
The raw log text
is written to
standard out.
The log message written
to file output includes:</p>
<ul class="simple">
<li>Time</li>
<li>Log level</li>
<li>Filename and line number</li>
<li>Message</li>
</ul>
<p>The message format can
be overridden using
the <tt class="docutils literal"><span class="pre">--logfmt</span></tt> option.</p>
<p>Logging options may
also be set using
configuration files,
if <a class="reference internal" href="#configuration-files">Configuration files</a>
are supported.
The follow options
are used.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">level</span></tt>: log level, must be one of <tt class="docutils literal"><span class="pre">DEBUG</span></tt>, <tt class="docutils literal"><span class="pre">INFO</span></tt>, <tt class="docutils literal"><span class="pre">WARNING</span></tt>,
<tt class="docutils literal"><span class="pre">ERROR</span></tt> or <tt class="docutils literal"><span class="pre">CRITICAL</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">file</span></tt>: output log messages to this file.</li>
<li><tt class="docutils literal"><span class="pre">format</span></tt>: log message format.</li>
</ul>
<p>Options are expected to
be in a <tt class="docutils literal"><span class="pre">logging</span></tt> section.</p>
</div>
</div>
<div class="section" id="command-line-formatting">
<h2>Command Line Formatting<a class="headerlink" href="#command-line-formatting" title="Permalink to this headline">¶</a></h2>
<p>The default <a class="reference external" href="https://pypi.python.org/pypi/argparse">argparse</a> help formatter
may not always meet your needs.
An alternate formatter
can be provided using the
<tt class="docutils literal"><span class="pre">formatter_class</span></tt> argument
to <tt class="docutils literal"><span class="pre">begin.start()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">begin</span><span class="o">,</span> <span class="nn">argparse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@begin.start</span><span class="p">(</span><span class="n">formatter_class</span><span class="o">=</span><span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span><span class="p">)</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">pass</span>
</pre></div>
</div>
<p>Any of the <a class="reference external" href="http://docs.python.org/dev/library/argparse.html#formatter-class">formatter classes</a>
provided by the argparse module
can be used.</p>
<p>Alternatively, <tt class="docutils literal"><span class="pre">begin.formatters</span></tt> provides
a mechanism to compose
new formatter class according
to your requirements.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">begin</span> <span class="kn">import</span> <span class="n">formatters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">formatter_class</span> <span class="o">=</span> <span class="n">formatters</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">formatters</span><span class="o">.</span><span class="n">RawDescription</span><span class="p">,</span> <span class="n">formatters</span><span class="o">.</span><span class="n">RawArguments</span><span class="p">)</span>
</pre></div>
</div>
<p>The following mixin classes
are provided for use with
<tt class="docutils literal"><span class="pre">begin.formatters.compose()</span></tt></p>
<ul class="simple">
<li>RawDescription</li>
<li>RawArguments</li>
<li>ArgumentDefaults</li>
<li>RemoveSubcommandsLine</li>
</ul>
<p>One or more of
these may be passed to
<tt class="docutils literal"><span class="pre">begin.formatters.compose()</span></tt>
to create a new
formatter class.</p>
</div>
<div class="section" id="entry-points">
<h2>Entry Points<a class="headerlink" href="#entry-points" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://pypi.python.org/pypi/setuptools">setuptools</a> package supports
<a class="reference external" href="http://peak.telecommunity.com/DevCenter/setuptools#automatic-script-creation">automatic script creation</a> to
automatically create
command line scripts.
These command line scripts
use the <a class="reference external" href="http://peak.telecommunity.com/DevCenter/setuptools#dynamic-discovery-of-services-and-plugins">entry points</a> system
from setuptools.</p>
<p>To support the
use of entry points,
functions decorated by
<tt class="docutils literal"><span class="pre">begin.start()</span></tt> have
an instance method called
<tt class="docutils literal"><span class="pre">start()</span></tt> that must be
used to configure the
entry point:</p>
<div class="highlight-python"><div class="highlight"><pre>setup(
    # ...
    entry_points = {
        &#39;console_scripts&#39;: [
            &#39;program = package.module:main.start&#39;
        ]
    }
</pre></div>
</div>
<p>Use of the <tt class="docutils literal"><span class="pre">start()</span></tt> method is
required because the
main function is not
called from the <tt class="docutils literal"><span class="pre">__main__</span></tt> module
by the entryp points system.</p>
</div>
<div class="section" id="issues">
<span id="id1"></span><h2>Issues<a class="headerlink" href="#issues" title="Permalink to this headline">¶</a></h2>
<p>Any bug reports or
feature requests can
be made using Github&#8217;s <a class="reference external" href="https://github.com/aliles/begins/issues">issues system</a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
    <h3>Table Of Contents</h3>
    <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">A short tutorial on begins</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Guide to using begins</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">The begins API</a></li>
</ul>


          <h3 style="margin-top: 1.5em;">Search</h3>
          <form class="search" action="search.html" method="get">
            <input type="text" name="q" />
            <input type="submit" value="Go" />
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
          </form>
          <p class="searchtip" style="font-size: 90%">
            Enter search terms or a module, class or function name.
          </p>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <a href="tutorial.html" title="A short tutorial on begins"
             >previous</a> |
          <a href="api.html" title="The begins API"
             >next</a> |
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |
          <a href="genindex.html" title="General Index"
             >index</a>
            <br/>
            <a href="_sources/guide.txt"
               rel="nofollow">Show Source</a>
        </div>

        <div class="right">
          
    <div class="footer">
        &copy; Copyright 2013, Aaron Iles.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>