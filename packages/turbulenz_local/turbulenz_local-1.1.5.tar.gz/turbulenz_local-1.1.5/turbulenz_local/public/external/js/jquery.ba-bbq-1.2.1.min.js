/*!
 * jQuery BBQ: Back Button & Query Library - v1.2.1 - 2/17/2010
 * http://benalman.com/projects/jquery-bbq-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */(function(a,b){"$:nomunge";var c,d=Array.prototype.slice,e=decodeURIComponent,f=a.param,g,h,i,j=a.bbq=a.bbq||{},k,l,m,n=a.event.special,o="hashchange",p="querystring",q="fragment",r="elemUrlAttr",s="location",t="href",u="src",v=/^.*\?|#.*$/g,w=/^.*\#/,x,y={};function z(a){return typeof a==="string"}function A(a){var b=d.call(arguments,1);return function(){return a.apply(this,b.concat(d.call(arguments)))}}function B(a){return a.replace(/^[^#]*#?(.*)$/,"$1")}function C(a){return a.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function D(d,g,i,j,k){var l,m,n,o,r;j!==c?(n=i.match(d?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/),r=n[3]||"",k===2&&z(j)?m=j.replace(d?w:v,""):(o=h(n[2]),j=z(j)?h[d?q:p](j):j,m=k===2?j:k===1?a.extend({},j,o):a.extend({},o,j),m=f(m),d&&(m=m.replace(x,e))),l=n[1]+(d?"#":m||!n[1]?"?":"")+m+r):l=g(i!==c?i:b[s][t]);return l}f[p]=A(D,0,C),f[q]=g=A(D,1,B),g.noEscape=function(b){b=b||"";var c=a.map(b.split(""),encodeURIComponent);x=new RegExp(c.join("|"),"g")},g.noEscape(",/"),a.deparam=h=function(b,d){var f={},g={"true":!0,"false":!1,"null":null};a.each(b.replace(/\+/g," ").split("&"),function(b,h){var i=h.split("="),j=e(i[0]),k,l=f,m=0,n=j.split("]["),o=n.length-1;/\[/.test(n[0])&&/\]$/.test(n[o])?(n[o]=n[o].replace(/\]$/,""),n=n.shift().split("[").concat(n),o=n.length-1):o=0;if(i.length===2){k=e(i[1]),d&&(k=k&&!isNaN(k)?+k:k==="undefined"?c:g[k]!==c?g[k]:k);if(o)for(;m<=o;m++)j=n[m]===""?l.length:n[m],l=l[j]=m<o?l[j]||(n[m+1]&&isNaN(n[m+1])?{}:[]):k;else a.isArray(f[j])?f[j].push(k):f[j]!==c?f[j]=[f[j],k]:f[j]=k}else j&&(f[j]=d?c:"")});return f};function E(a,b,d){b===c||typeof b==="boolean"?(d=b,b=f[a?q:p]()):b=z(b)?b.replace(a?w:v,""):b;return h(b,d)}h[p]=A(E,0),h[q]=i=A(E,1),a[r]||(a[r]=function(b){return a.extend(y,b)})({a:t,base:t,iframe:u,img:u,input:u,form:"action",link:t,script:u}),m=a[r];function F(b,d,e,g){!z(e)&&typeof e!=="object"&&(g=e,e=d,d=c);return this.each(function(){var c=a(this),h=d||m()[(this.nodeName||"").toLowerCase()]||"",i=h&&c.attr(h)||"";c.attr(h,f[b](i,e,g))})}a.fn[p]=A(F,p),a.fn[q]=A(F,q),j.pushState=k=function(a,d){z(a)&&/^#/.test(a)&&d===c&&(d=2);var e=a!==c,f=g(b[s][t],e?a:{},e?d:2);b[s][t]=f+(/#/.test(f)?"":"#")},j.getState=l=function(a,b){return a===c||typeof a==="boolean"?i(a):i(b)[a]},j.removeState=function(b){var d={};b!==c&&(d=l(),a.each(a.isArray(b)?b:arguments,function(a,b){delete d[b]})),k(d,2)},n[o]=a.extend(n[o],{add:function(b){var d;function e(a){var b=a[q]=g();a.getState=function(a,d){return a===c||typeof a==="boolean"?h(b,a):h(b,d)[a]},d.apply(this,arguments)}if(a.isFunction(b)){d=b;return e}d=b.handler,b.handler=e}})})(jQuery,this),(function(a,b,c){"$:nomunge";var d,e=a.event.special,f="location",g="hashchange",h="href",i=a.browser,j=document.documentMode,k=i.msie&&(j===c||j<8),l="on"+g in b&&!k;function m(a){a=a||b[f][h];return a.replace(/^[^#]*#?(.*)$/,"$1")}a[g+"Delay"]=100,e[g]=a.extend(e[g],{setup:function(){if(l)return false;a(d.start)},teardown:function(){if(l)return false;a(d.stop)}}),d=(function(){var c={},d,e,i,j;function l(){i=j=function(a){return a},k&&(e=a("<iframe src=\"javascript:0\"/>").hide().insertAfter("body")[0].contentWindow,j=function(){return m(e.document[f][h])},i=function(a,b){if(a!==b){var c=e.document;c.open().close(),c[f].hash="#"+a}},i(m()))}c.start=function(){if(d)return;var c=m();i||l(),(function e(){var k=m(),l=j(c);k!==c?(i(c=k,l),a(b).trigger(g)):l!==c&&(b[f][h]=b[f][h].replace(/#.*/,"")+"#"+l),d=setTimeout(e,a[g+"Delay"])})()},c.stop=function(){e||(d&&clearTimeout(d),d=0)};return c})()})(jQuery,this)