// Copyright (c) 2011-2012 Turbulenz Limited
/* Code adapted from Andrei Stefan's work *//* http://www.sliceratwork.com/detect-installed-browser-plugins-using-javascript *//*global navigator*//*global ActiveXObject*//*global window*//*global $*/var PluginDetection={};PluginDetection.plugins={turbulenz:{mimeType:["application/vnd.turbulenz"],activeXControls:["turbulenz_host.TurbulenzEngineHostControl"]}},PluginDetection.platformStrings=[{subString:"Win",identity:"Windows"},{subString:"Mac",identity:"Mac"},{subString:"Linux",identity:"Linux"}],PluginDetection.getPlugins=function(){function n(e){if(!e)return null;var n=e.match(t);if(!n||n.length===0)return null;var r=n[0];return r.substr(8,r.length-8)}function r(e){return window.ActiveXObject?'<object id="'+e.id+'" width="'+e.width+'" height="'+e.height+'">'+'<param name="type" value="application/vnd.turbulenz">'+"</object>":'<object id="'+e.id+'" width="'+e.width+'" height="'+e.height+'" '+'type="application/vnd.turbulenz"></object>'}function i(){$("body").append(r({id:"test_tz_version",width:0,height:0}));var e=$("#test_tz_version"),t=e[0].version;return t?(e.remove(),t):null}function s(e){var t,r,s;navigator.plugins.refresh();var o=navigator.mimeTypes;if(o){r=e.mimeType.length;for(t=0;t<r;t+=1){var u=o[e.mimeType[t]];if(u){var a=u.enabledPlugin;if(a){try{s=n(a.description)}catch(f){}return s=s||i(),{supported:!0,version:a.version||i()}}return{supported:!1}}}}var l=e.activeXControls;if(l&&typeof ActiveXObject!="undefined"){r=l.length;for(t=0;t<r;t+=1)try{var c=new ActiveXObject(l[t]);s=null;try{s=n(c.description)}catch(h){}return{supported:!0,version:s}}catch(p){}}return{supported:!1}}if(this.installedPlugins)return this.installedPlugins;this.installedPlugins={};var t=/Version:(([0-9]+)\.){2,3}([0-9]+)/g,o=this.plugins,u;for(u in o)o.hasOwnProperty(u)&&(this.installedPlugins[u]=s(o[u]));return this.installedPlugins},PluginDetection.getPlatform=function(){if(this.platform)return this.platform;var t=navigator.platform,n=this.platformStrings,r=n.length;for(var i=0;i<r;i+=1)if(t.indexOf(n[i].subString)!==-1)return this.platform=n[i].identity,this.platform;return this.platform="Unknown",this.platform},PluginDetection.newerVersion=function(t,n){var r=t.split(/\./),i=n.split(/\./),s=Math.max(r.length,i.length);for(var o=0;o<s;o+=1){var u=r[o],a=i[o];u?u=parseInt(u,10):u=0,a?a=parseInt(a,10):a=0;if(u>a)return!0;if(u<a)return!1}return!1};